import{r as t,a3 as v,j as e,t as r,b as o}from"./index-f6ac47b8.js";import{A as k}from"./AsciiPanel-5614714e.js";import{A as S}from"./AsciiButton-4907e65e.js";import{e as C}from"./errorHandler-5ea9ae85.js";import{S as _}from"./SkeletonLoader-792007e7.js";const R=()=>{const[u,f]=t.useState(null),[c,m]=t.useState(null),[y,h]=t.useState(!0),[d,p]=t.useState(null),[l,s]=t.useState(!1),[n,i]=t.useState({schema_name:"",table_name:"",partition_name:"",partition_column:"",partition_type:"DATE",partition_value:"",partition_format:"year-month-day"}),a=t.useRef(!0),g=t.useCallback(async()=>{var j;if(!(!a.current||!n.schema_name||!n.table_name))try{p(null);const[b,z]=await Promise.all([v.getPartitioningConfig(n.schema_name,n.table_name),v.getPartitioningStats(n.schema_name,n.table_name)]);a.current&&(f(b),m(z))}catch(b){if(a.current){if(((j=b==null?void 0:b.response)==null?void 0:j.status)===404){f(null),m({total_partitions:0,total_rows:0,total_size_bytes:0});return}p(C(b))}}finally{a.current&&h(!1)}},[n.schema_name,n.table_name]);t.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[]);const x=t.useCallback(async()=>{try{await v.createPartition(n),s(!1),await g()}catch(j){p(C(j))}},[n,g]);return y&&!n.schema_name?e.jsx(_,{}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:r.spacing.md},children:[e.jsx("h3",{style:{fontSize:14,marginBottom:r.spacing.sm},children:"Dynamic Partitioning Configuration"}),e.jsxs("div",{style:{display:"flex",gap:r.spacing.sm,marginBottom:r.spacing.md},children:[e.jsx("input",{type:"text",value:n.schema_name,onChange:j=>i(b=>({...b,schema_name:j.target.value})),placeholder:"Schema name",style:{flex:1,padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx("input",{type:"text",value:n.table_name,onChange:j=>i(b=>({...b,table_name:j.target.value})),placeholder:"Table name",style:{flex:1,padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx(S,{onClick:g,disabled:!n.schema_name||!n.table_name,children:"Load"}),e.jsx(S,{onClick:()=>s(!0),children:"Create Partition"})]})]}),d&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:d}),c&&e.jsxs("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,marginBottom:r.spacing.md},children:[e.jsx("h4",{style:{fontSize:12,marginBottom:r.spacing.sm},children:"Partitioning Statistics"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:r.spacing.sm},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Total Partitions"}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:o.foreground},children:c.total_partitions||0})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Total Rows"}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:o.foreground},children:c.total_rows||0})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Total Size"}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:o.foreground},children:c.total_size_bytes?`${(c.total_size_bytes/1024/1024).toFixed(2)} MB`:"0 MB"})]})]})]}),l&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:r.spacing.lg},children:e.jsxs("div",{style:{backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:2,padding:r.spacing.xl,maxWidth:"600px",width:"100%"},children:[e.jsx("h3",{style:{fontSize:14,marginBottom:r.spacing.md},children:"Create Partition"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,fontSize:12,color:o.foreground},children:"Partition Name *"}),e.jsx("input",{type:"text",value:n.partition_name,onChange:j=>i(b=>({...b,partition_name:j.target.value})),style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,fontSize:12,color:o.foreground},children:"Partition Column *"}),e.jsx("input",{type:"text",value:n.partition_column,onChange:j=>i(b=>({...b,partition_column:j.target.value})),style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,fontSize:12,color:o.foreground},children:"Partition Type *"}),e.jsxs("select",{value:n.partition_type,onChange:j=>i(b=>({...b,partition_type:j.target.value})),style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"DATE",children:"DATE"}),e.jsx("option",{value:"RANGE",children:"RANGE"}),e.jsx("option",{value:"LIST",children:"LIST"}),e.jsx("option",{value:"HASH",children:"HASH"}),e.jsx("option",{value:"REGION",children:"REGION"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,fontSize:12,color:o.foreground},children:"Partition Value"}),e.jsx("input",{type:"text",value:n.partition_value,onChange:j=>i(b=>({...b,partition_value:j.target.value})),placeholder:"2024-01-01",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{style:{display:"flex",gap:r.spacing.sm,justifyContent:"flex-end",marginTop:r.spacing.md},children:[e.jsx(S,{onClick:()=>s(!1),children:"Cancel"}),e.jsx(S,{onClick:x,disabled:!n.partition_name||!n.partition_column,children:"Create"})]})]})]})})]})},B=()=>{const[u,f]=t.useState([]),[c,m]=t.useState(!0),[y,h]=t.useState(null),[d,p]=t.useState({schema:"",table:""}),l=t.useRef(!0),s=t.useRef(null),n=t.useCallback(async()=>{var i;if(l.current)try{h(null);const a=await v.getPartitionPruningStats(d.schema||void 0,d.table||void 0);l.current&&f(a||[])}catch(a){if(l.current){if(((i=a==null?void 0:a.response)==null?void 0:i.status)===404){f([]);return}h(C(a))}}finally{l.current&&m(!1)}},[d]);return t.useEffect(()=>(l.current=!0,m(!0),n(),s.current=setInterval(()=>{n()},1e4),()=>{l.current=!1,s.current&&clearInterval(s.current)}),[n]),c?e.jsx(_,{}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:r.spacing.md},children:[e.jsx("h3",{style:{fontSize:14,marginBottom:r.spacing.sm},children:"Partition Pruning Statistics"}),e.jsxs("div",{style:{display:"flex",gap:r.spacing.sm,marginBottom:r.spacing.md},children:[e.jsx("input",{type:"text",value:d.schema,onChange:i=>p(a=>({...a,schema:i.target.value})),placeholder:"Filter by schema",style:{flex:1,padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx("input",{type:"text",value:d.table,onChange:i=>p(a=>({...a,table:i.target.value})),placeholder:"Filter by table",style:{flex:1,padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),y&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:y}),u.length===0?e.jsx("div",{style:{padding:r.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No partition pruning statistics available"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.sm},children:u.map((i,a)=>e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:r.spacing.sm},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Table"}),e.jsxs("div",{style:{fontSize:12,color:o.foreground},children:[i.schema_name,".",i.table_name]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Pruning Ratio"}),e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:o.foreground},children:[((i.pruning_ratio||0)*100).toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Partitions Used"}),e.jsxs("div",{style:{fontSize:12,color:o.foreground},children:[i.partitions_used," / ",i.total_partitions]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Execution Time"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:i.execution_time_ms?`${i.execution_time_ms}ms`:"N/A"})]})]})},a))})]})},$=()=>{const[u,f]=t.useState([]),[c,m]=t.useState(!0),[y,h]=t.useState(null),[d,p]=t.useState(null),l=t.useRef(!0),s=t.useCallback(async()=>{var i;if(l.current)try{h(null);const a=await v.getCacheConfig();l.current&&f(a||[])}catch(a){if(l.current){if(((i=a==null?void 0:a.response)==null?void 0:i.status)===404){f([]);return}h(C(a))}}finally{l.current&&m(!1)}},[]);t.useEffect(()=>(l.current=!0,m(!0),s(),()=>{l.current=!1}),[s]);const n=t.useCallback(async i=>{try{await v.updateCacheConfig(i),p(null),await s()}catch(a){h(C(a))}},[s]);return c?e.jsx(_,{}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:r.spacing.md},children:[e.jsx("h3",{style:{fontSize:14},children:"Cache Configuration"}),e.jsx(S,{onClick:()=>v.clearCache(),children:"Clear All Cache"})]}),y&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:y}),u.length===0?e.jsx("div",{style:{padding:r.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No cache configurations found. Cache will use default settings."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.sm},children:u.map((i,a)=>e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:o.foreground,marginBottom:r.spacing.xs},children:i.cache_type}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Max Size: ",i.max_size||"N/A"," | Last Updated: ",new Date(i.last_updated).toLocaleString()]})]}),e.jsx(S,{onClick:()=>p(i),children:"Edit"})]})},a))}),d&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:2,padding:r.spacing.xl,maxWidth:"500px",width:"100%"},children:[e.jsx("h3",{style:{fontSize:14,marginBottom:r.spacing.md},children:"Edit Cache Config"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,fontSize:12,color:o.foreground},children:"Max Size"}),e.jsx("input",{type:"number",value:d.max_size||1e3,onChange:i=>p(a=>({...a,max_size:parseInt(i.target.value)||1e3})),style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{style:{display:"flex",gap:r.spacing.sm,justifyContent:"flex-end"},children:[e.jsx(S,{onClick:()=>p(null),children:"Cancel"}),e.jsx(S,{onClick:()=>n(d),children:"Save"})]})]})]})})]})},w=()=>{const[u,f]=t.useState([]),[c,m]=t.useState(!0),[y,h]=t.useState(null),d=t.useRef(!0),p=t.useRef(null),l=t.useCallback(async()=>{var s;if(d.current)try{h(null);const n=await v.getCacheStats();d.current&&f(n||[])}catch(n){if(d.current){if(((s=n==null?void 0:n.response)==null?void 0:s.status)===404){f([]);return}h(C(n))}}finally{d.current&&m(!1)}},[]);return t.useEffect(()=>(d.current=!0,m(!0),l(),p.current=setInterval(()=>{l()},5e3),()=>{d.current=!1,p.current&&clearInterval(p.current)}),[l]),c?e.jsx(_,{}):e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:14,marginBottom:r.spacing.md},children:"Cache Statistics"}),y&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:y}),u.length===0?e.jsx("div",{style:{padding:r.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No cache statistics available"}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:r.spacing.md},children:u.map((s,n)=>e.jsxs("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsxs("h4",{style:{fontSize:12,marginBottom:r.spacing.sm,color:o.foreground},children:[s.cache_type," Cache"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.xs},children:[e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Hit Rate: ",e.jsxs("span",{style:{color:o.foreground,fontWeight:600},children:[((s.hit_rate||0)*100).toFixed(2),"%"]})]}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Hits: ",e.jsx("span",{style:{color:o.foreground},children:s.total_hits||0})]}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Misses: ",e.jsx("span",{style:{color:o.foreground},children:s.total_misses||0})]}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Evictions: ",e.jsx("span",{style:{color:o.foreground},children:s.total_evictions||0})]}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Current Size: ",e.jsxs("span",{style:{color:o.foreground},children:[s.current_size||0," / ",s.max_size||0]})]})]})]},n))})]})},P=()=>{const[u,f]=t.useState([]),[c,m]=t.useState(!0),[y,h]=t.useState(null),[d,p]=t.useState(!1),[l,s]=t.useState({schema_name:"",table_name:"",compression_algorithm:"GZIP",compress_on_transfer:!0,compress_on_storage:!1,min_size_bytes:1048576}),n=t.useRef(!0),i=t.useCallback(async()=>{var g;if(n.current)try{h(null);const x=await v.getCompressionConfig();n.current&&f(x||[])}catch(x){if(n.current){if(((g=x==null?void 0:x.response)==null?void 0:g.status)===404){f([]);return}h(C(x))}}finally{n.current&&m(!1)}},[]);t.useEffect(()=>(n.current=!0,m(!0),i(),()=>{n.current=!1}),[i]);const a=t.useCallback(async()=>{try{await v.updateCompressionConfig(l),p(!1),s({schema_name:"",table_name:"",compression_algorithm:"GZIP",compress_on_transfer:!0,compress_on_storage:!1,min_size_bytes:1048576}),await i()}catch(g){h(C(g))}},[l,i]);return c?e.jsx(_,{}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:r.spacing.md},children:[e.jsx("h3",{style:{fontSize:14},children:"Compression Configuration"}),e.jsx(S,{onClick:()=>p(!0),children:"Add Configuration"})]}),y&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:y}),u.length===0?e.jsx("div",{style:{padding:r.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No compression configurations"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.sm},children:u.map((g,x)=>e.jsxs("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:o.foreground,marginBottom:r.spacing.xs},children:[g.schema_name,".",g.table_name]}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Algorithm: ",g.compression_algorithm," | Transfer: ",g.compress_on_transfer?"Yes":"No"," | Storage: ",g.compress_on_storage?"Yes":"No"," | Min Size: ",(g.min_size_bytes/1024/1024).toFixed(2)," MB"]})]},x))}),d&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:r.spacing.lg},children:e.jsxs("div",{style:{backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:2,padding:r.spacing.xl,maxWidth:"600px",width:"100%"},children:[e.jsx("h3",{style:{fontSize:14,marginBottom:r.spacing.md},children:"Compression Configuration"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.md},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:r.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,fontSize:12,color:o.foreground},children:"Schema *"}),e.jsx("input",{type:"text",value:l.schema_name,onChange:g=>s(x=>({...x,schema_name:g.target.value})),style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,fontSize:12,color:o.foreground},children:"Table *"}),e.jsx("input",{type:"text",value:l.table_name,onChange:g=>s(x=>({...x,table_name:g.target.value})),style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,fontSize:12,color:o.foreground},children:"Compression Algorithm"}),e.jsxs("select",{value:l.compression_algorithm,onChange:g=>s(x=>({...x,compression_algorithm:g.target.value})),style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"NONE",children:"None"}),e.jsx("option",{value:"GZIP",children:"GZIP"}),e.jsx("option",{value:"LZ4",children:"LZ4"}),e.jsx("option",{value:"SNAPPY",children:"Snappy"})]})]}),e.jsxs("div",{style:{display:"flex",gap:r.spacing.md},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:r.spacing.xs,fontSize:12,color:o.foreground},children:[e.jsx("input",{type:"checkbox",checked:l.compress_on_transfer,onChange:g=>s(x=>({...x,compress_on_transfer:g.target.checked})),style:{cursor:"pointer"}}),"Compress on Transfer"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:r.spacing.xs,fontSize:12,color:o.foreground},children:[e.jsx("input",{type:"checkbox",checked:l.compress_on_storage,onChange:g=>s(x=>({...x,compress_on_storage:g.target.checked})),style:{cursor:"pointer"}}),"Compress on Storage"]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,fontSize:12,color:o.foreground},children:"Minimum Size (bytes)"}),e.jsx("input",{type:"number",value:l.min_size_bytes,onChange:g=>s(x=>({...x,min_size_bytes:parseInt(g.target.value)||1048576})),style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{style:{display:"flex",gap:r.spacing.sm,justifyContent:"flex-end",marginTop:r.spacing.md},children:[e.jsx(S,{onClick:()=>p(!1),children:"Cancel"}),e.jsx(S,{onClick:a,disabled:!l.schema_name||!l.table_name,children:"Save"})]})]})]})})]})},I=()=>{const[u,f]=t.useState([]),[c,m]=t.useState(!0),[y,h]=t.useState(null),d=t.useRef(!0),p=t.useRef(null),l=t.useCallback(async()=>{var n;if(d.current)try{h(null);const i=await v.getMemoryStats(100);d.current&&f(i||[])}catch(i){if(d.current){if(((n=i==null?void 0:i.response)==null?void 0:n.status)===404){f([]);return}h(C(i))}}finally{d.current&&m(!1)}},[]);if(t.useEffect(()=>(d.current=!0,m(!0),l(),p.current=setInterval(()=>{l()},5e3),()=>{d.current=!1,p.current&&clearInterval(p.current)}),[l]),c)return e.jsx(_,{});const s=n=>{if(n===0)return"0 B";const i=1024,a=["B","KB","MB","GB"],g=Math.floor(Math.log(n)/Math.log(i));return`${(n/Math.pow(i,g)).toFixed(2)} ${a[g]}`};return e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:14,marginBottom:r.spacing.md},children:"Memory Usage Monitor"}),y&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:y}),u.length===0?e.jsx("div",{style:{padding:r.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No memory statistics available"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.sm},children:u.slice(0,20).map((n,i)=>{const a=n.limit_bytes>0?n.current_usage_bytes/n.limit_bytes*100:0;return e.jsxs("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:r.spacing.xs},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:o.foreground},children:n.operation_type||"Unknown"}),e.jsx("div",{style:{fontSize:11,color:o.muted},children:new Date(n.recorded_at).toLocaleString()})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:r.spacing.sm},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Current"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:s(n.current_usage_bytes||0)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Peak"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:s(n.peak_usage_bytes||0)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Limit"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:n.limit_bytes?s(n.limit_bytes):"Unlimited"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Usage"}),e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:a>90?"#ff4444":a>75?"#ffaa00":o.foreground},children:[a.toFixed(1),"%"]})]})]}),n.spill_count>0&&e.jsxs("div",{style:{fontSize:11,color:"#ffaa00",marginTop:r.spacing.xs},children:["Spills: ",n.spill_count," (",s(n.spill_bytes||0),")"]})]},i)})})]})},E=()=>{const[u,f]=t.useState([]),[c,m]=t.useState(!0),[y,h]=t.useState(null),d=t.useRef(!0),p=t.useRef(null),l=t.useCallback(async()=>{var s;if(d.current)try{h(null);const n=await v.getJoinOptimizationStats(50);d.current&&f(n||[])}catch(n){if(d.current){if(((s=n==null?void 0:n.response)==null?void 0:s.status)===404){f([]);return}h(C(n))}}finally{d.current&&m(!1)}},[]);return t.useEffect(()=>(d.current=!0,m(!0),l(),p.current=setInterval(()=>{l()},1e4),()=>{d.current=!1,p.current&&clearInterval(p.current)}),[l]),c?e.jsx(_,{}):e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:14,marginBottom:r.spacing.md},children:"Join Optimization Statistics"}),y&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:y}),u.length===0?e.jsx("div",{style:{padding:r.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No join optimization statistics available"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.sm},children:u.map((s,n)=>e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:r.spacing.sm},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Left Table"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:s.left_table})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Right Table"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:s.right_table})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Algorithm"}),e.jsx("div",{style:{fontSize:12,fontWeight:600,color:o.foreground},children:s.join_algorithm})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Result Rows"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:s.result_rows||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted},children:"Execution Time"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:s.execution_time_ms?`${s.execution_time_ms}ms`:"N/A"})]})]})},n))})]})},N=()=>{const[u,f]=t.useState("partitioning");return e.jsx("div",{style:{padding:r.spacing.lg},children:e.jsx(k,{children:e.jsxs("div",{style:{marginBottom:r.spacing.lg},children:[e.jsx("h1",{style:{fontSize:18,fontWeight:600,color:o.foreground,marginBottom:r.spacing.md},children:"Performance Optimization"}),e.jsx("p",{style:{color:o.muted,fontSize:12,marginBottom:r.spacing.lg},children:"Configure and monitor performance optimizations: partitioning, caching, compression, and more"}),e.jsx("div",{style:{display:"flex",gap:r.spacing.sm,marginBottom:r.spacing.lg,borderBottom:`2px solid ${o.border}`,paddingBottom:r.spacing.sm},children:["partitioning","pruning","cache","cache-stats","compression","memory","join"].map(c=>e.jsxs("button",{onClick:()=>f(c),style:{padding:`${r.spacing.sm} ${r.spacing.md}`,border:"none",background:u===c?o.accent:"transparent",color:u===c?"#ffffff":o.foreground,borderRadius:"2 2 0 0",cursor:"pointer",fontWeight:u===c?600:500,transition:"all 0.15s ease",textTransform:"capitalize",fontFamily:"Consolas, monospace",fontSize:12},onMouseEnter:m=>{u!==c&&(m.currentTarget.style.background=o.backgroundSoft)},onMouseLeave:m=>{u!==c&&(m.currentTarget.style.background="transparent")},children:[c==="partitioning"&&"Partitioning",c==="pruning"&&"Partition Pruning",c==="cache"&&"Cache Config",c==="cache-stats"&&"Cache Stats",c==="compression"&&"Compression",c==="memory"&&"Memory",c==="join"&&"Join Optimization"]},c))}),e.jsxs("div",{style:{minHeight:"400px"},children:[u==="partitioning"&&e.jsx(R,{}),u==="pruning"&&e.jsx(B,{}),u==="cache"&&e.jsx($,{}),u==="cache-stats"&&e.jsx(w,{}),u==="compression"&&e.jsx(P,{}),u==="memory"&&e.jsx(I,{}),u==="join"&&e.jsx(E,{})]})]})})})};export{N as default};
