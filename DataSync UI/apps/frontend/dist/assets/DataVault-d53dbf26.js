import{r as l,j as e,b as t,e as v,_ as V}from"./index-f6ac47b8.js";import{A as k}from"./AsciiPanel-5614714e.js";import{A as y}from"./AsciiButton-4907e65e.js";import{u as te}from"./usePagination-c6b4a268.js";import{u as ne}from"./useTableFilters-7bb371e7.js";import{e as Y}from"./errorHandler-5ea9ae85.js";import{s as se}from"./validation-24839588.js";import{S as oe}from"./SkeletonLoader-792007e7.js";import{A as ee}from"./AsciiConnectionStringSelector-f0a9a200.js";import"./GCSConnectionConfig-f004c48c.js";const re=({vaults:T,onVaultClick:u,onEdit:r,onDelete:R,onBuild:U,selectedVault:a})=>{const[j,C]=l.useState(new Set),S=l.useMemo(()=>{const m=new Map;return T.forEach(g=>{const d=g.target_schema||"Other";m.has(d)||m.set(d,{name:d,vaults:[]}),m.get(d).vaults.push(g)}),Array.from(m.values()).sort((g,d)=>g.name.localeCompare(d.name))},[T]),B=m=>{C(g=>{const d=new Set(g);return d.has(m)?d.delete(m):d.add(m),d})};return T.length===0?e.jsxs("div",{style:{padding:40,textAlign:"center",color:t.muted,fontFamily:"Consolas"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12,opacity:.4,fontFamily:"Consolas"},children:v.blockFull}),e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas",marginBottom:4},children:"No vaults found"}),e.jsx("div",{style:{fontSize:11,fontFamily:"Consolas",color:t.muted,opacity:.7},children:"Try adjusting your filters"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:S.map(m=>{const g=j.has(m.name);return e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"10px 14px",cursor:"pointer",backgroundColor:g?t.backgroundSoft:"transparent",borderRadius:2,userSelect:"none",transition:"all 0.2s",border:g?`1px solid ${t.border}`:"1px solid transparent",marginBottom:4},onClick:()=>B(m.name),onMouseEnter:d=>{g||(d.currentTarget.style.backgroundColor=t.backgroundSoft,d.currentTarget.style.borderColor=t.border)},onMouseLeave:d=>{g||(d.currentTarget.style.backgroundColor="transparent",d.currentTarget.style.borderColor="transparent")},children:[e.jsx("span",{style:{marginRight:10,fontSize:12,fontFamily:"Consolas",transition:"transform 0.2s",transform:g?"rotate(90deg)":"rotate(0deg)",color:g?t.accent:t.muted},children:v.arrowRight}),e.jsx("h3",{style:{margin:0,fontSize:13,fontFamily:"Consolas",fontWeight:600,color:g?t.accent:t.foreground,flex:1,transition:"color 0.2s"},children:m.name}),e.jsx("span",{style:{fontSize:11,color:t.muted,fontFamily:"Consolas",padding:"4px 8px",backgroundColor:g?t.accent+"20":t.background,borderRadius:2,fontWeight:500,transition:"all 0.2s",border:`1px solid ${g?t.accent:t.border}`},children:m.vaults.length})]}),g&&e.jsx("div",{style:{marginLeft:24,marginTop:6,marginBottom:8,display:"flex",flexDirection:"column",gap:6,paddingLeft:12,borderLeft:`2px solid ${t.border}`},children:m.vaults.map(d=>{var E,w,L,h,I;const f=(a==null?void 0:a.vault_name)===d.vault_name;return e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"10px 12px",cursor:"pointer",borderRadius:2,border:`1px solid ${f?t.accent:t.border}`,backgroundColor:f?t.accent+"10":t.background,transition:"all 0.2s",position:"relative"},onMouseEnter:_=>{f||(_.currentTarget.style.backgroundColor=t.backgroundSoft,_.currentTarget.style.borderColor=t.accent,_.currentTarget.style.transform="translateX(4px)",_.currentTarget.style.boxShadow=`0 2px 8px ${t.accent}20`)},onMouseLeave:_=>{f||(_.currentTarget.style.backgroundColor=t.background,_.currentTarget.style.borderColor=t.border,_.currentTarget.style.transform="translateX(0)",_.currentTarget.style.boxShadow="none")},onClick:()=>u==null?void 0:u(d),children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas",color:f?t.accent:t.foreground,fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginBottom:4},children:d.vault_name}),e.jsxs("div",{style:{fontSize:11,color:t.muted,fontFamily:"Consolas",display:"flex",alignItems:"center",gap:8},children:[e.jsxs("span",{children:[((E=d.hubs)==null?void 0:E.length)||0,"H"]}),e.jsx("span",{style:{color:t.border},children:"•"}),e.jsxs("span",{children:[((w=d.links)==null?void 0:w.length)||0,"L"]}),e.jsx("span",{style:{color:t.border},children:"•"}),e.jsxs("span",{children:[((L=d.satellites)==null?void 0:L.length)||0,"S"]}),e.jsx("span",{style:{color:t.border},children:"•"}),e.jsxs("span",{children:[((h=d.point_in_time_tables)==null?void 0:h.length)||0,"PIT"]}),e.jsx("span",{style:{color:t.border},children:"•"}),e.jsxs("span",{children:[((I=d.bridge_tables)==null?void 0:I.length)||0,"B"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",marginLeft:12,paddingLeft:12,borderLeft:`1px solid ${t.border}`},children:[e.jsx("div",{style:{width:10,height:10,borderRadius:"50%",backgroundColor:d.active&&d.enabled?t.success:t.muted,boxShadow:d.active&&d.enabled?`0 0 6px ${t.success}40`:"none",transition:"all 0.2s"},title:d.active&&d.enabled?"Active":"Inactive"}),d.last_build_status==="SUCCESS"&&e.jsx("span",{style:{fontSize:14,color:t.success,fontFamily:"Consolas",lineHeight:1},title:"Last build successful",children:"✓"}),d.last_build_status==="ERROR"&&e.jsx("span",{style:{fontSize:14,color:t.danger,fontFamily:"Consolas",lineHeight:1},title:"Last build failed",children:"✗"})]})]},d.vault_name)})})]},m.name)})})},X={MariaDB:"host=localhost;user=myuser;password=mypassword;db=mydatabase;port=3306",MSSQL:"DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;DATABASE=mydatabase;UID=myuser;PWD=mypassword",Oracle:"host=localhost;user=myuser;password=mypassword;db=mydatabase;port=1521",PostgreSQL:"postgresql://myuser:mypassword@localhost:5432/mydatabase",MongoDB:"mongodb://myuser:mypassword@localhost:27017/mydatabase",Snowflake:"DRIVER={Snowflake Driver};SERVER=myaccount.snowflakecomputing.com;UID=myuser;PWD=mypassword;WAREHOUSE=mywarehouse;DATABASE=mydatabase;SCHEMA=myschema",BigQuery:JSON.stringify({project_id:"my-project-id",dataset_id:"my_dataset",access_token:"ya29.xxx..."},null,2),Redshift:"postgresql://myuser:mypassword@mycluster.region.redshift.amazonaws.com:5439/mydatabase"},le=({onClose:T,onSave:u,vault:r})=>{const R=(r==null?void 0:r.source_db_engine)||"PostgreSQL",U=(r==null?void 0:r.target_db_engine)||"PostgreSQL",[a,j]=l.useState({vault_name:(r==null?void 0:r.vault_name)||"",description:(r==null?void 0:r.description)||"",source_db_engine:R,source_connection_string:(r==null?void 0:r.source_connection_string)||X[R]||"",target_db_engine:U,target_connection_string:(r==null?void 0:r.target_connection_string)||X[U]||"",target_schema:(r==null?void 0:r.target_schema)||"",schedule_cron:(r==null?void 0:r.schedule_cron)||"",active:(r==null?void 0:r.active)!==void 0?r.active:!0,enabled:(r==null?void 0:r.enabled)!==void 0?r.enabled:!0,metadata:(r==null?void 0:r.metadata)||{}}),[C,S]=l.useState((r==null?void 0:r.hubs)||[]),[B,m]=l.useState((r==null?void 0:r.links)||[]),[g,d]=l.useState((r==null?void 0:r.satellites)||[]),[f,E]=l.useState((r==null?void 0:r.point_in_time_tables)||[]),[w,L]=l.useState((r==null?void 0:r.bridge_tables)||[]),[h,I]=l.useState(null),[_,W]=l.useState(!1),[b,z]=l.useState("basic"),M=l.useCallback(()=>{const n={hub_name:"",target_schema:a.target_schema||"",target_table:"",source_query:"",business_keys:[],hub_key_column:"hub_key",load_date_column:"load_date",record_source_column:"record_source",index_columns:[]};S([...C,n])},[C,a.target_schema]),F=l.useCallback((n,s,o)=>{S(p=>{const c=[...p];return s==="business_keys"||s==="index_columns"?c[n]={...c[n],[s]:typeof o=="string"?o.split(",").map(x=>x.trim()).filter(x=>x):o}:c[n]={...c[n],[s]:o},c})},[]),J=l.useCallback(n=>{S(s=>s.filter((o,p)=>p!==n))},[]),O=l.useCallback(()=>{const n={link_name:"",target_schema:a.target_schema||"",target_table:"",source_query:"",hub_references:[],link_key_column:"link_key",load_date_column:"load_date",record_source_column:"record_source",index_columns:[]};m([...B,n])},[B,a.target_schema]),D=l.useCallback((n,s,o)=>{m(p=>{const c=[...p];return s==="hub_references"||s==="index_columns"?c[n]={...c[n],[s]:typeof o=="string"?o.split(",").map(x=>x.trim()).filter(x=>x):o}:c[n]={...c[n],[s]:o},c})},[]),Z=l.useCallback(n=>{m(s=>s.filter((o,p)=>p!==n))},[]),Q=l.useCallback(()=>{const n={satellite_name:"",target_schema:a.target_schema||"",target_table:"",parent_hub_name:"",parent_link_name:"",source_query:"",parent_key_column:"parent_key",load_date_column:"load_date",load_end_date_column:"load_end_date",record_source_column:"record_source",descriptive_attributes:[],index_columns:[],is_historized:!0};d([...g,n])},[g,a.target_schema]),A=l.useCallback((n,s,o)=>{d(p=>{const c=[...p];return s==="descriptive_attributes"||s==="index_columns"?c[n]={...c[n],[s]:typeof o=="string"?o.split(",").map(x=>x.trim()).filter(x=>x):o}:c[n]={...c[n],[s]:o},c})},[]),q=l.useCallback(n=>{d(s=>s.filter((o,p)=>p!==n))},[]),N=l.useCallback(()=>{const n={pit_name:"",target_schema:a.target_schema||"",target_table:"",hub_name:"",satellite_names:[],snapshot_date_column:"snapshot_date",index_columns:[]};E([...f,n])},[f,a.target_schema]),P=l.useCallback((n,s,o)=>{E(p=>{const c=[...p];return s==="satellite_names"||s==="index_columns"?c[n]={...c[n],[s]:typeof o=="string"?o.split(",").map(x=>x.trim()).filter(x=>x):o}:c[n]={...c[n],[s]:o},c})},[]),K=l.useCallback(n=>{E(s=>s.filter((o,p)=>p!==n))},[]),G=l.useCallback(()=>{const n={bridge_name:"",target_schema:a.target_schema||"",target_table:"",hub_name:"",link_names:[],snapshot_date_column:"snapshot_date",index_columns:[]};L([...w,n])},[w,a.target_schema]),H=l.useCallback((n,s,o)=>{L(p=>{const c=[...p];return s==="link_names"||s==="index_columns"?c[n]={...c[n],[s]:typeof o=="string"?o.split(",").map(x=>x.trim()).filter(x=>x):o}:c[n]={...c[n],[s]:o},c})},[]),i=l.useCallback(n=>{L(s=>s.filter((o,p)=>p!==n))},[]),$=l.useCallback(async()=>{I(null),W(!0);try{const n={vault_name:a.vault_name,description:a.description||null,source_db_engine:a.source_db_engine,source_connection_string:a.source_connection_string,target_db_engine:a.target_db_engine,target_connection_string:a.target_connection_string,target_schema:a.target_schema,hubs:C,links:B,satellites:g,point_in_time_tables:f,bridge_tables:w,schedule_cron:a.schedule_cron||null,active:a.active,enabled:a.enabled,metadata:a.metadata};r?await V.updateVault(r.vault_name,n):await V.createVault(n),u()}catch(n){I(Y(n))}finally{W(!1)}},[a,C,B,g,f,w,r,u]);return e.jsx(k,{title:r?`EDIT VAULT: ${r.vault_name}`:"ADD DATA VAULT",onClose:T,style:{width:"90vw",maxWidth:"1200px",maxHeight:"90vh",overflow:"auto"},children:e.jsxs("div",{style:{padding:16,fontFamily:"Consolas",fontSize:12},children:[h&&e.jsx("div",{style:{padding:12,marginBottom:16,backgroundColor:t.danger+"20",border:`1px solid ${t.danger}`,borderRadius:2,color:t.danger},children:h}),e.jsx("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:`1px solid ${t.border}`,paddingBottom:8},children:["basic","hubs","links","satellites","pit","bridge"].map(n=>e.jsx(y,{label:n.charAt(0).toUpperCase()+n.slice(1),onClick:()=>z(n),variant:b===n?"primary":"ghost"},n))}),b==="basic"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,color:t.foreground,fontWeight:600},children:"Vault Name *"}),e.jsx("input",{type:"text",value:a.vault_name,onChange:n=>j(s=>({...s,vault_name:n.target.value})),disabled:!!r,style:{width:"100%",padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:r?t.backgroundSoft:t.background,color:t.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,color:t.foreground,fontWeight:600},children:"Description"}),e.jsx("textarea",{value:a.description,onChange:n=>j(s=>({...s,description:n.target.value})),rows:3,style:{width:"100%",padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:t.background,color:t.foreground,outline:"none",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,color:t.foreground,fontWeight:600},children:"Source DB Engine *"}),e.jsxs("select",{value:a.source_db_engine,onChange:n=>{const s=n.target.value;j(o=>({...o,source_db_engine:s,source_connection_string:X[s]||o.source_connection_string}))},style:{width:"100%",padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:t.background,color:t.foreground,cursor:"pointer",outline:"none"},children:[e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"MariaDB",children:"MariaDB"}),e.jsx("option",{value:"MSSQL",children:"MSSQL"}),e.jsx("option",{value:"MongoDB",children:"MongoDB"}),e.jsx("option",{value:"Oracle",children:"Oracle"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,color:t.foreground,fontWeight:600},children:"Target DB Engine *"}),e.jsxs("select",{value:a.target_db_engine,onChange:n=>{const s=n.target.value;j(o=>({...o,target_db_engine:s,target_connection_string:X[s]||o.target_connection_string}))},style:{width:"100%",padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:t.background,color:t.foreground,cursor:"pointer",outline:"none"},children:[e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"Snowflake",children:"Snowflake"}),e.jsx("option",{value:"BigQuery",children:"BigQuery"}),e.jsx("option",{value:"Redshift",children:"Redshift"})]})]})]}),e.jsx("div",{children:e.jsx(ee,{value:a.source_connection_string,onChange:n=>j(s=>({...s,source_connection_string:n})),dbEngine:a.source_db_engine,label:"Source Connection String",required:!0})}),e.jsx("div",{children:e.jsx(ee,{value:a.target_connection_string,onChange:n=>j(s=>({...s,target_connection_string:n})),dbEngine:a.target_db_engine,label:"Target Connection String",required:!0})}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,color:t.foreground,fontWeight:600},children:"Target Schema *"}),e.jsx("input",{type:"text",value:a.target_schema,onChange:n=>j(s=>({...s,target_schema:n.target.value})),style:{width:"100%",padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:t.background,color:t.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,color:t.foreground,fontWeight:600},children:"Schedule Cron (optional)"}),e.jsx("input",{type:"text",value:a.schedule_cron,onChange:n=>j(s=>({...s,schedule_cron:n.target.value})),placeholder:"0 0 * * * (daily at midnight)",style:{width:"100%",padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:t.background,color:t.foreground,outline:"none"}})]}),e.jsxs("div",{style:{display:"flex",gap:16},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:a.active,onChange:n=>j(s=>({...s,active:n.target.checked}))}),e.jsx("span",{style:{color:t.foreground},children:"Active"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:a.enabled,onChange:n=>j(s=>({...s,enabled:n.target.checked}))}),e.jsx("span",{style:{color:t.foreground},children:"Enabled"})]})]})]}),b==="hubs"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h3",{style:{margin:0,color:t.foreground},children:["Hub Tables (",C.length,")"]}),e.jsx(y,{label:"Add Hub",onClick:M,variant:"primary"})]}),C.map((n,s)=>e.jsx(k,{title:`Hub ${s+1}: ${n.hub_name||"Unnamed"}`,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,padding:12},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Hub Name *"}),e.jsx("input",{type:"text",value:n.hub_name,onChange:o=>F(s,"hub_name",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Target Table *"}),e.jsx("input",{type:"text",value:n.target_table,onChange:o=>F(s,"target_table",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Source Query *"}),e.jsx("textarea",{value:n.source_query,onChange:o=>F(s,"source_query",o.target.value),rows:3,style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Business Keys (comma-separated) *"}),e.jsx("input",{type:"text",value:n.business_keys.join(", "),onChange:o=>F(s,"business_keys",o.target.value),placeholder:"customer_id, order_id",style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:8},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Hub Key Column"}),e.jsx("input",{type:"text",value:n.hub_key_column,onChange:o=>F(s,"hub_key_column",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Load Date Column"}),e.jsx("input",{type:"text",value:n.load_date_column,onChange:o=>F(s,"load_date_column",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Record Source Column"}),e.jsx("input",{type:"text",value:n.record_source_column,onChange:o=>F(s,"record_source_column",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]})]}),e.jsx(y,{label:"Remove",onClick:()=>J(s),variant:"danger"})]})},s))]}),b==="links"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h3",{style:{margin:0,color:t.foreground},children:["Link Tables (",B.length,")"]}),e.jsx(y,{label:"Add Link",onClick:O,variant:"primary"})]}),B.map((n,s)=>e.jsx(k,{title:`Link ${s+1}: ${n.link_name||"Unnamed"}`,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,padding:12},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Link Name *"}),e.jsx("input",{type:"text",value:n.link_name,onChange:o=>D(s,"link_name",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Target Table *"}),e.jsx("input",{type:"text",value:n.target_table,onChange:o=>D(s,"target_table",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Source Query *"}),e.jsx("textarea",{value:n.source_query,onChange:o=>D(s,"source_query",o.target.value),rows:3,style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Hub References (comma-separated) *"}),e.jsx("input",{type:"text",value:n.hub_references.join(", "),onChange:o=>D(s,"hub_references",o.target.value),placeholder:"customer_hub, order_hub",style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsx(y,{label:"Remove",onClick:()=>Z(s),variant:"danger"})]})},s))]}),b==="satellites"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h3",{style:{margin:0,color:t.foreground},children:["Satellite Tables (",g.length,")"]}),e.jsx(y,{label:"Add Satellite",onClick:Q,variant:"primary"})]}),g.map((n,s)=>e.jsx(k,{title:`Satellite ${s+1}: ${n.satellite_name||"Unnamed"}`,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,padding:12},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Satellite Name *"}),e.jsx("input",{type:"text",value:n.satellite_name,onChange:o=>A(s,"satellite_name",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Target Table *"}),e.jsx("input",{type:"text",value:n.target_table,onChange:o=>A(s,"target_table",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Parent Hub Name"}),e.jsx("input",{type:"text",value:n.parent_hub_name,onChange:o=>A(s,"parent_hub_name",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Parent Link Name"}),e.jsx("input",{type:"text",value:n.parent_link_name,onChange:o=>A(s,"parent_link_name",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Source Query *"}),e.jsx("textarea",{value:n.source_query,onChange:o=>A(s,"source_query",o.target.value),rows:3,style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Descriptive Attributes (comma-separated)"}),e.jsx("input",{type:"text",value:n.descriptive_attributes.join(", "),onChange:o=>A(s,"descriptive_attributes",o.target.value),placeholder:"name, email, address",style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:n.is_historized,onChange:o=>A(s,"is_historized",o.target.checked)}),e.jsx("span",{style:{fontSize:11},children:"Historized (track history)"})]}),e.jsx(y,{label:"Remove",onClick:()=>q(s),variant:"danger"})]})},s))]}),b==="pit"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h3",{style:{margin:0,color:t.foreground},children:["Point-in-Time Tables (",f.length,")"]}),e.jsx(y,{label:"Add PIT",onClick:N,variant:"primary"})]}),f.map((n,s)=>e.jsx(k,{title:`PIT ${s+1}: ${n.pit_name||"Unnamed"}`,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,padding:12},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"PIT Name *"}),e.jsx("input",{type:"text",value:n.pit_name,onChange:o=>P(s,"pit_name",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Target Table *"}),e.jsx("input",{type:"text",value:n.target_table,onChange:o=>P(s,"target_table",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Hub Name *"}),e.jsx("input",{type:"text",value:n.hub_name,onChange:o=>P(s,"hub_name",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Satellite Names (comma-separated) *"}),e.jsx("input",{type:"text",value:n.satellite_names.join(", "),onChange:o=>P(s,"satellite_names",o.target.value),placeholder:"customer_sat, order_sat",style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsx(y,{label:"Remove",onClick:()=>K(s),variant:"danger"})]})},s))]}),b==="bridge"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h3",{style:{margin:0,color:t.foreground},children:["Bridge Tables (",w.length,")"]}),e.jsx(y,{label:"Add Bridge",onClick:G,variant:"primary"})]}),w.map((n,s)=>e.jsx(k,{title:`Bridge ${s+1}: ${n.bridge_name||"Unnamed"}`,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,padding:12},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Bridge Name *"}),e.jsx("input",{type:"text",value:n.bridge_name,onChange:o=>H(s,"bridge_name",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Target Table *"}),e.jsx("input",{type:"text",value:n.target_table,onChange:o=>H(s,"target_table",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Hub Name *"}),e.jsx("input",{type:"text",value:n.hub_name,onChange:o=>H(s,"hub_name",o.target.value),style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:11},children:"Link Names (comma-separated) *"}),e.jsx("input",{type:"text",value:n.link_names.join(", "),onChange:o=>H(s,"link_names",o.target.value),placeholder:"customer_order_link, order_item_link",style:{width:"100%",padding:"4px 8px",fontSize:11,fontFamily:"Consolas"}})]}),e.jsx(y,{label:"Remove",onClick:()=>i(s),variant:"danger"})]})},s))]}),e.jsxs("div",{style:{marginTop:20,display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx(y,{label:"Cancel",onClick:T,variant:"ghost"}),e.jsx(y,{label:_?"Saving...":r?"Update":"Create",onClick:$,variant:"primary",disabled:_})]})]})})},ye=()=>{var N,P,K,G,H;const{setPage:T}=te(1,20),{filters:u,setFilter:r}=ne({source_db_engine:"",target_db_engine:"",active:""}),[R,U]=l.useState(""),[a,j]=l.useState(""),[C,S]=l.useState(null),[B,m]=l.useState([]),[g,d]=l.useState(!0),[f,E]=l.useState(!1),[w,L]=l.useState(null),[h,I]=l.useState(null),[_,W]=l.useState(!1),b=l.useRef(!0),z=l.useCallback(async()=>{if(!b.current)return;const i=Date.now(),$=300;try{d(!0),S(null);const s={page:1,limit:1e4,search:se(a,100)};u.source_db_engine&&(s.source_db_engine=u.source_db_engine),u.target_db_engine&&(s.target_db_engine=u.target_db_engine),u.active&&(s.active=u.active);const o=await V.getVaults(s),p=Date.now()-i,c=Math.max(0,$-p);await new Promise(x=>setTimeout(x,c)),b.current&&m(o.data||[])}catch(n){b.current&&S(Y(n))}finally{b.current&&d(!1)}},[a,u]);l.useEffect(()=>(b.current=!0,z(),()=>{b.current=!1}),[z]);const M=l.useCallback(()=>{j(R),T(1)},[R,T]),F=l.useCallback(i=>{i.key==="Enter"&&M()},[M]),J=l.useCallback(async i=>{if(confirm(`Are you sure you want to delete vault "${i}"?`))try{await V.deleteVault(i),z()}catch($){b.current&&S(Y($))}},[z]),O=l.useCallback(i=>{L(i||null),E(!0)},[]),D=l.useCallback(()=>{E(!1),L(null)},[]),Z=l.useCallback(()=>{z(),D()},[z,D]),Q=l.useCallback(async i=>{try{S(null),await V.buildVault(i),z(),setTimeout(()=>{z()},2e3)}catch($){b.current&&S(Y($))}},[z]),A=l.useCallback(async i=>{I(i),S(null)},[]),q=B.filter(i=>!(u.source_db_engine&&i.source_db_engine!==u.source_db_engine||u.target_db_engine&&i.target_db_engine!==u.target_db_engine||u.active&&String(i.active)!==u.active));return g&&B.length===0?e.jsx(oe,{variant:"table"}):e.jsxs("div",{style:{padding:"20px",fontFamily:"Consolas",fontSize:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:0,color:t.foreground,textTransform:"uppercase",fontFamily:"Consolas"},children:[e.jsx("span",{style:{color:t.accent,marginRight:8},children:v.blockFull}),"DATA VAULT 2.0"]}),e.jsx(y,{label:"Data Vault 2.0 Playbook",onClick:()=>W(!0),variant:"ghost"})]}),C&&e.jsx("div",{style:{marginBottom:20},children:e.jsx(k,{title:"ERROR",children:e.jsx("div",{style:{padding:"12px",color:t.foreground,fontSize:12,fontFamily:"Consolas",border:`2px solid ${t.foreground}`},children:C})})}),e.jsx(k,{title:"SEARCH",children:e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",padding:"8px 0"},children:[e.jsx("input",{type:"text",placeholder:"Search by vault name, schema, or target...",value:R,onChange:i=>U(i.target.value),onKeyPress:F,style:{flex:1,padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:t.background,color:t.foreground,outline:"none"},onFocus:i=>{i.currentTarget.style.borderColor=t.accent},onBlur:i=>{i.currentTarget.style.borderColor=t.border}}),e.jsx(y,{label:"Search",onClick:M,variant:"primary"}),a&&e.jsx(y,{label:"Clear",onClick:()=>{U(""),j(""),T(1)},variant:"ghost"})]})}),e.jsx("div",{style:{marginTop:20},children:e.jsx(k,{title:"FILTERS",children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,padding:"8px 0"},children:[e.jsx(y,{label:"Add Vault",onClick:()=>O(),variant:"primary"}),e.jsxs("select",{value:u.source_db_engine,onChange:i=>r("source_db_engine",i.target.value),style:{padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:t.background,color:t.foreground,cursor:"pointer",outline:"none"},onFocus:i=>{i.currentTarget.style.borderColor=t.accent},onBlur:i=>{i.currentTarget.style.borderColor=t.border},children:[e.jsx("option",{value:"",children:"All Source Engines"}),e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"MariaDB",children:"MariaDB"}),e.jsx("option",{value:"MSSQL",children:"MSSQL"}),e.jsx("option",{value:"MongoDB",children:"MongoDB"}),e.jsx("option",{value:"Oracle",children:"Oracle"}),e.jsx("option",{value:"DB2",children:"DB2"}),e.jsx("option",{value:"Salesforce",children:"Salesforce"}),e.jsx("option",{value:"SAP",children:"SAP"}),e.jsx("option",{value:"Teradata",children:"Teradata"}),e.jsx("option",{value:"Netezza",children:"Netezza"}),e.jsx("option",{value:"Hive",children:"Hive"}),e.jsx("option",{value:"Cassandra",children:"Cassandra"}),e.jsx("option",{value:"DynamoDB",children:"DynamoDB"}),e.jsx("option",{value:"AS400",children:"AS/400"}),e.jsx("option",{value:"S3",children:"S3"}),e.jsx("option",{value:"AzureBlob",children:"Azure Blob"}),e.jsx("option",{value:"GCS",children:"Google Cloud Storage"}),e.jsx("option",{value:"FTP",children:"FTP"}),e.jsx("option",{value:"SFTP",children:"SFTP"}),e.jsx("option",{value:"Email",children:"Email"}),e.jsx("option",{value:"SOAP",children:"SOAP"}),e.jsx("option",{value:"GraphQL",children:"GraphQL"}),e.jsx("option",{value:"Excel",children:"Excel"}),e.jsx("option",{value:"FixedWidth",children:"Fixed Width"}),e.jsx("option",{value:"EBCDIC",children:"EBCDIC"}),e.jsx("option",{value:"XML",children:"XML"}),e.jsx("option",{value:"Avro",children:"Avro"}),e.jsx("option",{value:"Parquet",children:"Parquet"}),e.jsx("option",{value:"ORC",children:"ORC"}),e.jsx("option",{value:"Compressed",children:"Compressed"})]}),e.jsxs("select",{value:u.target_db_engine,onChange:i=>r("target_db_engine",i.target.value),style:{padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:t.background,color:t.foreground,cursor:"pointer",outline:"none"},onFocus:i=>{i.currentTarget.style.borderColor=t.accent},onBlur:i=>{i.currentTarget.style.borderColor=t.border},children:[e.jsx("option",{value:"",children:"All Target Engines"}),e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"Snowflake",children:"Snowflake"}),e.jsx("option",{value:"BigQuery",children:"BigQuery"}),e.jsx("option",{value:"Redshift",children:"Redshift"})]}),e.jsxs("select",{value:u.active,onChange:i=>r("active",i.target.value),style:{padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:t.background,color:t.foreground,cursor:"pointer",outline:"none"},onFocus:i=>{i.currentTarget.style.borderColor=t.accent},onBlur:i=>{i.currentTarget.style.borderColor=t.border},children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]})})}),e.jsxs("div",{style:{marginTop:20,display:"flex",gap:20},children:[e.jsx("div",{style:{flex:1},children:e.jsx(k,{title:"VAULTS",style:{minHeight:400},children:g?e.jsx("div",{style:{padding:"20px",textAlign:"center",color:t.muted,fontSize:12},children:"Loading vaults..."}):q.length===0?e.jsx("div",{style:{padding:"20px",textAlign:"center",color:t.muted,fontSize:12},children:"No vaults found"}):e.jsx(re,{vaults:q,onVaultClick:A,onEdit:O,onDelete:J,onBuild:Q,selectedVault:h})})}),h&&e.jsx("div",{style:{flex:1},children:e.jsx(k,{title:`VAULT: ${h.vault_name}`,children:e.jsxs("div",{style:{padding:"12px",fontSize:11,fontFamily:"Consolas",lineHeight:1.6,color:t.foreground},children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("strong",{style:{color:t.accent},children:"Description:"})," ",h.description||"N/A"]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("strong",{style:{color:t.accent},children:"Source Engine:"})," ",h.source_db_engine]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("strong",{style:{color:t.accent},children:"Target Engine:"})," ",h.target_db_engine]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("strong",{style:{color:t.accent},children:"Target Schema:"})," ",h.target_schema]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("strong",{style:{color:t.accent},children:"Hubs:"})," ",((N=h.hubs)==null?void 0:N.length)||0]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("strong",{style:{color:t.accent},children:"Links:"})," ",((P=h.links)==null?void 0:P.length)||0]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("strong",{style:{color:t.accent},children:"Satellites:"})," ",((K=h.satellites)==null?void 0:K.length)||0]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("strong",{style:{color:t.accent},children:"Point-in-Time Tables:"})," ",((G=h.point_in_time_tables)==null?void 0:G.length)||0]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("strong",{style:{color:t.accent},children:"Bridge Tables:"})," ",((H=h.bridge_tables)==null?void 0:H.length)||0]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("strong",{style:{color:t.accent},children:"Status:"})," ",e.jsx("span",{style:{color:h.active?t.accent:t.foreground,fontWeight:600},children:h.active?"ACTIVE":"INACTIVE"}),h.last_build_status&&e.jsxs(e.Fragment,{children:[" | ",e.jsx("strong",{style:{color:t.accent},children:"Last Build:"})," ",e.jsx("span",{style:{color:h.last_build_status==="SUCCESS"?t.accent:t.foreground,fontWeight:600},children:h.last_build_status})]})]}),h.last_build_time&&e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("strong",{style:{color:t.accent},children:"Last Build Time:"})," ",new Date(h.last_build_time).toLocaleString()]}),e.jsxs("div",{style:{marginTop:20,display:"flex",gap:8},children:[e.jsx(y,{label:"Edit",onClick:()=>O(h),variant:"primary"}),e.jsx(y,{label:"Build",onClick:()=>Q(h.vault_name),variant:"primary"})]})]})})})]}),f&&e.jsx(le,{vault:w,onClose:D,onSave:Z}),_&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>W(!1),children:e.jsx("div",{style:{width:"90%",maxWidth:1e3,maxHeight:"90vh",overflowY:"auto"},onClick:i=>i.stopPropagation(),children:e.jsx(k,{title:"DATA VAULT 2.0 PLAYBOOK",children:e.jsxs("div",{style:{padding:16,fontFamily:"Consolas",fontSize:12,lineHeight:1.6},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:t.accent,marginBottom:12},children:[v.blockFull," OVERVIEW"]}),e.jsx("div",{style:{color:t.foreground,marginLeft:16},children:"Data Vault 2.0 is a data modeling methodology designed for building scalable, flexible, and auditable data warehouses. It separates business keys (Hubs), relationships (Links), and descriptive attributes (Satellites) into distinct tables, enabling parallel loading, historical tracking, and easy schema evolution without impacting existing data."})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:t.accent,marginBottom:12},children:[v.blockFull," CORE COMPONENTS"]}),e.jsxs("div",{style:{color:t.foreground,marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:12,padding:"12px",backgroundColor:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:t.accent,marginBottom:6,fontSize:11},children:"HUBS (Business Entities)"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:["• ",e.jsx("strong",{children:"Purpose:"})," Store unique business keys that identify core business entities",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Structure:"})," hub_key (hash of business keys), business_keys[], load_date, record_source",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Example:"})," Customer Hub with business_key = customer_id",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Key Feature:"})," One row per unique business key, regardless of how many times it appears in source"]})]}),e.jsxs("div",{style:{marginBottom:12,padding:"12px",backgroundColor:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:t.accent,marginBottom:6,fontSize:11},children:"LINKS (Relationships)"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:["• ",e.jsx("strong",{children:"Purpose:"})," Represent many-to-many relationships between hubs",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Structure:"})," link_key (hash), hub_references[], load_date, record_source",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Example:"})," Order-Product Link connecting Customer Hub and Product Hub",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Key Feature:"})," Enables flexible relationship modeling without denormalization"]})]}),e.jsxs("div",{style:{marginBottom:12,padding:"12px",backgroundColor:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:t.accent,marginBottom:6,fontSize:11},children:"SATELLITES (Descriptive Attributes)"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:["• ",e.jsx("strong",{children:"Purpose:"})," Store descriptive attributes and historical changes for hubs or links",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Structure:"})," parent_key (hub_key or link_key), descriptive_attributes[], load_date, load_end_date (if historized), record_source",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Example:"})," Customer Satellite with name, email, address, phone (changes tracked over time)",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Key Feature:"})," Full history preservation - every change creates a new row with load_date"]})]}),e.jsxs("div",{style:{marginBottom:12,padding:"12px",backgroundColor:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:t.accent,marginBottom:6,fontSize:11},children:"POINT-IN-TIME (PIT) TABLES"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:["• ",e.jsx("strong",{children:"Purpose:"})," Provide efficient temporal snapshots for querying historical data at specific points in time",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Structure:"})," hub_key, snapshot_date, satellite_load_dates[]",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Example:"})," Customer PIT showing which satellite version was active on each date",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Key Feature:"})," Pre-calculated snapshots eliminate complex temporal joins in queries"]})]}),e.jsxs("div",{style:{marginBottom:12,padding:"12px",backgroundColor:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:t.accent,marginBottom:6,fontSize:11},children:"BRIDGE TABLES"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:["• ",e.jsx("strong",{children:"Purpose:"})," Optimize queries by pre-joining hubs with multiple links",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Structure:"})," hub_key, snapshot_date, link_keys[]",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Example:"})," Customer Bridge connecting Customer Hub to Order Link, Payment Link, etc.",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Key Feature:"})," Reduces join complexity for analytical queries spanning multiple relationships"]})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:t.accent,marginBottom:12},children:[v.blockFull," BUILD PROCESS"]}),e.jsxs("div",{style:{color:t.foreground,marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:t.muted,marginBottom:8,fontSize:11},children:"1. BUILD HUBS"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.6,marginLeft:8},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Execute ",e.jsx("code",{style:{color:t.accent},children:"source_query"})," from source database"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Extract ",e.jsx("code",{style:{color:t.accent},children:"business_keys"})," from each row"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Generate ",e.jsx("code",{style:{color:t.accent},children:"hub_key"})," (hash of business keys)"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Insert into hub table: ",e.jsx("code",{style:{color:t.accent},children:"{target_schema}.{hub_table}"})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Only new business keys are inserted (no updates)"]})]})]}),e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:t.accent,marginBottom:8,fontSize:11},children:"2. BUILD LINKS"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.6,marginLeft:8},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Execute ",e.jsx("code",{style:{color:t.accent},children:"source_query"})," to get relationship data"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Resolve ",e.jsx("code",{style:{color:t.accent},children:"hub_references"})," to get hub_keys from parent hubs"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Generate ",e.jsx("code",{style:{color:t.accent},children:"link_key"})," (hash of referenced hub_keys)"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Insert into link table: ",e.jsx("code",{style:{color:t.accent},children:"{target_schema}.{link_table}"})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Links are append-only (new relationships create new rows)"]})]})]}),e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:t.accent,marginBottom:8,fontSize:11},children:"3. BUILD SATELLITES"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.6,marginLeft:8},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Execute ",e.jsx("code",{style:{color:t.accent},children:"source_query"})," to get descriptive attributes"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Resolve ",e.jsx("code",{style:{color:t.accent},children:"parent_hub_name"})," or ",e.jsx("code",{style:{color:t.accent},children:"parent_link_name"})," to get parent_key"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Extract ",e.jsx("code",{style:{color:t.accent},children:"descriptive_attributes"})," from source"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," If ",e.jsx("code",{style:{color:t.accent},children:"is_historized = true"}),": Set load_end_date on previous row, insert new row"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," If ",e.jsx("code",{style:{color:t.accent},children:"is_historized = false"}),": Update existing row or insert new"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Insert into satellite table: ",e.jsx("code",{style:{color:t.accent},children:"{target_schema}.{satellite_table}"})]})]})]}),e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:t.accent,marginBottom:8,fontSize:11},children:"4. BUILD POINT-IN-TIME TABLES"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.6,marginLeft:8},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Query all hub_keys from parent ",e.jsx("code",{style:{color:t.accent},children:"hub_name"})]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," For each hub_key, query referenced ",e.jsx("code",{style:{color:t.accent},children:"satellite_names"})," to get load_dates"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Generate snapshot rows with ",e.jsx("code",{style:{color:t.accent},children:"snapshot_date"})," and satellite load_dates"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Insert into PIT table: ",e.jsx("code",{style:{color:t.accent},children:"{target_schema}.{pit_table}"})]})]})]}),e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:t.accent,marginBottom:8,fontSize:11},children:"5. BUILD BRIDGE TABLES"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.6,marginLeft:8},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Query all hub_keys from parent ",e.jsx("code",{style:{color:t.accent},children:"hub_name"})]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," For each hub_key, query referenced ",e.jsx("code",{style:{color:t.accent},children:"link_names"})," to get link_keys"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Generate snapshot rows with ",e.jsx("code",{style:{color:t.accent},children:"snapshot_date"})," and link_keys"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:t.muted},children:"└─"})," Insert into bridge table: ",e.jsx("code",{style:{color:t.accent},children:"{target_schema}.{bridge_table}"})]})]})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:t.accent,marginBottom:12},children:[v.blockFull," KEY FEATURES"]}),e.jsxs("div",{style:{color:t.foreground,marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.accent},children:v.blockFull})," ",e.jsx("strong",{children:"Parallel Loading:"})," Hubs, Links, and Satellites can be loaded independently and in parallel"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.accent},children:v.blockFull})," ",e.jsx("strong",{children:"Historical Tracking:"})," Satellites preserve complete history with load_date and load_end_date"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.accent},children:v.blockFull})," ",e.jsx("strong",{children:"Schema Evolution:"})," Add new satellites without modifying existing hubs or links"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.accent},children:v.blockFull})," ",e.jsx("strong",{children:"Audit Trail:"})," Every row includes load_date and record_source for full traceability"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.accent},children:v.blockFull})," ",e.jsx("strong",{children:"Hash Keys:"})," Business keys are hashed to create surrogate keys (hub_key, link_key) for performance"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.accent},children:v.blockFull})," ",e.jsx("strong",{children:"No Updates:"})," Hubs and Links are append-only; only Satellites can be updated (if not historized)"]})]})]}),e.jsxs("div",{style:{marginTop:16,padding:12,background:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:t.muted,marginBottom:4},children:[v.blockSemi," Best Practices"]}),e.jsxs("div",{style:{fontSize:11,color:t.foreground,lineHeight:1.6},children:["• Start with Hubs - identify core business entities and their business keys",e.jsx("br",{}),"• Use Links for many-to-many relationships between hubs",e.jsx("br",{}),"• Create separate Satellites for different rate-of-change attributes (fast vs. slow changing)",e.jsx("br",{}),"• Enable historization (is_historized = true) for Satellites that track changes over time",e.jsx("br",{}),"• Use PIT tables to optimize queries that need historical snapshots",e.jsx("br",{}),"• Use Bridge tables to pre-join hubs with multiple links for analytical queries",e.jsx("br",{}),"• Keep business keys consistent across all source systems",e.jsx("br",{}),"• Use descriptive names for hubs, links, and satellites that reflect business terminology",e.jsx("br",{}),"• Monitor build status and last_build_time to ensure data freshness"]})]}),e.jsx("div",{style:{marginTop:16,textAlign:"right"},children:e.jsx(y,{label:"Close",onClick:()=>W(!1),variant:"ghost"})})]})})})})]})};export{ye as default};
