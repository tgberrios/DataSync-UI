import{f as X,t as a,b as t,r as o,a as y,j as e,e as m,l as Ae}from"./index-75d7470b.js";import{S as we}from"./SkeletonLoader-530eacc4.js";import{e as k}from"./errorHandler-5ea9ae85.js";import{A as T}from"./AsciiPanel-9f053981.js";import{A as u}from"./AsciiButton-446d8430.js";const ee=X.table`
  width: 100%;
  border-collapse: collapse;
  margin-top: ${a.spacing.lg};
  background: ${a.colors.background.main};
  box-shadow: ${a.shadows.md};
  border-radius: ${a.borderRadius.md};
  overflow: hidden;
`,d=X.th`
  padding: ${a.spacing.sm};
  text-align: left;
  border-bottom: 2px solid ${t.border};
  background: ${t.backgroundSoft};
  font-weight: bold;
  font-family: "Consolas";
  font-size: 13px;
  color: ${t.accent};
  position: sticky;
  top: 0;
  z-index: 10;
`,l=X.td`
  padding: ${a.spacing.sm};
  border-bottom: 1px solid ${t.border};
  font-family: "Consolas";
  font-size: 12px;
  transition: all ${a.transitions.normal};
`,G=X.tr`
  transition: all ${a.transitions.normal};
  
  &:hover {
    background: linear-gradient(90deg, ${a.colors.background.main} 0%, ${a.colors.background.tertiary} 100%);
    transform: scale(1.001);
    box-shadow: ${a.shadows.sm};
    
    ${l} {
      border-bottom-color: rgba(10, 25, 41, 0.1);
    }
  }
`,te=x=>{switch(x){case"FULL":return t.danger;case"PARTIAL":return t.warning;case"EMAIL":return t.accent;case"PHONE":return t.accent;case"HASH":return t.muted;case"TOKENIZE":return t.success;default:return t.muted}},Re=x=>{switch(x){case"ACTIVE":return t.success;case"INACTIVE":return t.danger;default:return t.muted}},ze=x=>x?new Date(x).toLocaleString():"-",Fe=()=>{const x=o.useRef(!0),[se,O]=o.useState(!0),[B,h]=o.useState(null),[P,ce]=o.useState([]),[ge,w]=o.useState(!1),[p,j]=o.useState(null),[f,F]=o.useState({schema_name:"",table_name:"",masking_type:"",active:""}),[R,ne]=o.useState(1),[$,me]=o.useState(0),N=20,[_,ue]=o.useState(null),[he,ae]=o.useState(!1),[pe,M]=o.useState(!1),[W,oe]=o.useState(!1),[C,D]=o.useState(null),[c,L]=o.useState({database_name:"",database_names:[],schema_name:"",masking_type:"FULL",auto_activate:!0,min_confidence:.75}),[ie,xe]=o.useState([]),[fe,re]=o.useState(!1),[g,U]=o.useState("policies"),[S,H]=o.useState([]),[b,Q]=o.useState([]),[le,V]=o.useState(!1),[de,Y]=o.useState(!1),z=o.useRef(!1),I=o.useRef(!1),K=o.useRef(null),q=o.useRef(null),[ye,Z]=o.useState(!1),J=[{value:"FULL",label:"Full Mask (***MASKED***)"},{value:"PARTIAL",label:"Partial Mask (j***@email.com)"},{value:"EMAIL",label:"Email Mask (j***@email.com)"},{value:"PHONE",label:"Phone Mask (555-****)"},{value:"HASH",label:"Hash (SHA256)"},{value:"TOKENIZE",label:"Tokenize (TOKEN_xxx)"}],v=o.useCallback(async()=>{if(!x.current)return;const s=Date.now(),n=300;try{O(!0),h(null);const i={page:R,limit:N};f.schema_name&&(i.schema_name=f.schema_name),f.table_name&&(i.table_name=f.table_name),f.masking_type&&(i.masking_type=f.masking_type),f.active!==""&&(i.active=f.active==="true");const r=await y.getAll(i),A=Date.now()-s,Te=Math.max(0,n-A);await new Promise(Le=>setTimeout(Le,Te)),x.current&&(ce(r.policies||[]),me(r.total||0))}catch(i){x.current&&h(k(i))}finally{x.current&&O(!1)}},[R,f]);o.useEffect(()=>(x.current=!0,v(),()=>{x.current=!1}),[v]);const be=o.useCallback(()=>{j({policy_name:"",schema_name:"",table_name:"",column_name:"",masking_type:"FULL",active:!0}),w(!0)},[]),je=o.useCallback(s=>{j({...s}),w(!0)},[]),ve=o.useCallback(async s=>{if(confirm("Are you sure you want to delete this masking policy?"))try{await y.delete(s),await v()}catch(n){h(k(n))}},[v]),ke=o.useCallback(async()=>{if(p)try{p.policy_id?await y.update(p.policy_id,p):await y.create(p),w(!1),j(null),await v()}catch(s){h(k(s))}},[p,v]),Se=o.useCallback(async(s,n)=>{try{O(!0);const i=await y.analyzeSensitiveColumns(s,n);i.columns&&i.columns.length>0?alert(`Found ${i.columns.length} potentially sensitive columns:
${i.columns.map(r=>`- ${r.column_name} (${r.pii_category||"Unknown"})`).join(`
`)}`):alert("No sensitive columns detected.")}catch(i){h(k(i))}finally{O(!1)}},[]),E=o.useCallback(async()=>{try{ae(!0);const s=await y.getStatus();ue(s)}catch(s){h(k(s))}finally{ae(!1)}},[]),_e=o.useCallback(async()=>{try{oe(!0),h(null);const s={schema_name:c.schema_name,masking_type:c.masking_type,auto_activate:c.auto_activate,min_confidence:c.min_confidence};c.database_names&&c.database_names.length>0?s.database_names=c.database_names:c.database_name&&(s.database_name=c.database_name);const n=await y.batchAnalyze(s);D(n),await v(),await E()}catch(s){h(k(s))}finally{oe(!1)}},[c,v,E]),Ce=o.useCallback(async()=>{if(confirm("Are you sure you want to deactivate ALL masking policies? This will disable masking for all columns."))try{re(!0),h(null);const s=await y.deactivateAll();alert(`Successfully deactivated ${s.deactivated_count} masking policies.`),await v(),await E()}catch(s){h(k(s))}finally{re(!1)}},[v,E]);o.useEffect(()=>{g==="sensitive"&&K.current!=="sensitive"&&!le&&!z.current?(K.current="sensitive",z.current=!0,(async()=>{try{V(!0),h(null);const n=await y.getSensitiveColumns();H(n.columns||[])}catch(n){h(k(n)),H([{_error:!0}])}finally{V(!1),z.current=!1}})()):g!=="sensitive"&&(K.current=null)},[g]),o.useEffect(()=>{g==="unprotected"&&q.current!=="unprotected"&&!de&&!I.current?(q.current="unprotected",I.current=!0,(async()=>{try{Y(!0),h(null);const n=await y.getUnprotectedColumns();Q(n.columns||[])}catch(n){h(k(n)),Q([{_error:!0}])}finally{Y(!1),I.current=!1}})()):g!=="unprotected"&&(q.current=null)},[g]),o.useEffect(()=>{E(),Ee(),(async()=>{if(!z.current){z.current=!0;try{V(!0);const n=await y.getSensitiveColumns();H(n.columns||[])}catch(n){h(k(n)),H([{_error:!0}])}finally{V(!1),z.current=!1}}if(!I.current){I.current=!0;try{Y(!0);const n=await y.getUnprotectedColumns();Q(n.columns||[])}catch(n){h(k(n)),Q([{_error:!0}])}finally{Y(!1),I.current=!1}}})()},[E]);const Ee=o.useCallback(async()=>{try{const s=await y.getAvailableDatabases();s.databases&&s.databases.length>0&&xe(s.databases)}catch(s){console.error("Error fetching databases:",s)}},[]);return se&&P.length===0?e.jsx(we,{variant:"table"}):e.jsxs("div",{style:{width:"100%",minHeight:"100vh",padding:"20px",fontFamily:"Consolas",fontSize:12,color:t.foreground,backgroundColor:t.background,display:"flex",flexDirection:"column",gap:20},children:[e.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:"0 0 20px 0",color:t.foreground,textTransform:"uppercase",fontFamily:"Consolas"},children:[e.jsx("span",{style:{color:t.accent,marginRight:8},children:m.blockFull}),"DATA MASKING & ENCRYPTION"]}),B&&e.jsx("div",{style:{marginBottom:20},children:e.jsx(T,{title:"ERROR",children:e.jsx("div",{style:{padding:"12px",color:t.danger,fontSize:12,fontFamily:"Consolas"},children:B})})}),_&&_.overall_summary&&e.jsxs(T,{title:"MASKING STATUS OVERVIEW",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:a.spacing.md,padding:a.spacing.md,fontFamily:"Consolas",fontSize:11},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:t.muted,fontSize:10,marginBottom:4},children:"Total Tables"}),e.jsx("div",{style:{color:t.foreground,fontSize:16,fontWeight:"bold"},children:_.overall_summary.total_tables})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:t.muted,fontSize:10,marginBottom:4},children:"Sensitive Columns"}),e.jsx("div",{style:{color:t.warning,fontSize:16,fontWeight:"bold"},children:(()=>S.filter(n=>!n._error).length||_.overall_summary.sensitive_columns)()})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:t.muted,fontSize:10,marginBottom:4},children:"Protected"}),e.jsx("div",{style:{color:t.success,fontSize:16,fontWeight:"bold"},children:(()=>{const s=S.filter(i=>!i._error).length,n=b.filter(i=>!i._error).length;return s>0?s-n:_.overall_summary.columns_with_policies})()})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:t.muted,fontSize:10,marginBottom:4},children:"Unprotected"}),e.jsx("div",{style:{color:t.danger,fontSize:16,fontWeight:"bold"},children:b.filter(s=>!s._error).length})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:t.muted,fontSize:10,marginBottom:4},children:"Coverage"}),e.jsxs("div",{style:{color:(()=>{const s=S.filter(r=>!r._error).length,n=b.filter(r=>!r._error).length,i=s>0?(s-n)/s*100:_.overall_summary.coverage_percentage;return i>=90?t.success:i>=70?t.warning:t.danger})(),fontSize:16,fontWeight:"bold"},children:[(()=>{const s=S.filter(r=>!r._error).length,n=b.filter(r=>!r._error).length;return(s>0?(s-n)/s*100:_.overall_summary.coverage_percentage).toFixed(1)})(),"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:t.muted,fontSize:10,marginBottom:4},children:"Status"}),e.jsx("div",{style:{color:(()=>{const s=S.filter(A=>!A._error).length,n=b.filter(A=>!A._error).length,i=s>0?(s-n)/s*100:_.overall_summary.coverage_percentage,r=i>=90?"EXCELLENT":i>=70?"GOOD":i>=50?"FAIR":i>0?"POOR":"NONE";return r==="EXCELLENT"?t.success:r==="GOOD"?t.warning:r==="FAIR"?t.warning:t.danger})(),fontSize:16,fontWeight:"bold"},children:(()=>{const s=S.filter(r=>!r._error).length,n=b.filter(r=>!r._error).length,i=s>0?(s-n)/s*100:_.overall_summary.coverage_percentage;return i>=90?"EXCELLENT":i>=70?"GOOD":i>=50?"FAIR":i>0?"POOR":"NONE"})()})]})]}),e.jsxs("div",{style:{marginTop:a.spacing.md,padding:a.spacing.sm,borderTop:`1px solid ${t.border}`,display:"flex",gap:8,justifyContent:"flex-end"},children:[e.jsx(u,{label:"Masking Info",onClick:()=>Z(!0),variant:"ghost"}),e.jsx(u,{label:"Refresh Status",onClick:E,variant:"ghost",disabled:he})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:a.spacing.md,fontFamily:"Consolas",fontSize:12},children:[e.jsxs("div",{style:{display:"flex",gap:a.spacing.sm},children:[e.jsx(u,{label:`${m.blockFull} Create Masking Policy`,onClick:be,variant:"primary"}),e.jsx(u,{label:`${m.blockFull} Batch Analyze & Create`,onClick:()=>M(!0),variant:"primary"}),e.jsx(u,{label:`${m.blockFull} Deactivate All Masking`,onClick:Ce,variant:"ghost",disabled:fe})]}),e.jsxs("div",{style:{display:"flex",gap:a.spacing.sm},children:[e.jsx("input",{type:"text",placeholder:"Schema...",value:f.schema_name,onChange:s=>F(n=>({...n,schema_name:s.target.value})),style:{padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:11}}),e.jsx("input",{type:"text",placeholder:"Table...",value:f.table_name,onChange:s=>F(n=>({...n,table_name:s.target.value})),style:{padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:11}}),e.jsxs("select",{value:f.masking_type,onChange:s=>F(n=>({...n,masking_type:s.target.value})),style:{padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:11},children:[e.jsx("option",{value:"",children:"All Types"}),J.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsxs("select",{value:f.active,onChange:s=>F(n=>({...n,active:s.target.value})),style:{padding:"6px 10px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:11},children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:a.spacing.sm,marginBottom:a.spacing.md,borderBottom:`2px solid ${t.border}`},children:[e.jsxs("button",{onClick:()=>U("policies"),style:{padding:`${a.spacing.sm} ${a.spacing.md}`,border:"none",borderBottom:g==="policies"?`3px solid ${t.accent}`:"3px solid transparent",background:"transparent",color:g==="policies"?t.accent:t.muted,fontFamily:"Consolas",fontSize:12,fontWeight:g==="policies"?"bold":"normal",cursor:"pointer",transition:"all 0.2s"},children:["Masking Policies (",P.length,")"]}),e.jsxs("button",{onClick:()=>U("sensitive"),style:{padding:`${a.spacing.sm} ${a.spacing.md}`,border:"none",borderBottom:g==="sensitive"?`3px solid ${t.warning}`:"3px solid transparent",background:"transparent",color:g==="sensitive"?t.warning:t.muted,fontFamily:"Consolas",fontSize:12,fontWeight:g==="sensitive"?"bold":"normal",cursor:"pointer",transition:"all 0.2s"},children:["Sensitive Columns (",S.filter(s=>!s._error).length,")"]}),e.jsxs("button",{onClick:()=>U("unprotected"),style:{padding:`${a.spacing.sm} ${a.spacing.md}`,border:"none",borderBottom:g==="unprotected"?`3px solid ${t.danger}`:"3px solid transparent",background:"transparent",color:g==="unprotected"?t.danger:t.muted,fontFamily:"Consolas",fontSize:12,fontWeight:g==="unprotected"?"bold":"normal",cursor:"pointer",transition:"all 0.2s"},children:["Unprotected (",b.filter(s=>!s._error).length,")"]})]}),g==="policies"&&e.jsxs(T,{title:"MASKING POLICIES",children:[se&&e.jsx(Ae,{}),e.jsxs(ee,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx(d,{children:"Policy Name"}),e.jsx(d,{children:"Schema"}),e.jsx(d,{children:"Table"}),e.jsx(d,{children:"Column"}),e.jsx(d,{children:"Masking Type"}),e.jsx(d,{children:"Status"}),e.jsx(d,{children:"Roles Whitelist"}),e.jsx(d,{children:"Created"}),e.jsx(d,{children:"Actions"})]})}),e.jsx("tbody",{children:P.length===0?e.jsx(G,{children:e.jsx(l,{colSpan:9,style:{textAlign:"center",padding:a.spacing.lg},children:"No masking policies found. Create one to get started."})}):P.map(s=>e.jsxs(G,{children:[e.jsx(l,{children:s.policy_name}),e.jsx(l,{children:s.schema_name}),e.jsx(l,{children:s.table_name}),e.jsx(l,{children:s.column_name}),e.jsx(l,{children:e.jsx("span",{style:{color:te(s.masking_type)},children:s.masking_type})}),e.jsx(l,{children:e.jsx("span",{style:{color:Re(s.active?"ACTIVE":"INACTIVE")},children:s.active?"ACTIVE":"INACTIVE"})}),e.jsx(l,{children:s.role_whitelist&&s.role_whitelist.length>0?s.role_whitelist.join(", "):"-"}),e.jsx(l,{children:ze(s.created_at||"")}),e.jsx(l,{children:e.jsxs("div",{style:{display:"flex",gap:a.spacing.sm},children:[e.jsx(u,{label:"Edit",onClick:()=>je(s),variant:"ghost"}),s.policy_id&&e.jsx(u,{label:"Delete",onClick:()=>ve(s.policy_id),variant:"ghost"}),e.jsx(u,{label:"Analyze",onClick:()=>Se(s.schema_name,s.table_name),variant:"ghost"})]})})]},s.policy_id))})]}),$>N&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:a.spacing.md,padding:a.spacing.sm,fontFamily:"Consolas",fontSize:11},children:[e.jsxs("div",{children:["Showing ",(R-1)*N+1," to ",Math.min(R*N,$)," of ",$," policies"]}),e.jsxs("div",{style:{display:"flex",gap:a.spacing.sm},children:[e.jsx(u,{label:"Previous",onClick:()=>ne(s=>Math.max(1,s-1)),variant:"ghost",disabled:R===1}),e.jsx(u,{label:"Next",onClick:()=>ne(s=>s+1),variant:"ghost",disabled:R*N>=$})]})]})]}),g==="sensitive"&&e.jsx(T,{title:`SENSITIVE COLUMNS (${S.length})`,children:le?e.jsx("div",{style:{textAlign:"center",padding:a.spacing.lg,color:t.muted},children:"Loading..."}):S.length===0?e.jsx("div",{style:{textAlign:"center",padding:a.spacing.lg,color:t.muted},children:"No sensitive columns found"}):e.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:e.jsxs(ee,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx(d,{children:"Schema"}),e.jsx(d,{children:"Table"}),e.jsx(d,{children:"Column"}),e.jsx(d,{children:"Data Type"}),e.jsx(d,{children:"PII Category"}),e.jsx(d,{children:"Confidence"})]})}),e.jsx("tbody",{children:S.filter(s=>!s._error).map((s,n)=>e.jsxs(G,{children:[e.jsx(l,{children:s.schema_name}),e.jsx(l,{children:s.table_name}),e.jsx(l,{children:s.column_name}),e.jsx(l,{children:s.data_type}),e.jsx(l,{children:e.jsx("span",{style:{color:te(s.pii_category)},children:s.pii_category})}),e.jsxs(l,{children:[(s.confidence_score*100).toFixed(0),"%"]})]},n))})]})})}),g==="unprotected"&&e.jsx(T,{title:`UNPROTECTED COLUMNS (${b.filter(s=>!s._error).length})`,children:de?e.jsx("div",{style:{textAlign:"center",padding:a.spacing.lg,color:t.muted},children:"Loading..."}):b.length===0||b.length===1&&b[0]._error?e.jsx("div",{style:{textAlign:"center",padding:a.spacing.lg,color:B?t.danger:t.success},children:B?`Error: ${B}`:"All sensitive columns are protected! ðŸŽ‰"}):e.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:e.jsxs(ee,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx(d,{children:"Schema"}),e.jsx(d,{children:"Table"}),e.jsx(d,{children:"Column"}),e.jsx(d,{children:"Data Type"}),e.jsx(d,{children:"PII Category"}),e.jsx(d,{children:"Confidence"}),e.jsx(d,{children:"Action"})]})}),e.jsx("tbody",{children:b.filter(s=>!s._error).map((s,n)=>e.jsxs(G,{children:[e.jsx(l,{children:s.schema_name}),e.jsx(l,{children:s.table_name}),e.jsx(l,{children:s.column_name}),e.jsx(l,{children:s.data_type}),e.jsx(l,{children:e.jsx("span",{style:{color:te(s.pii_category)},children:s.pii_category})}),e.jsxs(l,{children:[(s.confidence_score*100).toFixed(0),"%"]}),e.jsx(l,{children:e.jsx(u,{label:"Create Policy",onClick:()=>{j({policy_name:`${s.schema_name}_${s.table_name}_${s.column_name}_mask`,schema_name:s.schema_name,table_name:s.table_name,column_name:s.column_name,masking_type:s.pii_category==="EMAIL"?"EMAIL":s.pii_category==="PHONE"?"PHONE":"FULL",active:!0}),U("policies"),w(!0)},variant:"ghost"})})]},n))})]})})}),ge&&p&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,fontFamily:"Consolas"},onClick:()=>w(!1),children:e.jsx("div",{style:{backgroundColor:t.background,border:`2px solid ${t.border}`,borderRadius:4,padding:a.spacing.lg,maxWidth:"600px",width:"90%",maxHeight:"90vh",overflow:"auto"},onClick:s=>s.stopPropagation(),children:e.jsx(T,{title:p.policy_id?"EDIT POLICY":"CREATE POLICY",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:a.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:t.muted,fontSize:11,display:"block",marginBottom:4},children:"Policy Name *"}),e.jsx("input",{type:"text",value:p.policy_name,onChange:s=>j(n=>n?{...n,policy_name:s.target.value}:null),style:{width:"100%",padding:"8px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:12}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:a.spacing.sm},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:t.muted,fontSize:11,display:"block",marginBottom:4},children:"Schema Name *"}),e.jsx("input",{type:"text",value:p.schema_name,onChange:s=>j(n=>n?{...n,schema_name:s.target.value}:null),style:{width:"100%",padding:"8px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:t.muted,fontSize:11,display:"block",marginBottom:4},children:"Table Name *"}),e.jsx("input",{type:"text",value:p.table_name,onChange:s=>j(n=>n?{...n,table_name:s.target.value}:null),style:{width:"100%",padding:"8px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:12}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:t.muted,fontSize:11,display:"block",marginBottom:4},children:"Column Name *"}),e.jsx("input",{type:"text",value:p.column_name,onChange:s=>j(n=>n?{...n,column_name:s.target.value}:null),style:{width:"100%",padding:"8px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:t.muted,fontSize:11,display:"block",marginBottom:4},children:"Masking Type *"}),e.jsx("select",{value:p.masking_type,onChange:s=>j(n=>n?{...n,masking_type:s.target.value}:null),style:{width:"100%",padding:"8px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:12},children:J.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:t.muted,fontSize:11,display:"block",marginBottom:4},children:"Active"}),e.jsx("input",{type:"checkbox",checked:p.active,onChange:s=>j(n=>n?{...n,active:s.target.checked}:null),style:{width:"20px",height:"20px",cursor:"pointer"}})]}),e.jsxs("div",{style:{display:"flex",gap:a.spacing.sm,marginTop:a.spacing.md},children:[e.jsx(u,{label:"Save",onClick:ke,variant:"primary"}),e.jsx(u,{label:"Cancel",onClick:()=>{w(!1),j(null)},variant:"ghost"})]})]})})})}),pe&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,fontFamily:"Consolas"},onClick:()=>{W||(M(!1),D(null))},children:e.jsx("div",{style:{backgroundColor:t.background,border:`2px solid ${t.border}`,borderRadius:4,padding:a.spacing.lg,maxWidth:"700px",width:"90%",maxHeight:"90vh",overflow:"auto"},onClick:s=>s.stopPropagation(),children:e.jsx(T,{title:"BATCH ANALYZE & CREATE POLICIES",children:C?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:a.spacing.md},children:[e.jsxs("div",{style:{padding:a.spacing.md,background:t.backgroundSoft,borderRadius:2,fontSize:12},children:[e.jsx("div",{style:{marginBottom:a.spacing.sm},children:e.jsx("strong",{children:"Batch Analysis Complete!"})}),e.jsxs("div",{children:["Total Analyzed: ",C.total_analyzed]}),e.jsxs("div",{style:{color:t.success},children:["Policies Created: ",C.policies_created]}),e.jsxs("div",{style:{color:t.warning},children:["Policies Skipped: ",C.policies_skipped]})]}),C.results&&C.results.length>0&&e.jsxs("div",{style:{maxHeight:"300px",overflowY:"auto"},children:[e.jsx("div",{style:{fontSize:11,color:t.muted,marginBottom:a.spacing.sm},children:"Results:"}),C.results.slice(0,20).map((s,n)=>e.jsxs("div",{style:{padding:a.spacing.xs,marginBottom:a.spacing.xs,background:s.policy_created?t.backgroundSoft:t.background,borderRadius:2,fontSize:10,borderLeft:`3px solid ${s.policy_created?t.success:t.danger}`},children:[s.schema_name,".",s.table_name,".",s.column_name," - ",s.pii_category,s.policy_created?" âœ“":` âœ— (${s.message})`]},n)),C.results.length>20&&e.jsxs("div",{style:{fontSize:10,color:t.muted,marginTop:a.spacing.sm},children:["... and ",C.results.length-20," more"]})]}),e.jsx("div",{style:{display:"flex",gap:a.spacing.sm,marginTop:a.spacing.md},children:e.jsx(u,{label:"Close",onClick:()=>{M(!1),D(null),v(),E()},variant:"primary"})})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:a.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:t.muted,fontSize:11,display:"block",marginBottom:4},children:"Select Databases * (Multiple selection allowed)"}),ie.length>0?e.jsxs("div",{children:[e.jsxs("div",{style:{padding:a.spacing.xs,marginBottom:a.spacing.sm,background:t.backgroundSoft,borderRadius:2,fontSize:10,color:t.warning,fontFamily:"Consolas",border:`1px solid ${t.warning}`},children:[e.jsx("strong",{children:"âš ï¸ Warning:"})," Avoid selecting system databases like 'postgres' unless you have application data there. System databases typically don't need masking."]}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",border:`1px solid ${t.border}`,borderRadius:2,padding:a.spacing.sm,background:t.background},children:ie.map(s=>{const n=s==="postgres"||s==="template0"||s==="template1";return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:a.spacing.xs,padding:a.spacing.xs,marginBottom:a.spacing.xs,opacity:n?.7:1},children:[e.jsx("input",{type:"checkbox",checked:c.database_names.includes(s),onChange:i=>{i.target.checked?L(r=>({...r,database_names:[...r.database_names,s],database_name:""})):L(r=>({...r,database_names:r.database_names.filter(A=>A!==s)}))},style:{width:"18px",height:"18px",cursor:"pointer"}}),e.jsxs("label",{style:{color:n?t.warning:t.foreground,fontSize:12,fontFamily:"Consolas",cursor:"pointer",flex:1},children:[s," ",n&&"(System DB)"]})]},s)})})]}):e.jsx("input",{type:"text",value:c.database_name,onChange:s=>L(n=>({...n,database_name:s.target.value,database_names:[]})),placeholder:"DataLake, postgres, etc. (single database)",style:{width:"100%",padding:"8px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:12}}),c.database_names.length>0&&e.jsxs("div",{style:{marginTop:a.spacing.xs,fontSize:10,color:t.muted,fontFamily:"Consolas"},children:["Selected: ",c.database_names.join(", ")]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:t.muted,fontSize:11,display:"block",marginBottom:4},children:"Schema Name (leave empty for all schemas in database)"}),e.jsx("input",{type:"text",value:c.schema_name,onChange:s=>L(n=>({...n,schema_name:s.target.value})),placeholder:"public (optional)",style:{width:"100%",padding:"8px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:t.muted,fontSize:11,display:"block",marginBottom:4},children:"Default Masking Type"}),e.jsx("select",{value:c.masking_type,onChange:s=>L(n=>({...n,masking_type:s.target.value})),style:{width:"100%",padding:"8px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:12},children:J.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:t.muted,fontSize:11,display:"block",marginBottom:4},children:"Minimum Confidence Score (0.0 - 1.0)"}),e.jsx("input",{type:"number",min:"0",max:"1",step:"0.05",value:c.min_confidence,onChange:s=>L(n=>({...n,min_confidence:parseFloat(s.target.value)||.75})),style:{width:"100%",padding:"8px",border:`1px solid ${t.border}`,borderRadius:2,background:t.background,color:t.foreground,fontFamily:"Consolas",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:t.muted,fontSize:11,display:"block",marginBottom:4},children:"Auto Activate Policies"}),e.jsx("input",{type:"checkbox",checked:c.auto_activate,onChange:s=>L(n=>({...n,auto_activate:s.target.checked})),style:{width:"20px",height:"20px",cursor:"pointer"}})]}),e.jsxs("div",{style:{padding:a.spacing.sm,background:t.backgroundSoft,borderRadius:2,fontSize:11,color:t.muted},children:[e.jsx("strong",{children:"Note:"})," This will scan all tables in the specified database and schema (or all schemas if schema is empty), detect sensitive columns, and automatically create masking policies. Email and phone columns will use appropriate masking types automatically."]}),e.jsxs("div",{style:{display:"flex",gap:a.spacing.sm,marginTop:a.spacing.md},children:[e.jsx(u,{label:W?"Processing...":"Start Batch Analysis",onClick:_e,variant:"primary",disabled:W||c.database_names.length===0&&!c.database_name}),e.jsx(u,{label:"Cancel",onClick:()=>{M(!1),D(null)},variant:"ghost",disabled:W})]})]})})})}),ye&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>Z(!1),children:e.jsx("div",{style:{width:"90%",maxWidth:1e3,maxHeight:"90vh",overflowY:"auto"},onClick:s=>s.stopPropagation(),children:e.jsx(T,{title:"DATA MASKING PLAYBOOK",children:e.jsxs("div",{style:{padding:16,fontFamily:"Consolas",fontSize:12,lineHeight:1.6},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:t.accent,marginBottom:12},children:[m.blockFull," OVERVIEW"]}),e.jsx("div",{style:{color:t.foreground,marginLeft:16},children:"Data Masking provides role-based column-level data protection at the database level. The system automatically redirects queries to masked views or original data based on user privileges, ensuring sensitive data is protected while maintaining seamless access for authorized users."})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:t.accent,marginBottom:12},children:[m.blockFull," FLOW: USER CONNECTION â†’ ROLE MAPPING"]}),e.jsxs("div",{style:{marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:t.success,marginBottom:6},children:[m.blockSemi," Step 1: PostgreSQL User Identification"]}),e.jsxs("div",{style:{color:t.foreground,marginLeft:16,fontSize:11},children:["When you connect to PostgreSQL as a user (e.g., ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"tomy.berrios"}),"), PostgreSQL identifies the session user:"]}),e.jsx("pre",{style:{marginLeft:32,marginTop:8,padding:8,background:t.backgroundSoft,border:`1px solid ${t.border}`,fontSize:11,overflowX:"auto"},children:`-- PostgreSQL identifies your user
current_user = 'tomy.berrios'
session_user = 'tomy.berrios'`})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:t.success,marginBottom:6},children:[m.blockSemi," Step 2: Role Mapping Function"]}),e.jsxs("div",{style:{color:t.foreground,marginLeft:16,fontSize:11},children:["The function ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"metadata.get_user_role_from_db()"})," maps PostgreSQL users to application roles:"]}),e.jsx("pre",{style:{marginLeft:32,marginTop:8,padding:8,background:t.backgroundSoft,border:`1px solid ${t.border}`,fontSize:11,overflowX:"auto"},children:`-- 1. Gets current PostgreSQL user
v_db_user := current_user;  -- 'tomy.berrios'

-- 2. Looks up in metadata.users
SELECT role FROM metadata.users 
WHERE username = 'tomy.berrios';
-- Result: 'admin'

-- 3. Returns the role
RETURN 'admin';`}),e.jsxs("div",{style:{color:t.foreground,marginLeft:32,marginTop:8,fontSize:11},children:[e.jsx("strong",{children:"Important:"})," The mapping is ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"username"})," in ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"metadata.users"})," = ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"session_user"})," of PostgreSQL"]})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:t.accent,marginBottom:12},children:[m.blockFull," FLOW: POLICY VERIFICATION"]}),e.jsx("div",{style:{marginLeft:16},children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:t.success,marginBottom:6},children:[m.blockSemi," Step 3: Column Masking Decision"]}),e.jsxs("div",{style:{color:t.foreground,marginLeft:16,fontSize:11},children:["When querying a column, ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"metadata.should_mask_column()"})," verifies:"]}),e.jsxs("div",{style:{color:t.foreground,marginLeft:32,marginTop:8,fontSize:11},children:[e.jsxs("div",{style:{marginBottom:4},children:["1. ",e.jsx("strong",{children:"Is the user admin?"})]}),e.jsx("div",{style:{marginLeft:16,color:t.success},children:"â†’ If YES: RETURN false (NO masking)"}),e.jsx("div",{style:{marginLeft:16,color:t.success},children:"â†’ If NO: continue"}),e.jsxs("div",{style:{marginBottom:4,marginTop:8},children:["2. ",e.jsx("strong",{children:"Does an active policy exist for this column?"})]}),e.jsx("div",{style:{marginLeft:16,color:t.success},children:"â†’ If NO: RETURN false (NO masking)"}),e.jsx("div",{style:{marginLeft:16,color:t.success},children:"â†’ If YES: continue"}),e.jsxs("div",{style:{marginBottom:4,marginTop:8},children:["3. ",e.jsx("strong",{children:"Is the role in the whitelist?"})]}),e.jsx("div",{style:{marginLeft:16,color:t.success},children:"â†’ If YES: RETURN false (NO masking)"}),e.jsx("div",{style:{marginLeft:16,color:t.success},children:"â†’ If NO: RETURN true (YES masking)"})]})]})})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:t.accent,marginBottom:12},children:[m.blockFull," FLOW: SMART VIEW - AUTOMATIC REDIRECTION"]}),e.jsx("div",{style:{marginLeft:16},children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:t.success,marginBottom:6},children:[m.blockSemi," Step 4: Smart View Creation"]}),e.jsxs("div",{style:{color:t.foreground,marginLeft:16,fontSize:11},children:["The view ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"saleslt_smart_customer"})," is created with dynamic masking:"]}),e.jsx("pre",{style:{marginLeft:32,marginTop:8,padding:8,background:t.backgroundSoft,border:`1px solid ${t.border}`,fontSize:11,overflowX:"auto"},children:`CREATE VIEW saleslt_smart_customer AS
SELECT 
  customerid,
  
  -- For emailaddress (has EMAIL policy)
  CASE 
    WHEN (SELECT role FROM metadata.users 
          WHERE username = session_user) = 'admin' 
    THEN emailaddress  -- Admin sees original
    ELSE metadata.mask_value(
      emailaddress::TEXT, 'EMAIL', '{}'::jsonb
    )  -- User sees masked
  END as emailaddress,
  
  -- For phone (has PHONE policy)
  CASE 
    WHEN (SELECT role FROM metadata.users 
          WHERE username = session_user) = 'admin' 
    THEN phone  -- Admin sees original
    ELSE metadata.mask_value(
      phone::TEXT, 'PHONE', '{}'::jsonb
    )  -- User sees masked
  END as phone
  
FROM saleslt.customer;`})]})})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:t.accent,marginBottom:12},children:[m.blockFull," FLOW: EXECUTION EXAMPLES"]}),e.jsxs("div",{style:{marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:t.success,marginBottom:6},children:[m.blockSemi," Admin User Query"]}),e.jsxs("div",{style:{color:t.foreground,marginLeft:16,fontSize:11},children:["When ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"tomy.berrios"})," (admin) executes:"]}),e.jsx("pre",{style:{marginLeft:32,marginTop:8,padding:8,background:t.backgroundSoft,border:`1px solid ${t.border}`,fontSize:11,overflowX:"auto"},children:`SELECT emailaddress, phone 
FROM saleslt.saleslt_smart_customer;`}),e.jsxs("div",{style:{color:t.foreground,marginLeft:32,marginTop:8,fontSize:11},children:["PostgreSQL evaluates CASE WHEN:",e.jsxs("div",{style:{marginLeft:16,marginTop:4},children:["â€¢ ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"session_user = 'tomy.berrios'"})]}),e.jsxs("div",{style:{marginLeft:16},children:["â€¢ Query: ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"SELECT role FROM metadata.users WHERE username = 'tomy.berrios'"})]}),e.jsxs("div",{style:{marginLeft:16},children:["â€¢ Result: ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"'admin'"})]}),e.jsxs("div",{style:{marginLeft:16,color:t.success,marginTop:4},children:["â†’ Returns: ",e.jsx("strong",{children:"original values"})," (no masking)"]})]})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:t.warning,marginBottom:6},children:[m.blockSemi," Regular User Query"]}),e.jsxs("div",{style:{color:t.foreground,marginLeft:16,fontSize:11},children:["When ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"testuser"})," (non-admin) executes the same query:"]}),e.jsxs("div",{style:{color:t.foreground,marginLeft:32,marginTop:8,fontSize:11},children:["PostgreSQL evaluates CASE WHEN:",e.jsxs("div",{style:{marginLeft:16,marginTop:4},children:["â€¢ ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"session_user = 'testuser'"})]}),e.jsxs("div",{style:{marginLeft:16},children:["â€¢ Query: ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"SELECT role FROM metadata.users WHERE username = 'testuser'"})]}),e.jsxs("div",{style:{marginLeft:16},children:["â€¢ Result: ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"'user'"})]}),e.jsxs("div",{style:{marginLeft:16},children:["â€¢ Condition: ",e.jsx("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:"'user' = 'admin'"})," â†’ FALSE"]}),e.jsxs("div",{style:{marginLeft:16,color:t.warning,marginTop:4},children:["â†’ Executes: ",e.jsxs("code",{style:{background:t.backgroundSoft,padding:"2px 4px"},children:["metadata.mask_value(emailaddress, 'EMAIL', '","')"]})]}),e.jsxs("div",{style:{marginLeft:16,color:t.warning},children:["â†’ Returns: ",e.jsx("strong",{children:"'orl***@adventure-works.com'"})," (masked)"]})]})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:t.accent,marginBottom:12},children:[m.blockFull," REQUIREMENTS"]}),e.jsxs("div",{style:{marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:t.foreground,marginBottom:4},children:"1. PostgreSQL User Must Exist"}),e.jsx("pre",{style:{marginLeft:16,marginTop:4,padding:8,background:t.backgroundSoft,border:`1px solid ${t.border}`,fontSize:11,overflowX:"auto"},children:"CREATE USER tomy.berrios WITH PASSWORD 'your_password';"})]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:t.foreground,marginBottom:4},children:"2. User Must Be in metadata.users"}),e.jsx("pre",{style:{marginLeft:16,marginTop:4,padding:8,background:t.backgroundSoft,border:`1px solid ${t.border}`,fontSize:11,overflowX:"auto"},children:`INSERT INTO metadata.users (username, email, password_hash, role, active)
VALUES ('tomy.berrios', 'your@email.com', 'hash', 'admin', true);`})]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:t.foreground,marginBottom:4},children:"3. Required Permissions"}),e.jsx("pre",{style:{marginLeft:16,marginTop:4,padding:8,background:t.backgroundSoft,border:`1px solid ${t.border}`,fontSize:11,overflowX:"auto"},children:`GRANT CONNECT ON DATABASE DataLake TO tomy.berrios;
GRANT USAGE ON SCHEMA saleslt TO tomy.berrios;
GRANT SELECT ON saleslt.saleslt_smart_customer TO tomy.berrios;
GRANT SELECT ON metadata.users TO tomy.berrios;`})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:t.accent,marginBottom:12},children:[m.blockFull," MASKING TYPES"]}),e.jsxs("div",{style:{marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.danger,fontWeight:600},children:"FULL"}),e.jsx("span",{style:{color:t.foreground,marginLeft:8},children:"Complete masking: ***MASKED***"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.warning,fontWeight:600},children:"PARTIAL"}),e.jsx("span",{style:{color:t.foreground,marginLeft:8},children:"Partial masking: Shows first/last characters"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.accent,fontWeight:600},children:"EMAIL"}),e.jsx("span",{style:{color:t.foreground,marginLeft:8},children:"Email masking: orl***@adventure-works.com"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.accent,fontWeight:600},children:"PHONE"}),e.jsx("span",{style:{color:t.foreground,marginLeft:8},children:"Phone masking: 245-****-0173"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.muted,fontWeight:600},children:"HASH"}),e.jsx("span",{style:{color:t.foreground,marginLeft:8},children:"Hash-based masking: Deterministic hash"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:t.success,fontWeight:600},children:"TOKENIZE"}),e.jsx("span",{style:{color:t.foreground,marginLeft:8},children:"Tokenization: Replaces with tokens"})]})]})]}),e.jsxs("div",{style:{marginTop:16,padding:12,background:t.backgroundSoft,borderRadius:2,border:`1px solid ${t.border}`},children:[e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:t.muted,marginBottom:4},children:[m.blockSemi," Important Notes"]}),e.jsxs("div",{style:{fontSize:11,color:t.foreground},children:["â€¢ The view queries ",e.jsx("code",{style:{background:t.background,padding:"2px 4px"},children:"metadata.users"})," at ",e.jsx("strong",{children:"execution time"}),", not at creation time",e.jsx("br",{}),"â€¢ If a PostgreSQL user exists but is not in ",e.jsx("code",{style:{background:t.background,padding:"2px 4px"},children:"metadata.users"}),", the function returns 'admin' by default (hardcoded)",e.jsx("br",{}),"â€¢ If the user exists in ",e.jsx("code",{style:{background:t.background,padding:"2px 4px"},children:"metadata.users"}),", it uses the role from that table",e.jsx("br",{}),"â€¢ Masking is applied at the database level, ensuring consistent protection across all applications"]})]}),e.jsx("div",{style:{marginTop:16,textAlign:"right"},children:e.jsx(u,{label:"Close",onClick:()=>Z(!1),variant:"ghost"})})]})})})})]})};export{Fe as default};
