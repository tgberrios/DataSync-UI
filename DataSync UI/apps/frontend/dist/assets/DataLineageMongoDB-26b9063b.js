import{m as F,f as Y,b as o,r as a,j as e,e as m,z as v,l as H}from"./index-75d7470b.js";import{u as X}from"./useTableFilters-0b8dd77f.js";import{e as K}from"./errorHandler-5ea9ae85.js";import{s as J}from"./validation-24839588.js";import{A as p}from"./AsciiPanel-9f053981.js";import{A as _}from"./AsciiButton-446d8430.js";import{L as Q}from"./LineageCharts-14f671f1.js";import{S as Z}from"./SkeletonLoader-530eacc4.js";const ee=F`
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
`;F`
  from {
    max-height: 0;
    opacity: 0;
  }
  to {
    max-height: 1000px;
    opacity: 1;
  }
`;F`
  from {
    max-height: 1000px;
    opacity: 1;
  }
  to {
    max-height: 0;
    opacity: 0;
  }
`;const U=Y.div`
  font-family: Consolas;
  font-size: 12px;
  background: ${o.background};
  border: 1px solid ${o.border};
  border-radius: 2px;
  padding: 16px;
  max-height: 800px;
  overflow-y: auto;
  overflow-x: hidden;
  position: relative;
  
  &::-webkit-scrollbar {
    width: 8px;
  }
  
  &::-webkit-scrollbar-track {
    background: ${o.backgroundSoft};
    border-radius: 2px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: ${o.border};
    border-radius: 2px;
    transition: background 0.2s ease;
    
    &:hover {
      background: ${o.accent};
    }
  }
`,$=Y.div`
  user-select: none;
  animation: ${ee} 0.3s ease-out;
  margin-bottom: 2px;
`,S=i=>{if(i==null)return o.muted;const u=Number(i);return isNaN(u)?o.muted:u>=.8?o.success:u>=.5?o.warning:o.danger},oe=({edges:i,onEdgeClick:u})=>{const[R,w]=a.useState(new Set),[E,f]=a.useState(new Set),C=a.useMemo(()=>{const t=new Map;return i.forEach(r=>{const s=`${r.source_collection||"Unknown"}::Collection`;t.has(s)||t.set(s,{name:r.source_collection||"Unknown",type:"Collection",relationships:[]}),t.get(s).relationships.push(r)}),Array.from(t.values()).sort((r,s)=>r.name.localeCompare(s.name))},[i]),O=t=>{w(r=>{const s=new Set(r);return s.has(t)?s.delete(t):s.add(t),s})},L=t=>{f(r=>{const s=new Set(r);return s.has(t)?s.delete(t):s.add(t),s})},z=t=>{if(t==null)return"N/A";const r=Number(t);return isNaN(r)?"N/A":`${(r*100).toFixed(1)}%`},k=(t,r)=>{if(t===0)return null;const s=[];for(let x=0;x<t-1;x++)s.push("│  ");return s.push(r?"└─ ":"├─ "),e.jsx("span",{style:{color:o.muted,marginRight:6,fontFamily:"Consolas",fontSize:12},children:s.join("")})},T=(t,r,s)=>{const x=E.has(t.id);return e.jsxs($,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:r===0?"8px":"6px 8px",paddingLeft:`${r*24+8}px`,cursor:"pointer",borderRadius:2,transition:"all 0.2s ease",margin:"2px 0",fontFamily:"Consolas",fontSize:12,backgroundColor:"transparent",border:"1px solid transparent"},onClick:()=>{L(t.id),u==null||u(t)},onMouseEnter:c=>{c.currentTarget.style.backgroundColor=o.backgroundSoft,c.currentTarget.style.transform="translateX(4px)",c.currentTarget.style.borderColor=o.accent},onMouseLeave:c=>{c.currentTarget.style.backgroundColor="transparent",c.currentTarget.style.transform="translateX(0)",c.currentTarget.style.borderColor="transparent"},children:[k(r,s),e.jsx("span",{style:{marginRight:"8px",color:o.muted,fontFamily:"Consolas"},children:m.blockFull}),e.jsx("span",{style:{fontWeight:400,color:o.foreground,fontSize:12,fontFamily:"Consolas",flex:1},children:t.target_collection||"Unknown"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginLeft:"auto",flexWrap:"wrap"},children:[e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:o.backgroundSoft,color:o.foreground,border:`1px solid ${o.border}`},children:"Collection"}),t.target_field&&e.jsxs("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:o.backgroundSoft,color:o.foreground,border:`1px solid ${o.border}`},children:["Field: ",t.target_field]})]})]}),e.jsx("div",{style:{overflow:"hidden",maxHeight:x?"1000px":"0",transition:"max-height 0.3s ease-out",paddingLeft:`${r*24+36}px`},children:x&&e.jsxs("div",{style:{padding:8,margin:"4px 0",background:o.background,borderRadius:2,border:`1px solid ${o.border}`,fontSize:11,fontFamily:"Consolas"},children:[e.jsxs("div",{style:{marginBottom:4,fontFamily:"Consolas"},children:[e.jsx("strong",{style:{color:o.foreground},children:"Server:"})," ",e.jsx("span",{style:{color:o.muted},children:t.server_name||"N/A"})]}),t.database_name&&e.jsxs("div",{style:{marginBottom:4,fontFamily:"Consolas"},children:[e.jsx("strong",{style:{color:o.foreground},children:"Database:"})," ",e.jsx("span",{style:{color:o.muted},children:t.database_name})]}),t.collection_name&&e.jsxs("div",{style:{marginBottom:4,fontFamily:"Consolas"},children:[e.jsx("strong",{style:{color:o.foreground},children:"Collection:"})," ",e.jsx("span",{style:{color:o.muted},children:t.collection_name})]}),e.jsxs("div",{style:{marginBottom:4,fontFamily:"Consolas"},children:[e.jsx("strong",{style:{color:o.foreground},children:"Confidence:"})," ",e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:S(t.confidence_score)+"20",color:S(t.confidence_score),border:`1px solid ${S(t.confidence_score)}`},children:z(t.confidence_score)})]}),t.discovery_method&&e.jsxs("div",{style:{fontFamily:"Consolas"},children:[e.jsx("strong",{style:{color:o.foreground},children:"Method:"})," ",e.jsx("span",{style:{color:o.muted},children:t.discovery_method})]})]})})]},t.id)},D=(t,r,s)=>e.jsxs($,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 8px",paddingLeft:`${r*24+8}px`,borderRadius:2,transition:"all 0.2s ease",margin:"2px 0",fontFamily:"Consolas",fontSize:12,backgroundColor:o.background,border:"1px solid transparent"},children:[k(r,!1),e.jsx("span",{style:{marginRight:"8px",color:o.accent,fontFamily:"Consolas",fontSize:12},children:m.arrowRight}),e.jsx("span",{style:{fontWeight:500,color:o.muted,fontSize:12,fontFamily:"Consolas",flex:1},children:t.relationship_type||"Unknown"}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,marginLeft:"auto"},children:e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:S(t.confidence_score)+"20",color:S(t.confidence_score),border:`1px solid ${S(t.confidence_score)}`},children:z(t.confidence_score)})})]}),T(t,r+1,s)]},`rel-${t.id}`),b=(t,r,s)=>{const x=`${t.name}::${t.type}`,c=R.has(x);return e.jsxs($,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:r===0?"8px":"6px 8px",paddingLeft:`${r*24+8}px`,cursor:"pointer",borderRadius:2,transition:"all 0.2s ease",margin:"2px 0",fontFamily:"Consolas",fontSize:12,backgroundColor:"transparent",border:"1px solid transparent",borderLeft:`3px solid ${o.accent}`},onClick:()=>O(x),onMouseEnter:d=>{d.currentTarget.style.backgroundColor=o.backgroundSoft,d.currentTarget.style.transform="translateX(4px)",d.currentTarget.style.borderColor=o.accent},onMouseLeave:d=>{d.currentTarget.style.backgroundColor="transparent",d.currentTarget.style.transform="translateX(0)",d.currentTarget.style.borderColor="transparent"},children:[k(r,s),e.jsx("div",{style:{width:16,height:16,display:"flex",alignItems:"center",justifyContent:"center",marginRight:8,borderRadius:2,background:c?o.accent:o.backgroundSoft,color:c?"#ffffff":o.accent,fontSize:10,fontWeight:"bold",fontFamily:"Consolas",flexShrink:0},children:c?m.arrowDown:m.arrowRight}),e.jsx("span",{style:{marginRight:"8px",color:o.accent,fontFamily:"Consolas"},children:m.blockFull}),e.jsx("span",{style:{fontWeight:600,color:o.accent,fontSize:13,fontFamily:"Consolas",flex:1},children:t.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginLeft:"auto",flexWrap:"wrap"},children:[e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:o.backgroundSoft,color:o.foreground,border:`1px solid ${o.border}`},children:t.type}),e.jsxs("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontWeight:600,fontFamily:"Consolas",backgroundColor:o.accent,color:"#ffffff",border:`1px solid ${o.accent}`},children:[t.relationships.length," ",t.relationships.length===1?"relationship":"relationships"]})]})]}),e.jsx("div",{style:{overflow:"hidden",maxHeight:c?"10000px":"0",transition:"max-height 0.3s ease-out",paddingLeft:`${r*24+36}px`},children:c&&t.relationships.map((d,N)=>D(d,r+1,N===t.relationships.length-1))})]},x)};return C.length===0?e.jsx(U,{children:e.jsxs("div",{style:{padding:"60px 40px",textAlign:"center",color:o.muted,fontFamily:"Consolas"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:16,fontFamily:"Consolas",opacity:.5},children:m.arrowRight}),e.jsx("div",{style:{fontSize:13,fontFamily:"Consolas",fontWeight:600,marginBottom:8,color:o.foreground},children:"No lineage data available"}),e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas",opacity:.7,color:o.muted},children:"Lineage relationships will appear here once extracted."})]})}):e.jsx(U,{children:C.map((t,r)=>b(t,0,r===C.length-1))})};F`
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
`;F`
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
`;const de=()=>{const{filters:i,setFilter:u,clearFilters:R}=X({server_name:"",database_name:"",relationship_type:"",search:""}),[w,E]=a.useState(null),[f,C]=a.useState({}),[O,L]=a.useState(null),[z,k]=a.useState([]),[T,D]=a.useState([]),[b,t]=a.useState([]),[r,s]=a.useState(!0),[x,c]=a.useState(!1),[d,N]=a.useState("list"),g=a.useRef(!0),A=a.useCallback(async()=>{if(g.current)try{const n=await v.getMongoDBMetrics().catch(l=>{throw console.error("MongoDB getMongoDBMetrics error:",l),l});g.current&&C(n||{})}catch(n){console.error("MongoDB fetchMetrics error:",n)}},[]),W=a.useCallback(async()=>{if(!g.current)return;const n=Date.now(),l=300;try{s(!0),E(null);const y=J(i.search,100),M=await v.getMongoDBLineage({page:1,limit:1e4,server_name:i.server_name,database_name:i.database_name,relationship_type:i.relationship_type,search:y}),j=Date.now()-n,I=Math.max(0,l-j);await new Promise(h=>setTimeout(h,I)),g.current&&t(M.data||[])}catch(y){g.current&&E(K(y))}finally{g.current&&s(!1)}},[i.server_name,i.database_name,i.relationship_type,i.search]);a.useEffect(()=>{g.current=!0,(async()=>{try{const y=await v.getMongoDBServers();g.current&&k(y||[])}catch(y){console.error("Error loading servers:",y)}})(),A(),W();const l=setInterval(()=>{g.current&&(A(),W())},3e4);return()=>{g.current=!1,clearInterval(l)}},[W,A]),a.useEffect(()=>{(async()=>{if(i.server_name&&g.current)try{const l=await v.getMongoDBDatabases(i.server_name);g.current&&D(l||[])}catch(l){g.current&&console.error("Error loading databases:",l)}else D([])})()},[i.server_name]);const q=a.useCallback(n=>{L(l=>l===n?null:n)},[]);a.useCallback(n=>n?new Date(n).toLocaleString():"N/A",[]);const P=a.useCallback(n=>{if(n==null)return"N/A";const l=Number(n);return isNaN(l)?"N/A":`${(l*100).toFixed(1)}%`},[]),B=a.useCallback((n,l)=>{u(n,l),n==="server_name"&&u("database_name","")},[u]),V=a.useCallback(()=>{const n=["Source Collection","Source Field","Relationship","Target Collection","Target Field","Server","Database","Confidence","Method"],l=b.map(h=>[h.source_collection||"",h.source_field||"",h.relationship_type||"",h.target_collection||"",h.target_field||"",h.server_name||"",h.database_name||"",P(h.confidence_score),h.discovery_method||""]),y=[n.join(","),...l.map(h=>h.map(G=>`"${String(G).replace(/"/g,'""')}"`).join(","))].join(`
`),M=new Blob([y],{type:"text/csv;charset=utf-8;"}),j=document.createElement("a"),I=URL.createObjectURL(M);j.setAttribute("href",I),j.setAttribute("download",`lineage_mongodb_export_${new Date().toISOString().split("T")[0]}.csv`),j.style.visibility="hidden",document.body.appendChild(j),j.click(),document.body.removeChild(j)},[b,P]);return r&&b.length===0?e.jsx(Z,{variant:"table"}):e.jsxs("div",{style:{padding:"20px",fontFamily:"Consolas",fontSize:12},children:[e.jsx("div",{style:{marginBottom:"20px"},children:e.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:0,color:o.foreground,textTransform:"uppercase",fontFamily:"Consolas"},children:[e.jsx("span",{style:{color:o.accent,marginRight:8},children:m.blockFull}),"DATA LINEAGE - MONGODB"]})}),x&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>c(!1),children:e.jsx("div",{style:{width:"90%",maxWidth:1e3,maxHeight:"90vh",overflowY:"auto"},onClick:n=>n.stopPropagation(),children:e.jsx(p,{title:"DATA LINEAGE - MONGODB PLAYBOOK",children:e.jsxs("div",{style:{padding:16,fontFamily:"Consolas",fontSize:12,lineHeight:1.6},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[m.blockFull," OVERVIEW"]}),e.jsx("div",{style:{color:o.foreground,marginLeft:16},children:"Data Lineage tracks the flow of data through your MongoDB databases, showing how data moves from source collections to target collections, views, and aggregation pipelines. This helps you understand data dependencies, impact analysis, and data flow patterns across your MongoDB infrastructure, including document relationships and transformation pipelines."})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[m.blockFull," RELATIONSHIP TYPES"]}),e.jsxs("div",{style:{marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent,fontWeight:600},children:"DEPENDS_ON"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Target collection depends on source collection (e.g., view depends on collection, aggregation pipeline depends on collection)"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent,fontWeight:600},children:"REFERENCES"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Document reference relationship between collections (DBRef or manual references)"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent,fontWeight:600},children:"USES"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Collection uses another collection (e.g., aggregation pipeline uses multiple collections)"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent,fontWeight:600},children:"CONTAINS"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Parent-child relationship (e.g., database contains collection)"})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[m.blockFull," CONFIDENCE SCORE"]}),e.jsxs("div",{style:{marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.success,fontWeight:600},children:"High (0.8-1.0)"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Strong evidence of relationship, typically from explicit references, view definitions, or aggregation pipelines"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.warning,fontWeight:600},children:"Medium (0.5-0.8)"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Moderate confidence, inferred from patterns, naming conventions, or document structure analysis"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.danger,fontWeight:600},children:"Low (0.0-0.5)"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Weak evidence, may require manual verification"})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[m.blockFull," DISCOVERY METHODS"]}),e.jsxs("div",{style:{marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent,fontWeight:600},children:"DBREF"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Discovered through MongoDB DBRef references"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent,fontWeight:600},children:"VIEW_DEFINITION"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Extracted from MongoDB view definitions"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent,fontWeight:600},children:"AGGREGATION_PIPELINE"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Analyzed from aggregation pipeline stages ($lookup, $unionWith, etc.)"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent,fontWeight:600},children:"DOCUMENT_ANALYSIS"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Discovered from document structure and field references"})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[m.blockFull," MONGODB-SPECIFIC FEATURES"]}),e.jsxs("div",{style:{marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent,fontWeight:600},children:"Collection-Level Tracking"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Tracks relationships at the collection level, understanding how collections interact"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent,fontWeight:600},children:"Aggregation Pipeline Analysis"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Analyzes aggregation pipelines to discover data transformations and relationships"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent,fontWeight:600},children:"Document References"}),e.jsx("span",{style:{color:o.foreground,marginLeft:8,fontSize:11},children:"Tracks DBRef and manual document references between collections"})]})]})]}),e.jsxs("div",{style:{marginTop:16,padding:12,background:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:o.muted,marginBottom:4},children:[m.blockSemi," Best Practices"]}),e.jsxs("div",{style:{fontSize:11,color:o.foreground},children:["• Use filters to narrow down lineage to specific servers or databases",e.jsx("br",{}),"• Review confidence scores to identify relationships that may need verification",e.jsx("br",{}),"• Export lineage data for documentation and compliance purposes",e.jsx("br",{}),"• Monitor aggregation pipeline relationships to understand data transformations",e.jsx("br",{}),"• Review consumer context to understand how collections are being used",e.jsx("br",{}),"• Track document references to understand cross-collection dependencies"]})]}),e.jsx("div",{style:{marginTop:16,textAlign:"right"},children:e.jsx(_,{label:"Close",onClick:()=>c(!1),variant:"ghost"})})]})})})}),w&&e.jsx("div",{style:{marginBottom:20},children:e.jsx(p,{title:"ERROR",children:e.jsx("div",{style:{padding:"12px",color:o.danger,fontSize:12,fontFamily:"Consolas"},children:w})})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:12,marginBottom:24},children:[e.jsx(p,{title:"Total Relationships",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:o.foreground},children:f.total_relationships||0})}),e.jsx(p,{title:"Unique Objects",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:o.foreground},children:f.unique_objects||0})}),e.jsx(p,{title:"Unique Servers",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:o.foreground},children:f.unique_servers||0})}),e.jsx(p,{title:"Unique Databases",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:o.foreground},children:f.unique_databases||0})}),e.jsx(p,{title:"Relationship Types",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:o.foreground},children:f.unique_relationship_types||0})}),e.jsx(p,{title:"High Confidence",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:o.foreground},children:f.high_confidence||0})}),e.jsx(p,{title:"Low Confidence",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:o.foreground},children:f.low_confidence||0})}),e.jsx(p,{title:"Avg Confidence",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:o.foreground},children:f.avg_confidence?`${(Number(f.avg_confidence)*100).toFixed(1)}%`:"N/A"})}),e.jsx(p,{title:"Discovered (24h)",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:o.foreground},children:f.discovered_last_24h||0})}),e.jsx(p,{title:"Discovery Methods",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:o.foreground},children:f.unique_discovery_methods||0})})]}),e.jsx(p,{title:"FILTERS",children:e.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("select",{value:i.server_name,onChange:n=>B("server_name",n.target.value),style:{padding:"4px 8px",border:`1px solid ${o.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:o.background,color:o.foreground},children:[e.jsx("option",{value:"",children:"All Servers"}),z.map(n=>e.jsx("option",{value:n,children:n},n))]}),e.jsxs("select",{value:i.database_name,onChange:n=>B("database_name",n.target.value),disabled:!i.server_name,style:{padding:"4px 8px",border:`1px solid ${o.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:o.background,color:o.foreground,opacity:i.server_name?1:.5},children:[e.jsx("option",{value:"",children:"All Databases"}),T.map(n=>e.jsx("option",{value:n,children:n},n))]}),e.jsxs("select",{value:i.relationship_type,onChange:n=>B("relationship_type",n.target.value),style:{padding:"4px 8px",border:`1px solid ${o.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:o.background,color:o.foreground},children:[e.jsx("option",{value:"",children:"All Relationships"}),e.jsx("option",{value:"DEPENDS_ON",children:"DEPENDS_ON"}),e.jsx("option",{value:"REFERENCES",children:"REFERENCES"}),e.jsx("option",{value:"USES",children:"USES"}),e.jsx("option",{value:"CONTAINS",children:"CONTAINS"})]}),e.jsx("input",{type:"text",placeholder:"Search collection name...",value:i.search,onChange:n=>B("search",n.target.value),style:{flex:1,minWidth:"200px",padding:"4px 8px",border:`1px solid ${o.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:o.background,color:o.foreground}}),e.jsx(_,{label:"Reset All",onClick:()=>{R()},variant:"ghost"})]})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",marginTop:24,marginBottom:16,fontFamily:"Consolas",fontSize:12},children:e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx(_,{label:d==="list"?"Show Charts":"Show List",onClick:()=>N(d==="list"?"charts":"list"),variant:d==="charts"?"primary":"ghost"}),e.jsx(_,{label:"Export CSV",onClick:V,variant:"ghost"}),e.jsx(_,{label:"Lineage Info",onClick:()=>c(!0),variant:"ghost"})]})}),d==="charts"&&e.jsx(Q,{engine:"mongodb",getMetrics:v.getMongoDBMetrics,getStats:v.getMongoDBStats}),d==="list"&&r?e.jsx(H,{children:"Loading tree view..."}):d==="list"?e.jsx(oe,{edges:b,onEdgeClick:n=>q(n.id)}):null]})};export{de as default};
