import{r,a2 as w,j as e,t as s,b as o,e as E}from"./index-b1fa964d.js";import{A as M}from"./AsciiPanel-3399d5be.js";import{A as C}from"./AsciiButton-3fcfdd9b.js";import{e as R}from"./errorHandler-5ea9ae85.js";import{S as N}from"./SkeletonLoader-09c12074.js";const F=({onClose:u,onSave:k,initialConfig:t})=>{var z,$,T,n,c;const[a,B]=r.useState({streamType:(t==null?void 0:t.streamType)||"KAFKA",topic:(t==null?void 0:t.topic)||"",queue:(t==null?void 0:t.queue)||"",stream:(t==null?void 0:t.stream)||"",consumerGroup:(t==null?void 0:t.consumerGroup)||"",consumerName:(t==null?void 0:t.consumerName)||"",serializationFormat:(t==null?void 0:t.serializationFormat)||"JSON",schemaRegistryUrl:(t==null?void 0:t.schemaRegistryUrl)||"",engineConfig:(t==null?void 0:t.engineConfig)||{}}),[v,j]=r.useState(null),[y,f]=r.useState(!1),[S,g]=r.useState(!1),[x,h]=r.useState(null),l=r.useCallback((m,D)=>{B(p=>({...p,[m]:D})),j(null),h(null)},[]),i=r.useCallback(async()=>{g(!0),h(null),j(null);try{const m=await w.testConnection(a);h({success:m.success||!1,message:m.message||"Connection test completed"})}catch(m){h({success:!1,message:R(m)})}finally{g(!1)}},[a]),d=r.useCallback(async()=>{f(!0),j(null);try{await w.updateStreamConfig(a),k(a),u()}catch(m){j(R(m))}finally{f(!1)}},[a,k,u]);return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:s.spacing.lg},children:e.jsxs("div",{style:{backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:2,padding:s.spacing.xl,maxWidth:"800px",width:"100%",maxHeight:"90vh",overflowY:"auto",boxShadow:s.shadows.lg},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:s.spacing.lg,borderBottom:`1px solid ${o.border}`,paddingBottom:s.spacing.md},children:[e.jsx("h2",{style:{fontSize:18,fontWeight:600,color:o.foreground,margin:0},children:"Stream Configuration"}),e.jsx("button",{onClick:u,style:{background:"transparent",border:"none",color:o.foreground,cursor:"pointer",fontSize:20,padding:s.spacing.xs,lineHeight:1},"aria-label":"Close",children:E.cross})]}),v&&e.jsx("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:s.spacing.md},children:v}),x&&e.jsxs("div",{style:{padding:s.spacing.md,border:`1px solid ${x.success?o.accent:o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:s.spacing.md},children:[x.success?`${E.checkmark} `:`${E.cross} `,x.message]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Stream Type *"}),e.jsxs("select",{value:a.streamType,onChange:m=>l("streamType",m.target.value),style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"KAFKA",children:"Kafka"}),e.jsx("option",{value:"RABBITMQ",children:"RabbitMQ"}),e.jsx("option",{value:"REDIS_STREAMS",children:"Redis Streams"})]})]}),a.streamType==="KAFKA"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Topic *"}),e.jsx("input",{type:"text",value:a.topic||"",onChange:m=>l("topic",m.target.value),placeholder:"my-topic",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Brokers (in engineConfig)"}),e.jsx("input",{type:"text",value:((z=a.engineConfig)==null?void 0:z.brokers)||"",onChange:m=>l("engineConfig",{...a.engineConfig,brokers:m.target.value}),placeholder:"localhost:9092,localhost:9093",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),a.streamType==="RABBITMQ"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Queue *"}),e.jsx("input",{type:"text",value:a.queue||"",onChange:m=>l("queue",m.target.value),placeholder:"my-queue",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:s.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Host"}),e.jsx("input",{type:"text",value:(($=a.engineConfig)==null?void 0:$.host)||"localhost",onChange:m=>l("engineConfig",{...a.engineConfig,host:m.target.value}),style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Port"}),e.jsx("input",{type:"number",value:((T=a.engineConfig)==null?void 0:T.port)||5672,onChange:m=>l("engineConfig",{...a.engineConfig,port:parseInt(m.target.value)||5672}),style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]})]}),a.streamType==="REDIS_STREAMS"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Stream Name *"}),e.jsx("input",{type:"text",value:a.stream||"",onChange:m=>l("stream",m.target.value),placeholder:"my-stream",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:s.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Host"}),e.jsx("input",{type:"text",value:((n=a.engineConfig)==null?void 0:n.host)||"localhost",onChange:m=>l("engineConfig",{...a.engineConfig,host:m.target.value}),style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Port"}),e.jsx("input",{type:"number",value:((c=a.engineConfig)==null?void 0:c.port)||6379,onChange:m=>l("engineConfig",{...a.engineConfig,port:parseInt(m.target.value)||6379}),style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Consumer Group"}),e.jsx("input",{type:"text",value:a.consumerGroup,onChange:m=>l("consumerGroup",m.target.value),placeholder:"my-consumer-group",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Consumer Name"}),e.jsx("input",{type:"text",value:a.consumerName,onChange:m=>l("consumerName",m.target.value),placeholder:"consumer-1",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Serialization Format"}),e.jsxs("select",{value:a.serializationFormat,onChange:m=>l("serializationFormat",m.target.value),style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"JSON",children:"JSON"}),e.jsx("option",{value:"AVRO",children:"Avro"}),e.jsx("option",{value:"PROTOBUF",children:"Protobuf"}),e.jsx("option",{value:"JSON_SCHEMA",children:"JSON Schema"})]})]}),(a.serializationFormat==="AVRO"||a.serializationFormat==="PROTOBUF"||a.serializationFormat==="JSON_SCHEMA")&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Schema Registry URL"}),e.jsx("input",{type:"text",value:a.schemaRegistryUrl||"",onChange:m=>l("schemaRegistryUrl",m.target.value),placeholder:"http://localhost:8081",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:s.spacing.md,marginTop:s.spacing.xl,paddingTop:s.spacing.md,borderTop:`1px solid ${o.border}`},children:[e.jsx(C,{onClick:u,disabled:y||S,children:"Cancel"}),e.jsx(C,{onClick:i,disabled:y||S,children:S?"Testing...":"Test Connection"}),e.jsx(C,{onClick:d,disabled:y||S||a.streamType==="KAFKA"&&!a.topic||a.streamType==="RABBITMQ"&&!a.queue||a.streamType==="REDIS_STREAMS"&&!a.stream,children:y?"Saving...":"Save"})]})]})})},L=()=>{const[u,k]=r.useState([]),[t,a]=r.useState(null),[B,v]=r.useState(!0),[j,y]=r.useState(null),[f,S]=r.useState(null),[g,x]=r.useState(!1),h=r.useRef(!0),l=r.useRef(null),i=r.useCallback(async()=>{var n;if(h.current)try{y(null);const c=await w.getConsumers();h.current&&k(c||[])}catch(c){if(h.current){if(((n=c==null?void 0:c.response)==null?void 0:n.status)===404){k([]);return}y(R(c))}}finally{h.current&&v(!1)}},[]);r.useEffect(()=>(h.current=!0,v(!0),i(),l.current=setInterval(()=>{i()},5e3),()=>{h.current=!1,l.current&&clearInterval(l.current)}),[i]);const d=r.useCallback(n=>{a(n),x(!1),S(null)},[]),z=r.useCallback(async n=>{var c;try{const m=await w.getConsumerStats(n);S(m),x(!0)}catch(m){if(((c=m==null?void 0:m.response)==null?void 0:c.status)===404){S({message:"Stats not available - endpoint not implemented yet"}),x(!0);return}y(R(m))}},[]),$=r.useCallback(async n=>{if(confirm("Are you sure you want to stop this consumer?"))try{await w.stopConsumer(n),await i(),(t==null?void 0:t.consumerId)===n&&a(null)}catch(c){y(R(c))}},[t,i]),T=r.useCallback(n=>{const c=new Date(n),D=new Date().getTime()-c.getTime(),p=Math.floor(D/1e3),b=Math.floor(p/60),I=Math.floor(b/60),A=Math.floor(I/24);return A>0?`${A}d ${I%24}h`:I>0?`${I}h ${b%60}m`:b>0?`${b}m ${p%60}s`:`${p}s`},[]);return B?e.jsx(N,{}):e.jsxs("div",{children:[j&&e.jsx("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:s.spacing.md},children:j}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:s.spacing.lg},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:14,marginBottom:s.spacing.md},children:"Active Consumers"}),u.length===0?e.jsx("div",{style:{padding:s.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No active consumers"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.sm},children:u.map(n=>e.jsxs("div",{onClick:()=>d(n),style:{padding:s.spacing.md,border:`1px solid ${(t==null?void 0:t.consumerId)===n.consumerId?o.accent:o.border}`,borderRadius:2,backgroundColor:(t==null?void 0:t.consumerId)===n.consumerId?o.backgroundSoft:o.background,cursor:"pointer",transition:"all 0.15s ease"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:s.spacing.xs},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:o.foreground,marginBottom:s.spacing.xs},children:n.consumerName||n.consumerId}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Group: ",n.consumerGroup||"N/A"]})]}),e.jsx("div",{style:{padding:`${s.spacing.xs}px ${s.spacing.sm}px`,border:`1px solid ${n.status==="ACTIVE"?o.accent:o.border}`,borderRadius:2,backgroundColor:n.status==="ACTIVE"?o.accent:"transparent",color:n.status==="ACTIVE"?"#ffffff":o.foreground,fontSize:10,textTransform:"uppercase"},children:n.status})]}),e.jsxs("div",{style:{fontSize:11,color:o.muted,marginTop:s.spacing.xs},children:["Started: ",new Date(n.startedAt).toLocaleString()," (",T(n.startedAt)," ago)"]}),n.errorMessage&&e.jsxs("div",{style:{fontSize:11,color:"#ff4444",marginTop:s.spacing.xs},children:["Error: ",n.errorMessage]})]},n.consumerId))})]}),t&&e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:14,marginBottom:s.spacing.md},children:"Consumer Details"}),e.jsxs("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsxs("div",{style:{marginBottom:s.spacing.sm},children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:s.spacing.xs},children:"Consumer ID"}),e.jsx("div",{style:{fontSize:12,color:o.foreground,fontFamily:"Consolas, monospace"},children:t.consumerId})]}),e.jsxs("div",{style:{marginBottom:s.spacing.sm},children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:s.spacing.xs},children:"Consumer Group"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:t.consumerGroup||"N/A"})]}),e.jsxs("div",{style:{marginBottom:s.spacing.sm},children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:s.spacing.xs},children:"Consumer Name"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:t.consumerName||"N/A"})]}),e.jsxs("div",{style:{marginBottom:s.spacing.sm},children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:s.spacing.xs},children:"Status"}),e.jsx("div",{style:{fontSize:12,color:o.foreground,textTransform:"uppercase"},children:t.status})]}),e.jsxs("div",{style:{marginBottom:s.spacing.sm},children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:s.spacing.xs},children:"Started At"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:new Date(t.startedAt).toLocaleString()})]}),t.stoppedAt&&e.jsxs("div",{style:{marginBottom:s.spacing.sm},children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:s.spacing.xs},children:"Stopped At"}),e.jsx("div",{style:{fontSize:12,color:o.foreground},children:new Date(t.stoppedAt).toLocaleString()})]}),t.errorMessage&&e.jsxs("div",{style:{marginBottom:s.spacing.sm},children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:s.spacing.xs},children:"Error"}),e.jsx("div",{style:{fontSize:12,color:"#ff4444"},children:t.errorMessage})]}),e.jsxs("div",{style:{display:"flex",gap:s.spacing.sm,marginTop:s.spacing.md},children:[e.jsx(C,{onClick:()=>z(t.consumerId),children:"View Stats"}),t.status==="ACTIVE"&&e.jsx(C,{onClick:()=>$(t.consumerId),children:"Stop Consumer"})]})]}),g&&f&&e.jsxs("div",{style:{marginTop:s.spacing.md,padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsx("h4",{style:{fontSize:12,marginBottom:s.spacing.sm},children:"Statistics"}),f.message?e.jsx("div",{style:{fontSize:11,color:o.muted},children:f.message}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.xs},children:[e.jsxs("div",{style:{fontSize:11,color:o.foreground},children:["Messages Processed: ",f.messagesProcessed||0]}),e.jsxs("div",{style:{fontSize:11,color:o.foreground},children:["Messages Failed: ",f.messagesFailed||0]}),e.jsxs("div",{style:{fontSize:11,color:o.foreground},children:["Bytes Processed: ",f.bytesProcessed||0]}),e.jsxs("div",{style:{fontSize:11,color:o.foreground},children:["Average Latency: ",f.averageLatencyMs||0,"ms"]}),e.jsxs("div",{style:{fontSize:11,color:o.foreground},children:["Errors: ",f.errors||0]})]})]})]})]})]})},W=()=>{const[u,k]=r.useState([]),[t,a]=r.useState(!0),[B,v]=r.useState(null),[j,y]=r.useState(!1),[f,S]=r.useState({windowType:"TUMBLING",windowSizeSeconds:60,slideIntervalSeconds:60,sessionTimeoutSeconds:300}),g=r.useRef(!0),x=r.useRef(null),h=r.useCallback(async()=>{var i;if(g.current)try{v(null);const d=await w.getWindows();g.current&&k(d||[])}catch(d){if(g.current){if(((i=d==null?void 0:d.response)==null?void 0:i.status)===404){k([]);return}v(R(d))}}finally{g.current&&a(!1)}},[]);r.useEffect(()=>(g.current=!0,a(!0),h(),x.current=setInterval(()=>{h()},1e4),()=>{g.current=!1,x.current&&clearInterval(x.current)}),[h]);const l=r.useCallback(async()=>{try{await w.createWindow(f),y(!1),S({windowType:"TUMBLING",windowSizeSeconds:60,slideIntervalSeconds:60,sessionTimeoutSeconds:300}),await h()}catch(i){v(R(i))}},[f,h]);return t?e.jsx(N,{}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:s.spacing.md},children:[e.jsx("h3",{style:{fontSize:14},children:"Active Windows"}),e.jsx(C,{onClick:()=>y(!0),children:"Create Window"})]}),B&&e.jsx("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:s.spacing.md},children:B}),j&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:2,padding:s.spacing.xl,maxWidth:"600px",width:"100%"},children:[e.jsx("h3",{style:{fontSize:14,marginBottom:s.spacing.md},children:"Create Window"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Window Type *"}),e.jsxs("select",{value:f.windowType||"TUMBLING",onChange:i=>S(d=>({...d,windowType:i.target.value})),style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"TUMBLING",children:"Tumbling"}),e.jsx("option",{value:"SLIDING",children:"Sliding"}),e.jsx("option",{value:"SESSION",children:"Session"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Window Size (seconds) *"}),e.jsx("input",{type:"number",value:f.windowSizeSeconds||60,onChange:i=>S(d=>({...d,windowSizeSeconds:parseInt(i.target.value)||60})),min:"1",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),f.windowType==="SLIDING"&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Slide Interval (seconds)"}),e.jsx("input",{type:"number",value:f.slideIntervalSeconds||60,onChange:i=>S(d=>({...d,slideIntervalSeconds:parseInt(i.target.value)||60})),min:"1",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),f.windowType==="SESSION"&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Session Timeout (seconds)"}),e.jsx("input",{type:"number",value:f.sessionTimeoutSeconds||300,onChange:i=>S(d=>({...d,sessionTimeoutSeconds:parseInt(i.target.value)||300})),min:"1",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{style:{display:"flex",gap:s.spacing.sm,justifyContent:"flex-end",marginTop:s.spacing.md},children:[e.jsx(C,{onClick:()=>y(!1),children:"Cancel"}),e.jsx(C,{onClick:l,children:"Create"})]})]})]})}),u.length===0?e.jsx("div",{style:{padding:s.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No active windows"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.sm},children:u.map(i=>e.jsxs("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:s.spacing.xs},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:o.foreground,marginBottom:s.spacing.xs},children:i.windowId}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Type: ",i.windowType," | Size: ",i.windowSizeSeconds,"s",i.slideIntervalSeconds&&` | Slide: ${i.slideIntervalSeconds}s`,i.sessionTimeoutSeconds&&` | Timeout: ${i.sessionTimeoutSeconds}s`]})]}),e.jsx("div",{style:{padding:`${s.spacing.xs}px ${s.spacing.sm}px`,border:`1px solid ${i.isClosed?o.border:o.accent}`,borderRadius:2,backgroundColor:i.isClosed?"transparent":o.accent,color:i.isClosed?o.foreground:"#ffffff",fontSize:10,textTransform:"uppercase"},children:i.isClosed?"Closed":"Active"})]}),i.startTime&&e.jsxs("div",{style:{fontSize:11,color:o.muted,marginTop:s.spacing.xs},children:["Start: ",new Date(i.startTime).toLocaleString(),i.endTime&&` | End: ${new Date(i.endTime).toLocaleString()}`]}),e.jsxs("div",{style:{fontSize:11,color:o.muted,marginTop:s.spacing.xs},children:["Events: ",i.eventCount||0]})]},i.windowId))})]})},P=()=>{const[u,k]=r.useState(""),[t,a]=r.useState(null),[B,v]=r.useState(!1),[j,y]=r.useState(null),[f,S]=r.useState(""),[g,x]=r.useState(!1),h=r.useCallback(async()=>{var d;if(!u.trim()){a(null);return}v(!0),y(null);try{const z=await w.getState(u);z?(a(z),S(JSON.stringify(z.value,null,2))):a(null)}catch(z){((d=z==null?void 0:z.response)==null?void 0:d.status)===404?a(null):y(R(z))}finally{v(!1)}},[u]),l=r.useCallback(async()=>{if(!u.trim()||!f.trim()){y("Key and value are required");return}try{let d;try{d=JSON.parse(f)}catch{d=f}await w.updateState(u,d),x(!1),await h()}catch(d){y(R(d))}},[u,f,h]),i=r.useCallback(async()=>{if(u.trim()&&confirm("Are you sure you want to clear this state?"))try{await w.clearState(u),a(null),k(""),S("")}catch(d){y(R(d))}},[u]);return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:s.spacing.md},children:[e.jsx("h3",{style:{fontSize:14,marginBottom:s.spacing.sm},children:"Search State"}),e.jsxs("div",{style:{display:"flex",gap:s.spacing.sm},children:[e.jsx("input",{type:"text",value:u,onChange:d=>k(d.target.value),onKeyPress:d=>d.key==="Enter"&&h(),placeholder:"Enter state key...",style:{flex:1,padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx(C,{onClick:h,disabled:B||!u.trim(),children:B?"Searching...":"Search"})]})]}),j&&e.jsx("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:s.spacing.md},children:j}),t?e.jsxs("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:s.spacing.md},children:[e.jsxs("h4",{style:{fontSize:12,margin:0},children:["State: ",t.key]}),e.jsxs("div",{style:{display:"flex",gap:s.spacing.sm},children:[!g&&e.jsx(C,{onClick:()=>x(!0),children:"Edit"}),e.jsx(C,{onClick:i,children:"Clear"})]})]}),g?e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Value (JSON)"}),e.jsx("textarea",{value:f,onChange:d=>S(d.target.value),rows:10,style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:11,resize:"vertical"}}),e.jsxs("div",{style:{display:"flex",gap:s.spacing.sm,marginTop:s.spacing.sm},children:[e.jsx(C,{onClick:l,children:"Save"}),e.jsx(C,{onClick:()=>{x(!1),S(JSON.stringify(t.value,null,2))},children:"Cancel"})]})]}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:s.spacing.sm},children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:s.spacing.xs},children:"Value"}),e.jsx("pre",{style:{padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontSize:11,fontFamily:"Consolas, monospace",overflow:"auto",maxHeight:"300px"},children:JSON.stringify(t.value,null,2)})]}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Last Updated: ",new Date(t.lastUpdated).toLocaleString()]}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Update Count: ",t.updateCount]})]})]}):u&&!B?e.jsx("div",{style:{padding:s.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"State not found"}):null]})},O=()=>{const[u,k]=r.useState([]),[t,a]=r.useState([]),[B,v]=r.useState(!0),[j,y]=r.useState(null),[f,S]=r.useState(!1),[g,x]=r.useState(null),[h,l]=r.useState(!1),[i,d]=r.useState({ruleId:"",name:"",description:"",pattern:{sequence:[]},conditions:{},actions:{},enabled:!0,windowSeconds:300}),z=r.useRef(!0),$=r.useRef(null),T=r.useCallback(async()=>{var p;if(z.current)try{y(null);const b=await w.getCEPRules();z.current&&k(b||[])}catch(b){if(z.current){if(((p=b==null?void 0:b.response)==null?void 0:p.status)===404){k([]);return}y(R(b))}}finally{z.current&&v(!1)}},[]),n=r.useCallback(async p=>{var b;try{const I=await w.getCEPMatches(p);a(I||[])}catch(I){if(((b=I==null?void 0:I.response)==null?void 0:b.status)===404){a([]);return}y(R(I))}},[]);r.useEffect(()=>(z.current=!0,v(!0),T(),n(),$.current=setInterval(()=>{T(),n()},1e4),()=>{z.current=!1,$.current&&clearInterval($.current)}),[T,n]);const c=r.useCallback(async()=>{if(!i.ruleId||!i.name||!i.pattern){y("Rule ID, name, and pattern are required");return}try{await w.createCEPRule(i),S(!1),d({ruleId:"",name:"",description:"",pattern:{sequence:[]},conditions:{},actions:{},enabled:!0,windowSeconds:300}),await T()}catch(p){y(R(p))}},[i,T]),m=r.useCallback(async p=>{if(confirm("Are you sure you want to delete this rule?"))try{await w.deleteCEPRule(p),await T(),(g==null?void 0:g.ruleId)===p&&x(null)}catch(b){y(R(b))}},[g,T]),D=r.useCallback(async p=>{x(u.find(b=>b.ruleId===p)||null),await n(p),l(!0)},[u,n]);return B?e.jsx(N,{}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:s.spacing.md},children:[e.jsx("h3",{style:{fontSize:14},children:"CEP Rules"}),e.jsx(C,{onClick:()=>S(!0),children:"Create Rule"})]}),j&&e.jsx("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:s.spacing.md},children:j}),f&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:s.spacing.lg},children:e.jsxs("div",{style:{backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:2,padding:s.spacing.xl,maxWidth:"800px",width:"100%",maxHeight:"90vh",overflowY:"auto"},children:[e.jsx("h3",{style:{fontSize:14,marginBottom:s.spacing.md},children:"Create CEP Rule"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Rule ID *"}),e.jsx("input",{type:"text",value:i.ruleId||"",onChange:p=>d(b=>({...b,ruleId:p.target.value})),placeholder:"rule-1",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Name *"}),e.jsx("input",{type:"text",value:i.name||"",onChange:p=>d(b=>({...b,name:p.target.value})),placeholder:"High Temperature Alert",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Description"}),e.jsx("textarea",{value:i.description||"",onChange:p=>d(b=>({...b,description:p.target.value})),rows:3,style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Pattern (JSON) *"}),e.jsx("textarea",{value:JSON.stringify(i.pattern||{},null,2),onChange:p=>{try{d(b=>({...b,pattern:JSON.parse(p.target.value)}))}catch{}},rows:8,style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:11}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Window Seconds"}),e.jsx("input",{type:"number",value:i.windowSeconds||300,onChange:p=>d(b=>({...b,windowSeconds:parseInt(p.target.value)||300})),min:"1",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{style:{display:"flex",gap:s.spacing.sm,justifyContent:"flex-end",marginTop:s.spacing.md},children:[e.jsx(C,{onClick:()=>S(!1),children:"Cancel"}),e.jsx(C,{onClick:c,children:"Create"})]})]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:s.spacing.lg},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{fontSize:12,marginBottom:s.spacing.sm},children:"Rules"}),u.length===0?e.jsx("div",{style:{padding:s.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No CEP rules configured"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.sm},children:u.map(p=>e.jsxs("div",{style:{padding:s.spacing.md,border:`1px solid ${(g==null?void 0:g.ruleId)===p.ruleId?o.accent:o.border}`,borderRadius:2,backgroundColor:(g==null?void 0:g.ruleId)===p.ruleId?o.backgroundSoft:o.background,cursor:"pointer"},onClick:()=>x(p),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:s.spacing.xs},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:o.foreground,marginBottom:s.spacing.xs},children:p.name}),e.jsx("div",{style:{fontSize:11,color:o.muted},children:p.description||p.ruleId})]}),e.jsx("div",{style:{padding:`${s.spacing.xs}px ${s.spacing.sm}px`,border:`1px solid ${p.enabled?o.accent:o.border}`,borderRadius:2,backgroundColor:p.enabled?o.accent:"transparent",color:p.enabled?"#ffffff":o.foreground,fontSize:10,textTransform:"uppercase"},children:p.enabled?"Enabled":"Disabled"})]}),e.jsxs("div",{style:{display:"flex",gap:s.spacing.sm,marginTop:s.spacing.sm},children:[e.jsx(C,{onClick:b=>{b.stopPropagation(),D(p.ruleId)},children:"View Matches"}),e.jsx(C,{onClick:b=>{b.stopPropagation(),m(p.ruleId)},children:"Delete"})]})]},p.ruleId))})]}),h&&e.jsxs("div",{children:[e.jsxs("h4",{style:{fontSize:12,marginBottom:s.spacing.sm},children:["Matches ",g&&`- ${g.name}`]}),t.length===0?e.jsx("div",{style:{padding:s.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No matches found"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.sm,maxHeight:"600px",overflowY:"auto"},children:t.map(p=>{var b;return e.jsxs("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:s.spacing.xs},children:new Date(p.matchTime).toLocaleString()}),e.jsxs("div",{style:{fontSize:11,color:o.foreground},children:["Matched Events: ",((b=p.matchedEvents)==null?void 0:b.length)||0]})]},p.matchId)})})]})]})]})},G=()=>{const[u,k]=r.useState([]),[t,a]=r.useState(!0),[B,v]=r.useState(null),[j,y]=r.useState(null),[f,S]=r.useState(!1),[g,x]=r.useState({dbEngine:"",connectionString:"",cdcType:"BINLOG",databaseName:"",tableName:"",position:""}),h=r.useRef(!0),l=r.useRef(null),i=r.useCallback(async()=>{var n;if(h.current)try{v(null);const c=await w.getNativeCDCConfig();h.current&&k(c||[])}catch(c){if(h.current){if(((n=c==null?void 0:c.response)==null?void 0:n.status)===404){k([]);return}v(R(c))}}finally{h.current&&a(!1)}},[]);r.useEffect(()=>(h.current=!0,a(!0),i(),l.current=setInterval(()=>{i()},1e4),()=>{h.current=!1,l.current&&clearInterval(l.current)}),[i]);const d=r.useCallback(async()=>{if(!g.dbEngine||!g.connectionString||!g.cdcType){v("Database engine, connection string, and CDC type are required");return}try{await w.updateNativeCDCConfig(g),S(!1),x({dbEngine:"",connectionString:"",cdcType:"BINLOG",databaseName:"",tableName:"",position:""}),await i()}catch(n){v(R(n))}},[g,i]),z=r.useCallback(async n=>{try{await w.startNativeCDC(n),await i()}catch(c){v(R(c))}},[i]),$=r.useCallback(async n=>{try{await w.stopNativeCDC(n),await i()}catch(c){v(R(c))}},[i]),T=r.useCallback(async n=>{try{const c=await w.getCDCPosition(n);c&&alert(`Current Position: ${c.position||"N/A"}`)}catch(c){v(R(c))}},[]);return t?e.jsx(N,{}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:s.spacing.md},children:[e.jsx("h3",{style:{fontSize:14},children:"Native CDC Configuration"}),e.jsx(C,{onClick:()=>S(!0),children:"Add CDC Config"})]}),B&&e.jsx("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:s.spacing.md},children:B}),f&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:s.spacing.lg},children:e.jsxs("div",{style:{backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:2,padding:s.spacing.xl,maxWidth:"700px",width:"100%",maxHeight:"90vh",overflowY:"auto"},children:[e.jsx("h3",{style:{fontSize:14,marginBottom:s.spacing.md},children:"Add Native CDC Configuration"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Database Engine *"}),e.jsxs("select",{value:g.dbEngine||"",onChange:n=>x(c=>({...c,dbEngine:n.target.value})),style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"mariadb",children:"MariaDB"}),e.jsx("option",{value:"mysql",children:"MySQL"}),e.jsx("option",{value:"postgresql",children:"PostgreSQL"}),e.jsx("option",{value:"mssql",children:"MSSQL"}),e.jsx("option",{value:"oracle",children:"Oracle"}),e.jsx("option",{value:"mongodb",children:"MongoDB"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"CDC Type *"}),e.jsxs("select",{value:g.cdcType||"BINLOG",onChange:n=>x(c=>({...c,cdcType:n.target.value})),style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"BINLOG",children:"Binlog (MySQL/MariaDB)"}),e.jsx("option",{value:"WAL",children:"WAL (PostgreSQL)"}),e.jsx("option",{value:"TRANSACTION_LOG",children:"Transaction Log (MSSQL)"}),e.jsx("option",{value:"REDO_LOG",children:"Redo Log (Oracle)"}),e.jsx("option",{value:"CHANGE_STREAMS",children:"Change Streams (MongoDB)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Connection String *"}),e.jsx("textarea",{value:g.connectionString||"",onChange:n=>x(c=>({...c,connectionString:n.target.value})),rows:3,placeholder:"postgresql://user:password@host:port/database",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:11}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:s.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Database Name"}),e.jsx("input",{type:"text",value:g.databaseName||"",onChange:n=>x(c=>({...c,databaseName:n.target.value})),style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Table Name"}),e.jsx("input",{type:"text",value:g.tableName||"",onChange:n=>x(c=>({...c,tableName:n.target.value})),style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:s.spacing.xs,fontSize:12,color:o.foreground},children:"Initial Position"}),e.jsx("input",{type:"text",value:g.position||"",onChange:n=>x(c=>({...c,position:n.target.value})),placeholder:"0/0, binlog position, SCN, etc.",style:{width:"100%",padding:s.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{style:{display:"flex",gap:s.spacing.sm,justifyContent:"flex-end",marginTop:s.spacing.md},children:[e.jsx(C,{onClick:()=>S(!1),children:"Cancel"}),e.jsx(C,{onClick:d,children:"Save"})]})]})]})}),u.length===0?e.jsx("div",{style:{padding:s.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No native CDC configurations"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.sm},children:u.map(n=>e.jsxs("div",{onClick:()=>y(n),style:{padding:s.spacing.md,border:`1px solid ${(j==null?void 0:j.id)===n.id?o.accent:o.border}`,borderRadius:2,backgroundColor:(j==null?void 0:j.id)===n.id?o.backgroundSoft:o.background,cursor:"pointer"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:s.spacing.xs},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:o.foreground,marginBottom:s.spacing.xs},children:[n.dbEngine," - ",n.cdcType]}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:[n.databaseName&&`${n.databaseName}.`,n.tableName||"All tables"]})]}),e.jsx("div",{style:{padding:`${s.spacing.xs}px ${s.spacing.sm}px`,border:`1px solid ${n.status==="RUNNING"?o.accent:o.border}`,borderRadius:2,backgroundColor:n.status==="RUNNING"?o.accent:"transparent",color:n.status==="RUNNING"?"#ffffff":o.foreground,fontSize:10,textTransform:"uppercase"},children:n.status})]}),n.position&&e.jsxs("div",{style:{fontSize:11,color:o.muted,marginBottom:s.spacing.xs},children:["Position: ",n.position]}),n.errorMessage&&e.jsxs("div",{style:{fontSize:11,color:"#ff4444",marginBottom:s.spacing.xs},children:["Error: ",n.errorMessage]}),e.jsxs("div",{style:{display:"flex",gap:s.spacing.sm,marginTop:s.spacing.sm},children:[n.status==="STOPPED"&&e.jsx(C,{onClick:c=>{c.stopPropagation(),n.id&&z(n.id)},children:"Start"}),n.status==="RUNNING"&&e.jsx(C,{onClick:c=>{c.stopPropagation(),n.id&&$(n.id)},children:"Stop"}),e.jsx(C,{onClick:c=>{c.stopPropagation(),n.id&&T(n.id)},children:"View Position"})]})]},n.id))})]})},U=()=>{var S,g,x,h,l;const[u,k]=r.useState(null),[t,a]=r.useState(!0),[B,v]=r.useState(null),j=r.useRef(!0),y=r.useRef(null),f=r.useCallback(async()=>{var i;if(j.current)try{v(null);const d=await w.getStats();j.current&&k(d)}catch(d){if(j.current){if(((i=d==null?void 0:d.response)==null?void 0:i.status)===404){k(null);return}v(R(d))}}finally{j.current&&a(!1)}},[]);return r.useEffect(()=>(j.current=!0,a(!0),f(),y.current=setInterval(()=>{f()},5e3),()=>{j.current=!1,y.current&&clearInterval(y.current)}),[f]),t?e.jsx(N,{}):u?e.jsxs("div",{children:[B&&e.jsx("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:s.spacing.md},children:B}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:s.spacing.md},children:[e.jsxs("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsx("h4",{style:{fontSize:12,marginBottom:s.spacing.sm,color:o.foreground},children:"Consumers"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.xs},children:[e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Active: ",e.jsx("span",{style:{color:o.foreground,fontWeight:600},children:((S=u.consumers)==null?void 0:S.active)||0})]}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Stopped: ",e.jsx("span",{style:{color:o.foreground,fontWeight:600},children:((g=u.consumers)==null?void 0:g.stopped)||0})]})]})]}),e.jsxs("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsx("h4",{style:{fontSize:12,marginBottom:s.spacing.sm,color:o.foreground},children:"CEP"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.xs},children:[e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Active Rules: ",e.jsx("span",{style:{color:o.foreground,fontWeight:600},children:((x=u.cep)==null?void 0:x.activeRules)||0})]}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Matches (24h): ",e.jsx("span",{style:{color:o.foreground,fontWeight:600},children:((h=u.cep)==null?void 0:h.matchesLast24h)||0})]})]})]}),e.jsxs("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsx("h4",{style:{fontSize:12,marginBottom:s.spacing.sm,color:o.foreground},children:"Native CDC"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.xs},children:e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Running: ",e.jsx("span",{style:{color:o.foreground,fontWeight:600},children:((l=u.nativeCDC)==null?void 0:l.running)||0})]})})]})]}),e.jsxs("div",{style:{marginTop:s.spacing.lg,padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsx("h4",{style:{fontSize:12,marginBottom:s.spacing.sm,color:o.foreground},children:"System Status"}),e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Last updated: ",new Date().toLocaleString()]}),e.jsx("div",{style:{fontSize:11,color:o.muted,marginTop:s.spacing.xs},children:"Auto-refresh: Every 5 seconds"})]})]}):e.jsx("div",{style:{padding:s.spacing.lg,border:`1px solid ${o.border}`,borderRadius:2,textAlign:"center",color:o.muted},children:"No statistics available"})},Q=()=>{const[u,k]=r.useState("config"),[t,a]=r.useState(null),[B,v]=r.useState(!0),[j,y]=r.useState(null),[f,S]=r.useState(!1),g=r.useRef(!0),x=r.useCallback(async()=>{if(g.current)try{v(!0),y(null);const l=await w.getStreamConfig().catch(i=>{var d;return((d=i==null?void 0:i.response)==null?void 0:d.status)===404||console.warn("Error getting stream config:",i),null});g.current&&l&&a(l)}catch(l){g.current&&y(R(l))}finally{g.current&&v(!1)}},[]);r.useEffect(()=>(g.current=!0,x(),()=>{g.current=!1}),[x]);const h=r.useCallback(l=>{a(l),x()},[x]);return B?e.jsx(N,{}):e.jsx("div",{style:{padding:s.spacing.lg},children:e.jsx(M,{children:e.jsxs("div",{style:{marginBottom:s.spacing.lg},children:[e.jsx("h1",{style:{fontSize:18,fontWeight:600,color:o.foreground,marginBottom:s.spacing.md},children:"Stream Processing"}),e.jsx("p",{style:{color:o.muted,fontSize:12,marginBottom:s.spacing.lg},children:"Configure and monitor real-time stream processing with Kafka, RabbitMQ, and Redis Streams"}),j&&e.jsx("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:s.spacing.lg},children:j}),e.jsx("div",{style:{display:"flex",gap:s.spacing.sm,marginBottom:s.spacing.lg,borderBottom:`2px solid ${o.border}`,paddingBottom:s.spacing.sm},children:["config","consumers","windowing","stateful","cep","cdc","monitor"].map(l=>e.jsxs("button",{onClick:()=>k(l),style:{padding:`${s.spacing.sm} ${s.spacing.md}`,border:"none",background:u===l?o.accent:"transparent",color:u===l?"#ffffff":o.foreground,borderRadius:"2 2 0 0",cursor:"pointer",fontWeight:u===l?600:500,transition:"all 0.15s ease",textTransform:"capitalize",fontFamily:"Consolas, monospace",fontSize:12},onMouseEnter:i=>{u!==l&&(i.currentTarget.style.background=o.backgroundSoft)},onMouseLeave:i=>{u!==l&&(i.currentTarget.style.background="transparent")},children:[l==="config"&&"Stream Config",l==="consumers"&&"Consumers",l==="windowing"&&"Windowing",l==="stateful"&&"Stateful",l==="cep"&&"CEP Rules",l==="cdc"&&"Native CDC",l==="monitor"&&"Monitor"]},l))}),e.jsxs("div",{style:{minHeight:"400px"},children:[u==="config"&&e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:s.spacing.md},children:e.jsx(C,{onClick:()=>S(!0),style:{marginBottom:s.spacing.md},children:t?"Edit Stream Configuration":"Configure Stream"})}),t&&e.jsxs("div",{style:{padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsxs("div",{style:{fontSize:12,color:o.foreground,marginBottom:s.spacing.xs},children:["Type: ",t.streamType]}),t.topic&&e.jsxs("div",{style:{fontSize:12,color:o.foreground,marginBottom:s.spacing.xs},children:["Topic: ",t.topic]}),t.queue&&e.jsxs("div",{style:{fontSize:12,color:o.foreground,marginBottom:s.spacing.xs},children:["Queue: ",t.queue]}),t.stream&&e.jsxs("div",{style:{fontSize:12,color:o.foreground,marginBottom:s.spacing.xs},children:["Stream: ",t.stream]}),e.jsxs("div",{style:{fontSize:12,color:o.foreground,marginBottom:s.spacing.xs},children:["Consumer Group: ",t.consumerGroup||"N/A"]}),e.jsxs("div",{style:{fontSize:12,color:o.foreground},children:["Serialization: ",t.serializationFormat]})]})]}),u==="consumers"&&e.jsx(L,{}),u==="windowing"&&e.jsx(W,{}),u==="stateful"&&e.jsx(P,{}),u==="cep"&&e.jsx(O,{}),u==="cdc"&&e.jsx(G,{}),u==="monitor"&&e.jsx(U,{})]}),f&&e.jsx(F,{onClose:()=>S(!1),onSave:h,initialConfig:t})]})})})};export{Q as default};
