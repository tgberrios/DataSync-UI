import{r as u,j as e,t as r,b as o,e as d,aa as k,C as ne}from"./index-f6ac47b8.js";import{e as w}from"./errorHandler-5ea9ae85.js";import{A as L}from"./AsciiButton-4907e65e.js";import{A as te}from"./AsciiConnectionStringSelector-f0a9a200.js";import{S as re}from"./SkeletonLoader-792007e7.js";import"./GCSConnectionConfig-f004c48c.js";const se=({backups:y,onViewHistory:C,onToggleSchedule:$,onRestore:j,onDelete:_,onSelect:p})=>{const[A,i]=u.useState(new Set),x=u.useMemo(()=>{const l=new Map;return y.forEach(f=>{const g=f.db_engine||"Other";l.has(g)||l.set(g,{engine:g,backups:[]}),l.get(g).backups.push(f)}),Array.from(l.values()).sort((f,g)=>f.engine.localeCompare(g.engine))},[y]),z=l=>{i(f=>{const g=new Set(f);return g.has(l)?g.delete(l):g.add(l),g})},b=(l,f)=>{if(l===0)return null;const g=[];for(let a=0;a<l-1;a++)g.push(`${d.v}  `);return f?g.push(`${d.bl}${d.h}${d.h} `):g.push(`${d.tRight}${d.h}${d.h} `),e.jsx("span",{style:{color:o.border,marginRight:6,fontFamily:"Consolas",fontSize:11},children:g.join("")})},D=l=>{switch(l){case"completed":return o.accent;case"failed":return o.foreground;case"in_progress":return o.muted;case"pending":return o.muted;default:return o.foreground}},m=l=>l?l<1024?`${l} B`:l<1024*1024?`${(l/1024).toFixed(2)} KB`:l<1024*1024*1024?`${(l/(1024*1024)).toFixed(2)} MB`:`${(l/(1024*1024*1024)).toFixed(2)} GB`:"N/A";return y.length===0?e.jsxs("div",{style:{padding:r.spacing.lg,textAlign:"center",color:o.muted,fontFamily:"Consolas",fontSize:12},children:[d.blockEmpty," No backups found"]}):e.jsx("div",{style:{fontFamily:"Consolas",fontSize:12,color:o.foreground},children:x.map((l,f)=>{const g=A.has(l.engine);return x.length-1,e.jsxs("div",{style:{marginBottom:4},children:[e.jsxs("div",{onClick:()=>z(l.engine),style:{display:"flex",alignItems:"center",padding:"10px 8px",cursor:"pointer",borderLeft:`2px solid ${o.accent}`,backgroundColor:g?o.backgroundSoft:o.background,transition:"all 0.15s ease",marginBottom:2},onMouseEnter:a=>{a.currentTarget.style.backgroundColor=o.backgroundSoft},onMouseLeave:a=>{g||(a.currentTarget.style.backgroundColor=o.background)},children:[e.jsx("span",{style:{marginRight:8,color:g?o.accent:o.muted,fontSize:10,transition:"transform 0.15s ease",display:"inline-block",transform:g?"rotate(90deg)":"rotate(0deg)"},children:d.arrowRight}),e.jsx("span",{style:{fontWeight:600,color:o.accent,fontSize:12,flex:1},children:l.engine}),e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${o.border}`,backgroundColor:o.backgroundSoft,color:o.foreground},children:l.backups.length})]}),g&&e.jsx("div",{style:{paddingLeft:24},children:l.backups.map((a,B)=>{const t=B===l.backups.length-1;return e.jsxs("div",{onClick:()=>p==null?void 0:p(a),style:{display:"flex",alignItems:"flex-start",padding:"10px 8px",marginLeft:8,marginBottom:2,borderLeft:`1px solid ${o.border}`,backgroundColor:"transparent",transition:"all 0.15s ease",cursor:"pointer"},onMouseEnter:c=>{c.currentTarget.style.backgroundColor=o.backgroundSoft,c.currentTarget.style.borderLeftColor=o.accent},onMouseLeave:c=>{c.currentTarget.style.backgroundColor="transparent",c.currentTarget.style.borderLeftColor=o.border},children:[b(1,t),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,flexWrap:"wrap"},children:[e.jsx("span",{style:{fontWeight:600,color:o.foreground,fontSize:11},children:a.backup_name}),e.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${D(a.status)}`,color:D(a.status),backgroundColor:"transparent"},children:a.status.toUpperCase()}),e.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${o.border}`,color:o.muted,backgroundColor:"transparent"},children:a.backup_type.toUpperCase()}),a.is_scheduled&&e.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${o.accent}`,color:o.accent,backgroundColor:"transparent"},children:"SCHEDULED"})]}),e.jsxs("div",{style:{fontSize:10,color:o.muted,marginBottom:4},children:["Database: ",a.database_name," | Size: ",m(a.file_size)]}),e.jsxs("div",{style:{fontSize:10,color:o.muted,marginBottom:4},children:["Created: ",new Date(a.created_at).toLocaleString(),a.next_run_at&&` | Next: ${new Date(a.next_run_at).toLocaleString()}`]}),a.cron_schedule&&e.jsxs("div",{style:{fontSize:10,color:o.muted},children:["Schedule: ",a.cron_schedule]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,marginLeft:8},children:[e.jsx(L,{label:"History",onClick:c=>{c.stopPropagation(),C==null||C(a.backup_id)},variant:"ghost",style:{fontSize:10,padding:"2px 6px"}}),a.cron_schedule&&e.jsx(L,{label:a.is_scheduled?"Disable":"Enable",onClick:c=>{c.stopPropagation(),$==null||$(a)},variant:"ghost",style:{fontSize:10,padding:"2px 6px"}}),a.status==="completed"&&e.jsx(L,{label:"Restore",onClick:c=>{c.stopPropagation(),j==null||j(a.backup_id)},variant:"ghost",style:{fontSize:10,padding:"2px 6px"}}),e.jsx(L,{label:"Delete",onClick:c=>{c.stopPropagation(),_==null||_(a.backup_id)},variant:"ghost",style:{fontSize:10,padding:"2px 6px"}})]})]},a.backup_id)})})]},l.engine)})})},ae=({history:y,backupName:C,backupId:$})=>{const[j,_]=u.useState(!0),p=i=>{switch(i){case"completed":return o.accent;case"failed":return o.foreground;case"in_progress":return o.muted;case"pending":return o.muted;default:return o.foreground}},A=i=>i?i<1024?`${i} B`:i<1024*1024?`${(i/1024).toFixed(2)} KB`:i<1024*1024*1024?`${(i/(1024*1024)).toFixed(2)} MB`:`${(i/(1024*1024*1024)).toFixed(2)} GB`:"N/A";return y.length===0?e.jsx("div",{style:{padding:r.spacing.lg,textAlign:"center",color:o.muted,fontFamily:"Consolas",fontSize:12},children:"No backup history available"}):e.jsxs("div",{style:{fontFamily:"Consolas",fontSize:12,color:o.foreground},children:[C&&e.jsxs("div",{onClick:()=>_(!j),style:{display:"flex",alignItems:"center",padding:"10px 8px",cursor:"pointer",borderLeft:`2px solid ${o.accent}`,backgroundColor:j?o.backgroundSoft:o.background,transition:"all 0.15s ease",marginBottom:2},onMouseEnter:i=>{i.currentTarget.style.backgroundColor=o.backgroundSoft},onMouseLeave:i=>{j||(i.currentTarget.style.backgroundColor=o.background)},children:[e.jsx("span",{style:{marginRight:8,color:j?o.accent:o.muted,fontSize:10,transition:"transform 0.15s ease",display:"inline-block",transform:j?"rotate(90deg)":"rotate(0deg)"},children:d.arrowRight}),e.jsx("span",{style:{fontWeight:600,color:o.accent,fontSize:12,flex:1},children:C}),e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${o.border}`,backgroundColor:o.backgroundSoft,color:o.foreground},children:y.length})]}),j&&e.jsx("div",{style:{paddingLeft:C?24:0},children:y.map((i,x)=>{const z=x===y.length-1;return e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",padding:"8px 8px",marginLeft:C?8:0,marginBottom:2,borderLeft:`1px solid ${o.border}`,backgroundColor:"transparent",transition:"all 0.15s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor=o.backgroundSoft,b.currentTarget.style.borderLeftColor=o.accent},onMouseLeave:b=>{b.currentTarget.style.backgroundColor="transparent",b.currentTarget.style.borderLeftColor=o.border},children:[C&&e.jsx("span",{style:{color:o.border,marginRight:6,fontFamily:"Consolas",fontSize:11},children:z?`${d.bl}${d.h}${d.h} `:`${d.tRight}${d.h}${d.h} `}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,flexWrap:"wrap"},children:[e.jsx("span",{style:{fontWeight:500,color:o.foreground,fontSize:11},children:new Date(i.started_at).toLocaleString()}),e.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${p(i.status)}`,color:p(i.status),backgroundColor:"transparent"},children:i.status.toUpperCase()}),i.duration_seconds&&e.jsxs("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${o.border}`,color:o.muted,backgroundColor:"transparent"},children:[i.duration_seconds,"s"]}),i.file_size&&e.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${o.border}`,color:o.muted,backgroundColor:"transparent"},children:A(i.file_size)}),i.triggered_by&&e.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${o.border}`,color:o.muted,backgroundColor:"transparent"},children:i.triggered_by.toUpperCase()})]}),i.error_message&&e.jsxs("div",{style:{fontSize:10,color:o.foreground,fontFamily:"Consolas",padding:"4px 8px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`,marginTop:4,wordBreak:"break-word"},children:["Error: ",i.error_message]})]})]},i.id||x)})})]})},pe=()=>{var U;const[y,C]=u.useState([]),[$,j]=u.useState(!0),[_,p]=u.useState(null),[A,i]=u.useState(!1),[x,z]=u.useState(null),[b,D]=u.useState({db_engine:"",status:""}),[m,l]=u.useState(1),[f,g]=u.useState(0),a=20,B=n=>{switch(n){case"PostgreSQL":return"postgresql://username:password@localhost:5432/database_name";case"MariaDB":return"mysql://username:password@localhost:3306/database_name";case"MongoDB":return"mongodb://username:password@localhost:27017/database_name?authSource=admin";case"Oracle":return"oracle://username:password@localhost:1521/XE";default:return""}},[t,c]=u.useState({backup_name:"",db_engine:"PostgreSQL",connection_string:B("PostgreSQL"),database_name:"",selected_databases:[],backup_type:"full",cron_schedule:"",is_scheduled:!1}),[O,R]=u.useState([]),[Q,M]=u.useState(!1),[W,I]=u.useState(null),[F,E]=u.useState([]),[P,T]=u.useState(!1),[N,H]=u.useState(!1);u.useEffect(()=>{if(t.db_engine){const n=B(t.db_engine),s=t.connection_string,h=[B("PostgreSQL"),B("MariaDB"),B("MongoDB"),B("Oracle")].includes(s);(!s||h)&&(c(v=>({...v,connection_string:n})),T(!1),E([]))}},[t.db_engine]);const S=u.useCallback(async()=>{const n=Date.now(),s=300;try{j(!0),p(null);const h={page:m,limit:a};b.db_engine&&(h.db_engine=b.db_engine),b.status&&(h.status=b.status);const v=await k.getAll(h),Z=Date.now()-n,ee=Math.max(0,s-Z);await new Promise(oe=>setTimeout(oe,ee)),C(v.backups||[]),g(v.total||0)}catch(h){p(w(h))}finally{j(!1)}},[m,b]);u.useEffect(()=>{S();const n=setInterval(S,5e3);return()=>clearInterval(n)},[S]);const Y=u.useCallback(async()=>{if(!t.connection_string){p("Please enter a connection string first");return}try{p(null),H(!0),await k.testConnection(t.db_engine,t.connection_string);const n=await k.discoverDatabases(t.db_engine,t.connection_string);E(n.databases||[]),T(!0)}catch(n){p(w(n)),E([]),T(!1)}finally{H(!1)}},[t.db_engine,t.connection_string]),G=u.useCallback(async()=>{try{p(null);const n=t.is_scheduled&&t.selected_databases.length>0?t.selected_databases:[t.database_name].filter(Boolean);if(n.length===0){p("Please select at least one database");return}for(const s of n){const h=t.is_scheduled?`${s}_${new Date().toISOString().replace(/[:.]/g,"-").slice(0,19)}`:t.backup_name||`${s}_backup`;await k.create({backup_name:h,db_engine:t.db_engine,connection_string:t.connection_string,database_name:s,backup_type:t.backup_type,cron_schedule:t.is_scheduled&&t.cron_schedule?t.cron_schedule:void 0})}i(!1),c({backup_name:"",db_engine:"PostgreSQL",connection_string:"",database_name:"",selected_databases:[],backup_type:"full",cron_schedule:"",is_scheduled:!1}),E([]),T(!1),S()}catch(n){p(w(n))}},[t,S]),K=u.useCallback(async n=>{try{p(null);const s=await k.getHistory(n);R(s.history||[]),I(n),M(!0)}catch(s){p(w(s))}},[]),q=u.useCallback(async n=>{try{p(null),n.is_scheduled?await k.disableSchedule(n.backup_id):await k.enableSchedule(n.backup_id),S()}catch(s){p(w(s))}},[S]),X=u.useCallback(async n=>{if(confirm("Are you sure you want to delete this backup?"))try{p(null),await k.delete(n),S()}catch(s){p(w(s))}},[S]),V=n=>{if(!n)return"N/A";const s=["B","KB","MB","GB","TB"];let h=n,v=0;for(;h>=1024&&v<s.length-1;)h/=1024,v++;return`${h.toFixed(2)} ${s[v]}`},J=n=>{switch(n){case"completed":return o.accent;case"failed":return o.foreground;case"in_progress":return o.muted;case"pending":return o.muted;default:return o.foreground}};return $&&y.length===0?e.jsx(re,{variant:"table"}):e.jsxs(ne,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:r.spacing.lg,paddingBottom:r.spacing.md,borderBottom:`2px solid ${o.accent}`},children:[e.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:0,color:o.foreground,fontFamily:"Consolas",textTransform:"uppercase"},children:[e.jsx("span",{style:{color:o.accent,marginRight:r.spacing.sm},children:d.blockFull}),"BACKUP MANAGER"]}),e.jsx(L,{label:"+ CREATE BACKUP",onClick:()=>i(!0),variant:"primary"})]}),_&&e.jsx("div",{style:{padding:r.spacing.sm,marginBottom:r.spacing.md,background:o.backgroundSoft,border:`1px solid ${o.border}`,borderRadius:2,color:o.foreground,fontSize:12,fontFamily:"Consolas"},children:_}),e.jsxs("div",{style:{display:"flex",gap:r.spacing.sm,marginBottom:r.spacing.md},children:[e.jsxs("select",{value:b.db_engine,onChange:n=>{D(s=>({...s,db_engine:n.target.value})),l(1)},style:{padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,background:o.background,color:o.foreground,fontFamily:"Consolas",fontSize:12,cursor:"pointer",outline:"none",transition:"border-color 0.15s ease"},onFocus:n=>{n.target.style.borderColor=o.accent,n.target.style.outline=`2px solid ${o.accent}`,n.target.style.outlineOffset="2px"},onBlur:n=>{n.target.style.borderColor=o.border,n.target.style.outline="none"},children:[e.jsx("option",{value:"",children:"All Engines"}),e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"MariaDB",children:"MariaDB"}),e.jsx("option",{value:"MSSQL",children:"MSSQL"}),e.jsx("option",{value:"MongoDB",children:"MongoDB"}),e.jsx("option",{value:"Oracle",children:"Oracle"}),e.jsx("option",{value:"DB2",children:"DB2"}),e.jsx("option",{value:"Salesforce",children:"Salesforce"}),e.jsx("option",{value:"SAP",children:"SAP"}),e.jsx("option",{value:"Teradata",children:"Teradata"}),e.jsx("option",{value:"Netezza",children:"Netezza"}),e.jsx("option",{value:"Hive",children:"Hive"}),e.jsx("option",{value:"Cassandra",children:"Cassandra"}),e.jsx("option",{value:"DynamoDB",children:"DynamoDB"}),e.jsx("option",{value:"AS400",children:"AS/400"}),e.jsx("option",{value:"S3",children:"S3"}),e.jsx("option",{value:"AzureBlob",children:"Azure Blob"}),e.jsx("option",{value:"GCS",children:"Google Cloud Storage"}),e.jsx("option",{value:"FTP",children:"FTP"}),e.jsx("option",{value:"SFTP",children:"SFTP"}),e.jsx("option",{value:"Email",children:"Email"}),e.jsx("option",{value:"SOAP",children:"SOAP"}),e.jsx("option",{value:"GraphQL",children:"GraphQL"}),e.jsx("option",{value:"Excel",children:"Excel"}),e.jsx("option",{value:"FixedWidth",children:"Fixed Width"}),e.jsx("option",{value:"EBCDIC",children:"EBCDIC"}),e.jsx("option",{value:"XML",children:"XML"}),e.jsx("option",{value:"Avro",children:"Avro"}),e.jsx("option",{value:"Parquet",children:"Parquet"}),e.jsx("option",{value:"ORC",children:"ORC"}),e.jsx("option",{value:"Compressed",children:"Compressed"})]}),e.jsxs("select",{value:b.status,onChange:n=>{D(s=>({...s,status:n.target.value})),l(1)},style:{padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,background:o.background,color:o.foreground,fontFamily:"Consolas",fontSize:12,cursor:"pointer",outline:"none",transition:"border-color 0.15s ease"},onFocus:n=>{n.target.style.borderColor=o.accent,n.target.style.outline=`2px solid ${o.accent}`,n.target.style.outlineOffset="2px"},onBlur:n=>{n.target.style.borderColor=o.border,n.target.style.outline="none"},children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),$?e.jsx("div",{style:{padding:40,textAlign:"center",color:o.muted,fontFamily:"Consolas",fontSize:12},children:"Loading backups..."}):y.length===0?e.jsx("div",{style:{padding:40,textAlign:"center",color:o.muted,fontFamily:"Consolas",fontSize:12},children:"No backups found"}):e.jsxs(e.Fragment,{children:[e.jsx(se,{backups:y,onViewHistory:K,onToggleSchedule:q,onRestore:n=>{confirm("Restore this backup?")&&k.restore(n).then(()=>{alert("Restore operation started")}).catch(s=>{p(w(s))})},onDelete:X,onSelect:z}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:r.spacing.md,paddingTop:r.spacing.md,borderTop:`1px solid ${o.border}`},children:[e.jsxs("div",{style:{color:o.muted,fontSize:11,fontFamily:"Consolas"},children:["Showing ",(m-1)*a+1," - ",Math.min(m*a,f)," of ",f]}),e.jsxs("div",{style:{display:"flex",gap:r.spacing.sm},children:[e.jsx("button",{onClick:()=>l(n=>Math.max(1,n-1)),disabled:m===1,style:{padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,background:m===1?o.backgroundSoft:o.background,color:m===1?o.muted:o.foreground,cursor:m===1?"not-allowed":"pointer",fontSize:11,fontFamily:"Consolas"},children:"Previous"}),e.jsx("button",{onClick:()=>l(n=>n+1),disabled:m*a>=f,style:{padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,background:m*a>=f?o.backgroundSoft:o.background,color:m*a>=f?o.muted:o.foreground,cursor:m*a>=f?"not-allowed":"pointer",fontSize:11,fontFamily:"Consolas"},children:"Next"})]})]})]}),A&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",zIndex:999},onClick:()=>i(!1)}),e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:o.background,padding:r.spacing.lg,borderRadius:2,border:`2px solid ${o.accent}`,zIndex:1e3,minWidth:500,maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",fontFamily:"Consolas"},onClick:n=>n.stopPropagation(),children:[e.jsx("style",{children:`
              div[style*="overflowY"]::-webkit-scrollbar {
                width: 0px;
                display: none;
              }
              div[style*="overflowY"] {
                -ms-overflow-style: none;
                scrollbar-width: none;
              }
            `}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:r.spacing.md,paddingBottom:r.spacing.sm,borderBottom:`2px solid ${o.border}`},children:[e.jsxs("h2",{style:{fontSize:14,fontWeight:600,color:o.accent,margin:0,fontFamily:"Consolas",textTransform:"uppercase"},children:[d.blockFull," CREATE BACKUP"]}),e.jsx("button",{onClick:()=>{i(!1),c({backup_name:"",db_engine:"PostgreSQL",connection_string:"",database_name:"",selected_databases:[],backup_type:"full",cron_schedule:"",is_scheduled:!1}),E([]),T(!1)},style:{background:"transparent",border:"none",color:o.foreground,fontSize:20,cursor:"pointer",padding:`0 ${r.spacing.sm}`,fontFamily:"Consolas"},children:"×"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.md},children:[!t.is_scheduled&&e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:o.foreground,marginBottom:r.spacing.xs,fontFamily:"Consolas",textTransform:"uppercase"},children:[d.v," BACKUP NAME *"]}),e.jsx("input",{type:"text",value:t.backup_name,onChange:n=>c(s=>({...s,backup_name:n.target.value})),placeholder:"my_backup_2024",style:{width:"100%",padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none",transition:"border-color 0.15s ease"},onFocus:n=>{n.target.style.borderColor=o.accent,n.target.style.outline=`2px solid ${o.accent}`,n.target.style.outlineOffset="2px"},onBlur:n=>{n.target.style.borderColor=o.border,n.target.style.outline="none"}})]}),t.is_scheduled&&e.jsxs("div",{style:{padding:r.spacing.sm,background:o.backgroundSoft,border:`1px solid ${o.accent}`,borderRadius:2,fontSize:11,color:o.muted,fontFamily:"Consolas"},children:[d.blockSemi," Backup name will be auto-generated as: database_name_YYYY-MM-DDTHH-MM-SS"]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:o.foreground,marginBottom:r.spacing.xs,fontFamily:"Consolas",textTransform:"uppercase"},children:[d.v," DB ENGINE *"]}),e.jsxs("select",{value:t.db_engine,onChange:n=>c(s=>({...s,db_engine:n.target.value})),style:{width:"100%",padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none",transition:"border-color 0.15s ease"},onFocus:n=>{n.target.style.borderColor=o.accent,n.target.style.outline=`2px solid ${o.accent}`,n.target.style.outlineOffset="2px"},onBlur:n=>{n.target.style.borderColor=o.border,n.target.style.outline="none"},children:[e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"MariaDB",children:"MariaDB"}),e.jsx("option",{value:"MSSQL",children:"MSSQL"}),e.jsx("option",{value:"MongoDB",children:"MongoDB"}),e.jsx("option",{value:"Oracle",children:"Oracle"}),e.jsx("option",{value:"DB2",children:"DB2"}),e.jsx("option",{value:"Salesforce",children:"Salesforce"}),e.jsx("option",{value:"SAP",children:"SAP"}),e.jsx("option",{value:"Teradata",children:"Teradata"}),e.jsx("option",{value:"Netezza",children:"Netezza"}),e.jsx("option",{value:"Hive",children:"Hive"}),e.jsx("option",{value:"Cassandra",children:"Cassandra"}),e.jsx("option",{value:"DynamoDB",children:"DynamoDB"}),e.jsx("option",{value:"AS400",children:"AS/400"}),e.jsx("option",{value:"S3",children:"S3"}),e.jsx("option",{value:"AzureBlob",children:"Azure Blob"}),e.jsx("option",{value:"GCS",children:"Google Cloud Storage"}),e.jsx("option",{value:"FTP",children:"FTP"}),e.jsx("option",{value:"SFTP",children:"SFTP"}),e.jsx("option",{value:"Email",children:"Email"}),e.jsx("option",{value:"SOAP",children:"SOAP"}),e.jsx("option",{value:"GraphQL",children:"GraphQL"}),e.jsx("option",{value:"Excel",children:"Excel"}),e.jsx("option",{value:"FixedWidth",children:"Fixed Width"}),e.jsx("option",{value:"EBCDIC",children:"EBCDIC"}),e.jsx("option",{value:"XML",children:"XML"}),e.jsx("option",{value:"Avro",children:"Avro"}),e.jsx("option",{value:"Parquet",children:"Parquet"}),e.jsx("option",{value:"ORC",children:"ORC"}),e.jsx("option",{value:"Compressed",children:"Compressed"})]})]}),e.jsxs("div",{children:[e.jsx(te,{value:t.connection_string,onChange:n=>{c(s=>({...s,connection_string:n})),T(!1),E([])},dbEngine:t.db_engine,label:"Connection String",required:!0,onTestConnection:Y,isTesting:N,testResult:P?{success:!0,message:`Connection successful! Found ${F.length} database(s)`}:null}),P&&F.length>0&&e.jsxs("div",{style:{marginTop:r.spacing.sm,padding:r.spacing.sm,background:o.accent+"20",border:`1px solid ${o.accent}`,borderRadius:2,fontSize:11,color:o.accent,fontFamily:"Consolas"},children:[d.blockSemi," Connection successful! Found ",F.length," database(s)"]})]}),P&&t.is_scheduled&&F.length>0?e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:o.foreground,marginBottom:r.spacing.xs,fontFamily:"Consolas",textTransform:"uppercase"},children:[d.v," SELECT DATABASES TO BACKUP *"]}),e.jsxs("div",{style:{maxHeight:200,overflowY:"auto",border:`1px solid ${o.border}`,borderRadius:2,padding:r.spacing.sm,background:o.background},children:[e.jsx("style",{children:`
                      div[style*="overflowY"]::-webkit-scrollbar {
                        width: 0px;
                        display: none;
                      }
                      div[style*="overflowY"] {
                        -ms-overflow-style: none;
                        scrollbar-width: none;
                      }
                    `}),F.map(n=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:r.spacing.sm,padding:`${r.spacing.xs} 0`,fontFamily:"Consolas",fontSize:12},children:[e.jsx("input",{type:"checkbox",checked:t.selected_databases.includes(n),onChange:s=>{s.target.checked?c(h=>({...h,selected_databases:[...h.selected_databases,n]})):c(h=>({...h,selected_databases:h.selected_databases.filter(v=>v!==n)}))},style:{cursor:"pointer"}}),e.jsx("span",{style:{color:o.foreground},children:n})]},n))]})]}):!t.is_scheduled&&e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:o.foreground,marginBottom:r.spacing.xs,fontFamily:"Consolas",textTransform:"uppercase"},children:[d.v," DATABASE NAME *"]}),P&&F.length>0?e.jsxs("select",{value:t.database_name,onChange:n=>c(s=>({...s,database_name:n.target.value})),style:{width:"100%",padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none",transition:"border-color 0.15s ease"},onFocus:n=>{n.target.style.borderColor=o.accent,n.target.style.outline=`2px solid ${o.accent}`,n.target.style.outlineOffset="2px"},onBlur:n=>{n.target.style.borderColor=o.border,n.target.style.outline="none"},children:[e.jsx("option",{value:"",children:"Select a database"}),F.map(n=>e.jsx("option",{value:n,children:n},n))]}):e.jsx("input",{type:"text",value:t.database_name,onChange:n=>c(s=>({...s,database_name:n.target.value})),placeholder:"mydatabase",style:{width:"100%",padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none",transition:"border-color 0.15s ease"},onFocus:n=>{n.target.style.borderColor=o.accent,n.target.style.outline=`2px solid ${o.accent}`,n.target.style.outlineOffset="2px"},onBlur:n=>{n.target.style.borderColor=o.border,n.target.style.outline="none"}})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:o.foreground,marginBottom:r.spacing.xs,fontFamily:"Consolas",textTransform:"uppercase"},children:[d.v," BACKUP TYPE *"]}),e.jsxs("select",{value:t.backup_type,onChange:n=>c(s=>({...s,backup_type:n.target.value})),style:{width:"100%",padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none",transition:"border-color 0.15s ease"},onFocus:n=>{n.target.style.borderColor=o.accent,n.target.style.outline=`2px solid ${o.accent}`,n.target.style.outlineOffset="2px"},onBlur:n=>{n.target.style.borderColor=o.border,n.target.style.outline="none"},children:[e.jsx("option",{value:"full",children:"Full (Structure + Data)"}),e.jsx("option",{value:"structure",children:"Structure Only"}),e.jsx("option",{value:"data",children:"Data Only"}),e.jsx("option",{value:"config",children:"Config Only"})]})]}),e.jsxs("div",{style:{padding:r.spacing.sm,background:o.backgroundSoft,border:`1px solid ${o.border}`,borderRadius:2},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:r.spacing.sm,marginBottom:r.spacing.sm},children:[e.jsx("input",{type:"checkbox",checked:t.is_scheduled,onChange:n=>c(s=>({...s,is_scheduled:n.target.checked})),style:{cursor:"pointer"}}),e.jsxs("label",{style:{fontSize:12,fontWeight:600,color:o.foreground,fontFamily:"Consolas",textTransform:"uppercase",cursor:"pointer"},children:[d.v," ENABLE SCHEDULED BACKUP"]})]}),t.is_scheduled&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,fontWeight:600,color:o.muted,marginBottom:r.spacing.xs,fontFamily:"Consolas"},children:"CRON SCHEDULE (minute hour day month dow)"}),e.jsx("input",{type:"text",value:t.cron_schedule,onChange:n=>c(s=>({...s,cron_schedule:n.target.value})),placeholder:"0 2 * * *",style:{width:"100%",padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none",transition:"border-color 0.15s ease"},onFocus:n=>{n.target.style.borderColor=o.accent,n.target.style.outline=`2px solid ${o.accent}`,n.target.style.outlineOffset="2px"},onBlur:n=>{n.target.style.borderColor=o.border,n.target.style.outline="none"}}),e.jsx("div",{style:{marginTop:r.spacing.sm,fontSize:10,color:o.muted,fontFamily:"Consolas",fontStyle:"italic"},children:'Examples: "0 2 * * *" (daily at 2 AM), "0 */6 * * *" (every 6 hours), "0 0 * * 0" (weekly on Sunday)'})]})]}),e.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:8,paddingTop:16,borderTop:`1px solid ${o.border}`},children:[e.jsx("button",{onClick:()=>i(!1),style:{padding:"8px 16px",border:`1px solid ${o.border}`,borderRadius:2,background:o.backgroundSoft,color:o.foreground,cursor:"pointer",fontSize:12,fontFamily:"Consolas",fontWeight:600},children:"CANCEL"}),e.jsx("button",{onClick:G,disabled:!t.connection_string||(t.is_scheduled?t.selected_databases.length===0:!t.database_name)||!t.is_scheduled&&!t.backup_name,style:{padding:"8px 16px",border:`1px solid ${o.accent}`,borderRadius:2,background:!t.connection_string||(t.is_scheduled?t.selected_databases.length===0:!t.database_name)||!t.is_scheduled&&!t.backup_name?o.backgroundSoft:o.accent,color:!t.connection_string||(t.is_scheduled?t.selected_databases.length===0:!t.database_name)||!t.is_scheduled&&!t.backup_name?o.muted:o.background,cursor:!t.connection_string||(t.is_scheduled?t.selected_databases.length===0:!t.database_name)||!t.is_scheduled&&!t.backup_name?"not-allowed":"pointer",fontSize:12,fontFamily:"Consolas",fontWeight:600},children:"CREATE"})]})]})]})]}),x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",zIndex:999},onClick:()=>z(null)}),e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:o.background,padding:24,borderRadius:2,border:`2px solid ${o.accent}`,zIndex:1e3,minWidth:600,maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",fontFamily:"Consolas"},onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20,paddingBottom:12,borderBottom:`2px solid ${o.border}`},children:[e.jsxs("h2",{style:{fontSize:14,fontWeight:600,color:o.accent,margin:0,fontFamily:"Consolas",textTransform:"uppercase"},children:[d.blockFull," BACKUP DETAILS"]}),e.jsx("button",{onClick:()=>z(null),style:{background:"transparent",border:"none",color:o.foreground,fontSize:20,cursor:"pointer",padding:"0 8px"},children:"×"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12,fontSize:12},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",x.backup_name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Engine:"})," ",x.db_engine]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Database:"})," ",x.database_name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Type:"})," ",x.backup_type.toUpperCase()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx("span",{style:{color:J(x.status)},children:x.status.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Size:"})," ",V(x.file_size)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"File Path:"})," ",x.file_path]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Created:"})," ",new Date(x.created_at).toLocaleString()]}),x.completed_at&&e.jsxs("div",{children:[e.jsx("strong",{children:"Completed:"})," ",new Date(x.completed_at).toLocaleString()]}),x.created_by&&e.jsxs("div",{children:[e.jsx("strong",{children:"Created By:"})," ",x.created_by]}),x.error_message&&e.jsxs("div",{style:{color:o.foreground},children:[e.jsx("strong",{children:"Error:"})," ",x.error_message]})]})]})]}),Q&&W&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",zIndex:999},onClick:()=>{M(!1),I(null),R([])}}),e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:o.background,padding:24,borderRadius:2,border:`2px solid ${o.accent}`,zIndex:1e3,minWidth:800,maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",fontFamily:"Consolas"},onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20,paddingBottom:12,borderBottom:`2px solid ${o.border}`},children:[e.jsxs("h2",{style:{fontSize:14,fontWeight:600,color:o.accent,margin:0,fontFamily:"Consolas",textTransform:"uppercase"},children:[d.blockFull," BACKUP EXECUTION HISTORY"]}),e.jsx("button",{onClick:()=>{M(!1),I(null),R([])},style:{background:"transparent",border:"none",color:o.foreground,fontSize:20,cursor:"pointer",padding:"0 8px"},children:"×"})]}),O.length===0?e.jsx("div",{style:{padding:40,textAlign:"center",color:o.muted,fontFamily:"Consolas",fontSize:12},children:"No execution history found"}):e.jsx(ae,{history:O,backupName:(U=y.find(n=>n.backup_id===W))==null?void 0:U.backup_name,backupId:W||void 0})]})]})]})};export{pe as default};
