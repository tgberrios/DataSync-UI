import{r as u,j as o,t as n,b as e,e as b,f as W,ae as M,C as K}from"./index-f6ac47b8.js";import{S as J}from"./SkeletonLoader-792007e7.js";import{e as Y}from"./errorHandler-5ea9ae85.js";import{A as E}from"./AsciiPanel-5614714e.js";import{A as R}from"./AsciiButton-4907e65e.js";const X=({logs:x,onViewDetails:w})=>{const[B,L]=u.useState(new Set),[$,z]=u.useState(new Set),[P,v]=u.useState(new Set),T=u.useMemo(()=>{const s=new Map;return x.forEach(r=>{const i=r.created_at?new Date(r.created_at).toLocaleDateString():"Unknown",d=r.username||"Unknown",a=r.action_type||"Unknown";s.has(i)||s.set(i,{date:i,users:new Map});const c=s.get(i);c.users.has(d)||c.users.set(d,{username:d,actions:new Map});const p=c.users.get(d);p.actions.has(a)||p.actions.set(a,{actionType:a,logs:[]}),p.actions.get(a).logs.push(r)}),Array.from(s.values()).sort((r,i)=>new Date(i.date).getTime()-new Date(r.date).getTime())},[x]),l=s=>{L(r=>{const i=new Set(r);if(i.has(s)){i.delete(s);const d=T.find(a=>a.date===s);d&&d.users.forEach(a=>{const c=`${s}.${a.username}`;z(p=>{const g=new Set(p);return g.delete(c),g}),a.actions.forEach(p=>{const g=`${s}.${a.username}.${p.actionType}`;v(C=>{const j=new Set(C);return j.delete(g),j})})})}else i.add(s);return i})},S=(s,r)=>{const i=`${s}.${r}`;z(d=>{const a=new Set(d);if(a.has(i)){a.delete(i);const c=T.find(p=>p.date===s);if(c){const p=c.users.get(r);p&&p.actions.forEach(g=>{const C=`${s}.${r}.${g.actionType}`;v(j=>{const m=new Set(j);return m.delete(C),m})})}}else a.add(i);return a})},A=(s,r,i)=>{const d=`${s}.${r}.${i}`;v(a=>{const c=new Set(a);return c.has(d)?c.delete(d):c.add(d),c})},D=(s,r)=>{if(s===0)return null;const i=[];for(let d=0;d<s-1;d++)i.push(`${b.v}  `);return r?i.push(`${b.bl}${b.h}${b.h} `):i.push(`${b.tRight}${b.h}${b.h} `),o.jsx("span",{style:{color:e.border,marginRight:6,fontFamily:"Consolas",fontSize:11},children:i.join("")})},I=s=>{switch(s.toUpperCase()){case"SELECT":return e.accent;case"INSERT":return e.accent;case"UPDATE":return e.muted;case"DELETE":return e.foreground;default:return e.muted}},O=s=>s?new Date(s).toLocaleString():"-";return x.length===0?o.jsx("div",{style:{padding:n.spacing.lg,textAlign:"center",color:e.muted,fontFamily:"Consolas",fontSize:12},children:"No audit logs found."}):o.jsx("div",{style:{fontFamily:"Consolas",fontSize:12,color:e.foreground},children:T.map((s,r)=>{const i=B.has(s.date),d=Array.from(s.users.values());return T.length-1,o.jsxs("div",{style:{marginBottom:4},children:[o.jsxs("div",{onClick:()=>l(s.date),style:{display:"flex",alignItems:"center",padding:"10px 8px",cursor:"pointer",borderLeft:`2px solid ${e.accent}`,backgroundColor:i?e.backgroundSoft:e.background,transition:"all 0.15s ease",marginBottom:2},onMouseEnter:a=>{a.currentTarget.style.backgroundColor=e.backgroundSoft},onMouseLeave:a=>{i||(a.currentTarget.style.backgroundColor=e.background)},children:[o.jsx("span",{style:{marginRight:8,color:i?e.accent:e.muted,fontSize:10,transition:"transform 0.15s ease",display:"inline-block",transform:i?"rotate(90deg)":"rotate(0deg)"},children:b.arrowRight}),o.jsx("span",{style:{fontWeight:600,color:e.accent,fontSize:12,flex:1},children:s.date}),o.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${e.border}`,backgroundColor:e.backgroundSoft,color:e.foreground},children:d.reduce((a,c)=>a+Array.from(c.actions.values()).reduce((p,g)=>p+g.logs.length,0),0)})]}),i&&o.jsx("div",{style:{paddingLeft:24},children:d.map((a,c)=>{const p=`${s.date}.${a.username}`,g=$.has(p),C=Array.from(a.actions.values()),j=c===d.length-1;return o.jsxs("div",{children:[o.jsxs("div",{onClick:()=>S(s.date,a.username),style:{display:"flex",alignItems:"center",padding:"8px 8px",marginLeft:8,marginBottom:2,borderLeft:`2px solid ${e.border}`,backgroundColor:g?e.backgroundSoft:"transparent",transition:"all 0.15s ease",cursor:"pointer"},onMouseEnter:m=>{m.currentTarget.style.backgroundColor=e.backgroundSoft,m.currentTarget.style.borderLeftColor=e.accent},onMouseLeave:m=>{g||(m.currentTarget.style.backgroundColor="transparent",m.currentTarget.style.borderLeftColor=e.border)},children:[D(1,j),o.jsx("span",{style:{marginRight:8,color:g?e.accent:e.muted,fontSize:10,transition:"transform 0.15s ease",display:"inline-block",transform:g?"rotate(90deg)":"rotate(0deg)"},children:b.arrowRight}),o.jsx("span",{style:{fontWeight:600,color:e.foreground,fontSize:11,flex:1,fontFamily:"Consolas"},children:a.username}),o.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${e.border}`,backgroundColor:"transparent",color:e.muted},children:C.reduce((m,_)=>m+_.logs.length,0)})]}),g&&o.jsx("div",{style:{paddingLeft:24},children:C.map((m,_)=>{const F=`${s.date}.${a.username}.${m.actionType}`,k=P.has(F),U=_===C.length-1;return o.jsxs("div",{children:[o.jsxs("div",{onClick:()=>A(s.date,a.username,m.actionType),style:{display:"flex",alignItems:"center",padding:"6px 8px",marginLeft:8,marginBottom:2,borderLeft:`1px solid ${e.border}`,backgroundColor:k?e.backgroundSoft:"transparent",transition:"all 0.15s ease",cursor:"pointer"},onMouseEnter:f=>{f.currentTarget.style.backgroundColor=e.backgroundSoft,f.currentTarget.style.borderLeftColor=e.accent},onMouseLeave:f=>{k||(f.currentTarget.style.backgroundColor="transparent",f.currentTarget.style.borderLeftColor=e.border)},children:[D(2,U),o.jsx("span",{style:{marginRight:8,color:k?e.accent:e.muted,fontSize:10,transition:"transform 0.15s ease",display:"inline-block",transform:k?"rotate(90deg)":"rotate(0deg)"},children:b.arrowRight}),o.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${I(m.actionType)}`,color:I(m.actionType),backgroundColor:"transparent"},children:m.actionType}),o.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${e.border}`,backgroundColor:"transparent",color:e.muted,marginLeft:8},children:m.logs.length})]}),k&&o.jsx("div",{style:{paddingLeft:24},children:m.logs.map((f,t)=>{const h=t===m.logs.length-1;return o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",padding:"8px 8px",marginLeft:8,marginBottom:2,borderLeft:`1px solid ${e.border}`,backgroundColor:"transparent",transition:"all 0.15s ease"},onMouseEnter:y=>{y.currentTarget.style.backgroundColor=e.backgroundSoft,y.currentTarget.style.borderLeftColor=e.accent},onMouseLeave:y=>{y.currentTarget.style.backgroundColor="transparent",y.currentTarget.style.borderLeftColor=e.border},children:[D(3,h),o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[o.jsx("span",{style:{fontWeight:500,color:e.foreground,fontSize:11},children:f.schema_name&&f.table_name?`${f.schema_name}.${f.table_name}`:"N/A"}),o.jsxs("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${e.border}`,backgroundColor:"transparent",color:e.muted},children:[f.rows_affected||0," rows"]}),f.compliance_requirement&&o.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${e.border}`,backgroundColor:"transparent",color:e.muted},children:f.compliance_requirement})]}),o.jsx("div",{style:{fontSize:10,color:e.muted},children:O(f.created_at)})]}),o.jsx(R,{label:"View",onClick:y=>{y.stopPropagation(),w==null||w(f)},variant:"ghost",style:{fontSize:10,padding:"2px 6px",marginLeft:8}})]},f.log_id||t)})})]},F)})})]},p)})})]},s.date)})})};W.table`
  width: 100%;
  border-collapse: collapse;
  margin-top: ${n.spacing.lg};
  background: ${e.background};
  border-radius: 2;
  overflow: hidden;
  font-family: 'Consolas';
`;W.th`
  padding: ${n.spacing.sm};
  text-align: left;
  border-bottom: 2px solid ${e.border};
  background: ${e.backgroundSoft};
  font-weight: 600;
  font-family: 'Consolas';
  font-size: 13px;
  color: ${e.accent};
  position: sticky;
  top: 0;
  z-index: 10;
`;W.td`
  padding: ${n.spacing.sm};
  border-bottom: 1px solid ${e.border};
  font-family: 'Consolas';
  font-size: 12px;
  transition: background-color 0.15s ease;
  word-break: break-word;
  max-width: 300px;
`;W.tr`
  transition: background-color 0.15s ease;
`;const Q=x=>{switch(x.toUpperCase()){case"SELECT":return e.accent;case"INSERT":return e.accent;case"UPDATE":return e.muted;case"DELETE":return e.foreground;default:return e.muted}},V=x=>x?new Date(x).toLocaleString():"-",re=()=>{var F,k,U,f;const x=u.useRef(!0),[w,B]=u.useState(!0),[L,$]=u.useState(null),[z,P]=u.useState([]),[v,T]=u.useState(null),[l,S]=u.useState({schema_name:"",table_name:"",username:"",action_type:"",start_date:"",end_date:""}),[A,D]=u.useState(1),[I,O]=u.useState(0),s=100,[r,i]=u.useState(null),[d,a]=u.useState(!1),[c,p]=u.useState("GDPR"),[g,C]=u.useState(null),j=u.useCallback(async()=>{if(!x.current)return;const t=Date.now(),h=300;try{B(!0),$(null);const y={page:A,limit:s};l.schema_name&&(y.schema_name=l.schema_name),l.table_name&&(y.table_name=l.table_name),l.username&&(y.username=l.username),l.action_type&&(y.action_type=l.action_type),l.start_date&&(y.start_date=l.start_date),l.end_date&&(y.end_date=l.end_date);const q=await M.getLogs(y),N=Date.now()-t,H=Math.max(0,h-N);await new Promise(G=>setTimeout(G,H)),x.current&&(P(q.logs||[]),O(q.total||0))}catch(y){x.current&&$(Y(y))}finally{x.current&&B(!1)}},[A,l]),m=u.useCallback(async()=>{try{const t=await M.getStats(30);T(t)}catch(t){console.error("Error fetching audit stats:",t)}},[]);u.useEffect(()=>(x.current=!0,j(),m(),()=>{x.current=!1}),[j,m]);const _=u.useCallback(async()=>{try{$(null);const t=await M.getComplianceReport(c,l.start_date||void 0,l.end_date||void 0);C(t.report)}catch(t){x.current&&$(Y(t))}},[c,l.start_date,l.end_date]);return w&&z.length===0?o.jsx(J,{variant:"table"}):o.jsxs(K,{children:[o.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:n.spacing.lg,paddingBottom:n.spacing.md,borderBottom:`2px solid ${e.accent}`},children:o.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:0,color:e.foreground,textTransform:"uppercase",fontFamily:"Consolas"},children:[o.jsx("span",{style:{color:e.accent,marginRight:n.spacing.sm},children:b.blockFull}),"AUDIT TRAIL"]})}),L&&o.jsx("div",{style:{marginBottom:n.spacing.md},children:o.jsx(E,{title:"ERROR",children:o.jsx("div",{style:{padding:n.spacing.sm,color:e.foreground,fontSize:12,fontFamily:"Consolas",backgroundColor:e.backgroundSoft,borderRadius:2},children:L})})}),v&&o.jsx("div",{style:{marginBottom:n.spacing.md},children:o.jsx(E,{title:"AUDIT STATISTICS (Last 30 Days)",children:o.jsx("div",{style:{padding:n.spacing.md,fontFamily:"Consolas",fontSize:12},children:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:n.spacing.md},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Total Events"}),o.jsx("div",{style:{fontSize:16,fontWeight:600,color:e.accent,fontFamily:"Consolas"},children:((F=v.summary)==null?void 0:F.total_events)||0})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Unique Users"}),o.jsx("div",{style:{fontSize:16,fontWeight:600,color:e.accent,fontFamily:"Consolas"},children:((k=v.summary)==null?void 0:k.unique_users)||0})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Unique Tables"}),o.jsx("div",{style:{fontSize:16,fontWeight:600,color:e.accent,fontFamily:"Consolas"},children:((U=v.summary)==null?void 0:U.unique_tables)||0})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Compliance Events"}),o.jsx("div",{style:{fontSize:16,fontWeight:600,color:e.muted,fontFamily:"Consolas"},children:((f=v.summary)==null?void 0:f.compliance_events)||0})]})]})})})}),o.jsx("div",{style:{marginBottom:n.spacing.md},children:o.jsx(E,{title:"AUDIT TRAIL",children:o.jsxs("div",{style:{padding:n.spacing.md,fontFamily:"Consolas",fontSize:12},children:[o.jsx("div",{style:{display:"flex",gap:n.spacing.sm,marginBottom:n.spacing.md,flexWrap:"wrap"},children:o.jsx(R,{label:`${b.blockFull} Compliance Report`,onClick:()=>a(!0),variant:"ghost"})}),o.jsxs("div",{style:{marginBottom:n.spacing.md,display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:n.spacing.sm},children:[o.jsx("input",{type:"text",placeholder:"Schema name",value:l.schema_name,onChange:t=>S(h=>({...h,schema_name:t.target.value})),style:{padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}}),o.jsx("input",{type:"text",placeholder:"Table name",value:l.table_name,onChange:t=>S(h=>({...h,table_name:t.target.value})),style:{padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}}),o.jsx("input",{type:"text",placeholder:"Username",value:l.username,onChange:t=>S(h=>({...h,username:t.target.value})),style:{padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}}),o.jsxs("select",{value:l.action_type,onChange:t=>S(h=>({...h,action_type:t.target.value})),style:{padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease",cursor:"pointer"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"},children:[o.jsx("option",{value:"",children:"All Actions"}),o.jsx("option",{value:"SELECT",children:"SELECT"}),o.jsx("option",{value:"INSERT",children:"INSERT"}),o.jsx("option",{value:"UPDATE",children:"UPDATE"}),o.jsx("option",{value:"DELETE",children:"DELETE"}),o.jsx("option",{value:"CREATE",children:"CREATE"}),o.jsx("option",{value:"DROP",children:"DROP"}),o.jsx("option",{value:"ALTER",children:"ALTER"})]}),o.jsx("input",{type:"date",placeholder:"Start Date",value:l.start_date,onChange:t=>S(h=>({...h,start_date:t.target.value})),style:{padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}}),o.jsx("input",{type:"date",placeholder:"End Date",value:l.end_date,onChange:t=>S(h=>({...h,end_date:t.target.value})),style:{padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}})]}),o.jsxs("div",{style:{marginBottom:n.spacing.sm,fontSize:11,color:e.muted,fontFamily:"Consolas"},children:["Audit Logs (",I,")"]}),o.jsx(X,{logs:z,onViewDetails:i})]})})}),r&&o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:20},onClick:t=>{t.target===t.currentTarget&&i(null)},children:o.jsxs("div",{style:{backgroundColor:e.background,border:`2px solid ${e.border}`,borderRadius:2,width:"90%",maxWidth:800,maxHeight:"90vh",overflowY:"auto"},onClick:t=>t.stopPropagation(),children:[o.jsx("style",{children:`
              div[style*="overflowY"]::-webkit-scrollbar {
                width: 0px;
                display: none;
              }
              div[style*="overflowY"] {
                -ms-overflow-style: none;
                scrollbar-width: none;
              }
            `}),o.jsx(E,{title:"AUDIT LOG DETAILS",children:o.jsxs("div",{style:{padding:n.spacing.md,fontFamily:"Consolas",fontSize:12},children:[o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Log ID"}),o.jsx("div",{style:{color:e.foreground,fontSize:12,fontFamily:"Consolas"},children:r.log_id})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Timestamp"}),o.jsx("div",{style:{color:e.foreground,fontSize:12,fontFamily:"Consolas"},children:V(r.created_at)})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"User"}),o.jsx("div",{style:{color:e.accent,fontSize:12,fontFamily:"Consolas"},children:r.username})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Action Type"}),o.jsx("div",{style:{color:Q(r.action_type),fontSize:12,fontWeight:600,fontFamily:"Consolas"},children:r.action_type})]}),r.schema_name&&o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Schema.Table.Column"}),o.jsx("div",{style:{color:e.foreground,fontSize:12,fontFamily:"Consolas"},children:o.jsxs("code",{children:[r.schema_name,".",r.table_name,r.column_name&&`.${r.column_name}`]})})]}),r.query_text&&o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Query Text"}),o.jsx("div",{style:{padding:`${n.spacing.sm} ${n.spacing.md}`,backgroundColor:e.backgroundSoft,borderRadius:2,border:`1px solid ${e.border}`,fontSize:11,fontFamily:"Consolas",color:e.foreground,wordBreak:"break-word",whiteSpace:"pre-wrap",maxHeight:200,overflowY:"auto"},children:r.query_text})]}),r.old_values&&o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Old Values"}),o.jsxs("div",{style:{padding:`${n.spacing.sm} ${n.spacing.md}`,backgroundColor:e.backgroundSoft,borderRadius:2,border:`1px solid ${e.border}`,fontSize:11,fontFamily:"Consolas",color:e.foreground,wordBreak:"break-word",whiteSpace:"pre-wrap",maxHeight:200,overflowY:"auto"},children:[o.jsx("style",{children:`
                        div[style*="overflowY"]::-webkit-scrollbar {
                          width: 0px;
                          display: none;
                        }
                        div[style*="overflowY"] {
                          -ms-overflow-style: none;
                          scrollbar-width: none;
                        }
                      `}),JSON.stringify(r.old_values,null,2)]})]}),r.new_values&&o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"New Values"}),o.jsx("div",{style:{padding:`${n.spacing.sm} ${n.spacing.md}`,backgroundColor:e.backgroundSoft,borderRadius:2,border:`1px solid ${e.border}`,fontSize:11,fontFamily:"Consolas",color:e.foreground,wordBreak:"break-word",whiteSpace:"pre-wrap",maxHeight:200,overflowY:"auto"},children:JSON.stringify(r.new_values,null,2)})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Rows Affected"}),o.jsx("div",{style:{color:e.foreground,fontSize:12,fontFamily:"Consolas"},children:r.rows_affected||0})]}),r.compliance_requirement&&o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Compliance Requirement"}),o.jsx("div",{style:{color:e.muted,fontSize:12,fontWeight:600,fontFamily:"Consolas"},children:r.compliance_requirement})]}),o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:n.spacing.lg},children:o.jsx(R,{label:"Close",onClick:()=>i(null),variant:"ghost"})})]})})]})}),d&&o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:20},onClick:t=>{t.target===t.currentTarget&&a(!1)},children:o.jsxs("div",{style:{backgroundColor:e.background,border:`2px solid ${e.border}`,borderRadius:2,width:"90%",maxWidth:600,maxHeight:"90vh",overflowY:"auto"},onClick:t=>t.stopPropagation(),children:[o.jsx("style",{children:`
              div[style*="overflowY"]::-webkit-scrollbar {
                width: 0px;
                display: none;
              }
              div[style*="overflowY"] {
                -ms-overflow-style: none;
                scrollbar-width: none;
              }
            `}),o.jsx(E,{title:"COMPLIANCE REPORT",children:o.jsxs("div",{style:{padding:n.spacing.md,fontFamily:"Consolas",fontSize:12},children:[o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("label",{style:{display:"block",marginBottom:n.spacing.xs,color:e.muted,fontSize:11,fontFamily:"Consolas"},children:"Compliance Type *"}),o.jsxs("select",{value:c,onChange:t=>p(t.target.value),style:{width:"100%",padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease",cursor:"pointer"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"},children:[o.jsx("option",{value:"GDPR",children:"GDPR"}),o.jsx("option",{value:"HIPAA",children:"HIPAA"}),o.jsx("option",{value:"SOX",children:"SOX"}),o.jsx("option",{value:"PCI-DSS",children:"PCI-DSS"})]})]}),o.jsx("div",{style:{marginBottom:n.spacing.md},children:o.jsx(R,{label:"Generate Report",onClick:_})}),g&&o.jsxs("div",{style:{marginTop:n.spacing.lg,padding:n.spacing.md,backgroundColor:e.backgroundSoft,borderRadius:2,border:`1px solid ${e.border}`},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:600,color:e.accent,marginBottom:n.spacing.sm,fontFamily:"Consolas"},children:[b.blockFull," COMPLIANCE REPORT: ",c]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:n.spacing.md},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Total Events"}),o.jsx("div",{style:{fontSize:16,fontWeight:600,color:e.accent,fontFamily:"Consolas"},children:g.total_events||0})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Unique Users"}),o.jsx("div",{style:{fontSize:16,fontWeight:600,color:e.accent,fontFamily:"Consolas"},children:g.unique_users||0})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Unique Tables"}),o.jsx("div",{style:{fontSize:16,fontWeight:600,color:e.accent,fontFamily:"Consolas"},children:g.unique_tables||0})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Sensitive Access"}),o.jsx("div",{style:{fontSize:16,fontWeight:600,color:e.muted,fontFamily:"Consolas"},children:g.sensitive_access_count||0})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Modifications"}),o.jsx("div",{style:{fontSize:16,fontWeight:600,color:e.foreground,fontFamily:"Consolas"},children:g.modification_count||0})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:e.muted,marginBottom:n.spacing.xs,fontFamily:"Consolas"},children:"Access Count"}),o.jsx("div",{style:{fontSize:16,fontWeight:600,color:e.accent,fontFamily:"Consolas"},children:g.access_count||0})]})]})]}),o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:n.spacing.lg},children:o.jsx(R,{label:"Close",onClick:()=>{a(!1),C(null)},variant:"ghost"})})]})})]})})]})};export{re as default};
