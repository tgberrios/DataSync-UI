import{r,aj as h,j as t,C as d,t as n,b as s,e as x}from"./index-f6ac47b8.js";import{e as b}from"./errorHandler-5ea9ae85.js";import{A as j}from"./AsciiPanel-5614714e.js";import{S}from"./SkeletonLoader-792007e7.js";const E=()=>{const[u,g]=r.useState([]),[f,p]=r.useState(!0),[o,c]=r.useState(null),[a,m]=r.useState(null),i=r.useRef(!0),l=r.useCallback(async()=>{if(i.current)try{c(null);const e=await h.getAudit();i.current&&g(e)}catch(e){i.current&&c(b(e))}finally{i.current&&p(!1)}},[]);return r.useEffect(()=>(i.current=!0,l(),()=>{i.current=!1}),[l]),f?t.jsx(d,{children:t.jsx(S,{})}):t.jsx(d,{children:t.jsxs("div",{style:{padding:n.spacing.lg,fontFamily:"Consolas",fontSize:12,background:s.background},children:[t.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:`0 0 ${n.spacing.md} 0`,color:s.foreground},children:[x.blockFull," SCHEMA CHANGE AUDITOR"]}),o&&t.jsxs("div",{style:{padding:n.spacing.sm,background:s.foreground+"20",border:`1px solid ${s.foreground}`,marginBottom:n.spacing.md,color:s.foreground},children:["Error: ",o]}),t.jsx(j,{title:"SCHEMA CHANGES",children:t.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:u.map(e=>t.jsxs("div",{onClick:()=>m(e),style:{padding:n.spacing.sm,border:`1px solid ${s.border}`,marginBottom:n.spacing.xs,cursor:"pointer",background:(a==null?void 0:a.id)===e.id?s.accent+"20":"transparent"},children:[t.jsxs("div",{style:{fontWeight:600,color:s.foreground},children:[e.change_type," ",e.object_type,": ",e.object_name]}),t.jsxs("div",{style:{color:s.muted,fontSize:11,marginTop:n.spacing.xs},children:[e.db_engine," | ",e.schema_name," | ",new Date(e.detected_at).toLocaleString()]}),e.is_rollback_possible&&t.jsx("div",{style:{color:s.accent,fontSize:10,marginTop:n.spacing.xs},children:"Rollback available"})]},e.id))})})]})})};export{E as default};
