import{r,i as c,j as e,t as a,b as o}from"./index-f6ac47b8.js";import{A as z}from"./AsciiPanel-5614714e.js";import{A as g}from"./AsciiButton-4907e65e.js";import{e as f}from"./errorHandler-5ea9ae85.js";import{S as E}from"./SkeletonLoader-792007e7.js";const B=()=>{const[p,y]=r.useState([]),[j,C]=r.useState({}),[v,m]=r.useState(!0),[x,l]=r.useState(null),[k,u]=r.useState(!1),[t,i]=r.useState({config_id:"",type:"elasticsearch",enabled:!0,batch_size:1e3,batch_interval_seconds:60}),d=r.useCallback(async()=>{try{m(!0),l(null);const[n,s]=await Promise.all([c.getLogAggregationConfig().catch(()=>[]),c.getLogAggregationStatus().catch(()=>[])]);y(n||[]);const b={};(s||[]).forEach(h=>{b[h.config_id]=h}),C(b)}catch(n){l(f(n))}finally{m(!1)}},[]),S=r.useCallback(async()=>{try{if(!t.config_id||!t.type){l("Config ID and type are required");return}await c.setLogAggregationConfig(t),u(!1),i({config_id:"",type:"elasticsearch",enabled:!0,batch_size:1e3,batch_interval_seconds:60}),d()}catch(n){l(f(n))}},[t,d]),_=r.useCallback(async n=>{try{await c.exportLogs({config_id:n,limit:1e3}),d()}catch(s){l(f(s))}},[d]);return r.useEffect(()=>{d()},[d]),v&&p.length===0?e.jsx(E,{}):e.jsx("div",{style:{padding:a.spacing.lg},children:e.jsx(z,{children:e.jsxs("div",{style:{marginBottom:a.spacing.lg},children:[e.jsx("h1",{style:{fontSize:18,fontWeight:600,color:o.foreground,marginBottom:a.spacing.md},children:"Log Aggregation Configuration"}),e.jsx("p",{style:{color:o.muted,fontSize:12,marginBottom:a.spacing.lg},children:"Configure log export to Elasticsearch or Splunk"}),e.jsx("div",{style:{marginBottom:a.spacing.lg},children:e.jsx(g,{label:"Add Configuration",onClick:()=>u(!0)})}),x&&e.jsx("div",{style:{padding:a.spacing.md,background:o.error,color:"#ffffff",marginBottom:a.spacing.md,borderRadius:2,fontSize:12},children:x}),p.length===0?e.jsx("div",{style:{padding:a.spacing.xl,textAlign:"center",color:o.muted,border:`1px solid ${o.border}`,borderRadius:2},children:'No log aggregation configurations. Click "Add Configuration" to create one.'}):e.jsx("div",{style:{display:"grid",gap:a.spacing.md},children:p.map(n=>{const s=j[n.config_id];return e.jsxs("div",{style:{padding:a.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,background:o.background},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:a.spacing.sm},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:600,fontSize:14},children:n.config_id}),e.jsx("span",{style:{fontSize:11,color:o.muted,marginLeft:a.spacing.sm,textTransform:"uppercase"},children:n.type}),e.jsx("span",{style:{fontSize:11,padding:`${a.spacing.xs} ${a.spacing.sm}`,background:n.enabled?o.success:o.muted,color:"#ffffff",marginLeft:a.spacing.sm,borderRadius:2},children:n.enabled?"Enabled":"Disabled"})]}),e.jsx(g,{label:"Export Now",onClick:()=>_(n.config_id)})]}),e.jsxs("div",{style:{fontSize:11,color:o.muted,marginBottom:a.spacing.xs},children:["Endpoint: ",n.endpoint||"N/A"]}),n.type==="elasticsearch"&&n.index_name&&e.jsxs("div",{style:{fontSize:11,color:o.muted,marginBottom:a.spacing.xs},children:["Index: ",n.index_name]}),s&&e.jsxs("div",{style:{marginTop:a.spacing.sm,padding:a.spacing.sm,background:o.backgroundSoft,borderRadius:2,fontSize:11},children:[e.jsxs("div",{children:["Exported: ",s.logs_exported," | Failed: ",s.logs_failed]}),s.last_export&&e.jsxs("div",{style:{color:o.muted,marginTop:a.spacing.xs},children:["Last export: ",new Date(s.last_export).toLocaleString()]}),s.last_error&&e.jsxs("div",{style:{color:o.error,marginTop:a.spacing.xs},children:["Error: ",s.last_error]})]})]},n.config_id)})}),k&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:o.background,border:`1px solid ${o.border}`,borderRadius:2,padding:a.spacing.lg,maxWidth:600,width:"90%",maxHeight:"90vh",overflowY:"auto"},children:[e.jsx("h2",{style:{fontSize:16,fontWeight:600,color:o.foreground,marginBottom:a.spacing.md},children:"Log Aggregation Configuration"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:a.spacing.md},children:[e.jsx("input",{type:"text",placeholder:"Config ID",value:t.config_id,onChange:n=>i({...t,config_id:n.target.value}),style:{padding:a.spacing.sm,border:`1px solid ${o.border}`,background:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12,borderRadius:2}}),e.jsxs("select",{value:t.type,onChange:n=>i({...t,type:n.target.value}),style:{padding:a.spacing.sm,border:`1px solid ${o.border}`,background:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12,borderRadius:2},children:[e.jsx("option",{value:"elasticsearch",children:"Elasticsearch"}),e.jsx("option",{value:"splunk",children:"Splunk"})]}),e.jsx("input",{type:"text",placeholder:"Endpoint URL",value:t.endpoint||"",onChange:n=>i({...t,endpoint:n.target.value}),style:{padding:a.spacing.sm,border:`1px solid ${o.border}`,background:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12,borderRadius:2}}),t.type==="elasticsearch"&&e.jsx("input",{type:"text",placeholder:"Index Name",value:t.index_name||"",onChange:n=>i({...t,index_name:n.target.value}),style:{padding:a.spacing.sm,border:`1px solid ${o.border}`,background:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12,borderRadius:2}}),t.type==="splunk"&&e.jsx("input",{type:"text",placeholder:"HEC Token",value:t.token||"",onChange:n=>i({...t,token:n.target.value}),style:{padding:a.spacing.sm,border:`1px solid ${o.border}`,background:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12,borderRadius:2}}),e.jsx("input",{type:"text",placeholder:"Username (optional)",value:t.username||"",onChange:n=>i({...t,username:n.target.value}),style:{padding:a.spacing.sm,border:`1px solid ${o.border}`,background:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12,borderRadius:2}}),e.jsx("input",{type:"password",placeholder:"Password (optional)",value:t.password||"",onChange:n=>i({...t,password:n.target.value}),style:{padding:a.spacing.sm,border:`1px solid ${o.border}`,background:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12,borderRadius:2}}),e.jsxs("div",{style:{display:"flex",gap:a.spacing.md},children:[e.jsx(g,{label:"Save",onClick:S}),e.jsx(g,{label:"Cancel",onClick:()=>u(!1)})]})]})]})})]})})})};export{B as default};
