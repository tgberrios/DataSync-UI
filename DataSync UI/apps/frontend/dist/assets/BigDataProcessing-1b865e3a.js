import{r as n,a1 as $,j as e,t as r,b as o,e as P,g as L}from"./index-b1fa964d.js";import{A as H}from"./AsciiPanel-3399d5be.js";import{A as D}from"./AsciiButton-3fcfdd9b.js";import{e as I}from"./errorHandler-5ea9ae85.js";import{S as U}from"./SkeletonLoader-09c12074.js";const O=({onClose:t,onSave:k,initialConfig:s})=>{const[a,S]=n.useState({masterUrl:(s==null?void 0:s.masterUrl)||"local[*]",appName:(s==null?void 0:s.appName)||"DataSync",sparkHome:(s==null?void 0:s.sparkHome)||"",connectUrl:(s==null?void 0:s.connectUrl)||"",executorMemoryMB:(s==null?void 0:s.executorMemoryMB)||2048,executorCores:(s==null?void 0:s.executorCores)||2,maxRetries:(s==null?void 0:s.maxRetries)||3,retryDelaySeconds:(s==null?void 0:s.retryDelaySeconds)||5,sparkConf:(s==null?void 0:s.sparkConf)||{}}),[M,z]=n.useState(null),[m,f]=n.useState(!1),[v,B]=n.useState(!1),[b,T]=n.useState(null),[C,i]=n.useState(""),[u,x]=n.useState(""),j=n.useCallback((d,R)=>{S(E=>({...E,[d]:R})),z(null),T(null)},[]),g=n.useCallback(()=>{!C.trim()||!u.trim()||(S(d=>({...d,sparkConf:{...d.sparkConf,[C.trim()]:u.trim()}})),i(""),x(""))},[C,u]),w=n.useCallback(d=>{S(R=>{const E={...R.sparkConf};return delete E[d],{...R,sparkConf:E}})},[]),l=n.useCallback(async()=>{B(!0),T(null),z(null);try{const d=await $.testSparkConnection(a);T({success:d.success||!1,message:d.message||"Connection test completed"})}catch(d){T({success:!1,message:I(d)})}finally{B(!1)}},[a]),y=n.useCallback(async()=>{f(!0),z(null);try{await $.updateSparkConfig(a),k(a),t()}catch(d){z(I(d))}finally{f(!1)}},[a,k,t]);return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:r.spacing.lg},children:e.jsxs("div",{style:{backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:2,padding:r.spacing.xl,maxWidth:"800px",width:"100%",maxHeight:"90vh",overflowY:"auto",boxShadow:r.shadows.lg},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:r.spacing.lg,borderBottom:`1px solid ${o.border}`,paddingBottom:r.spacing.md},children:[e.jsx("h2",{style:{fontSize:18,fontWeight:600,color:o.foreground,margin:0},children:"Spark Configuration"}),e.jsx("button",{onClick:t,style:{background:"transparent",border:"none",color:o.foreground,cursor:"pointer",fontSize:20,padding:r.spacing.xs,lineHeight:1},"aria-label":"Close",children:P.cross})]}),M&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:M}),b&&e.jsxs("div",{style:{padding:r.spacing.md,border:`1px solid ${b.success?o.accent:o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:[b.success?`${P.checkmark} `:`${P.cross} `,b.message]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Master URL *"}),e.jsx("input",{type:"text",value:a.masterUrl,onChange:d=>j("masterUrl",d.target.value),placeholder:"local[*], spark://host:port, yarn, etc.",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:"Examples: local[*], spark://master:7077, yarn, mesos://master:5050"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Application Name *"}),e.jsx("input",{type:"text",value:a.appName,onChange:d=>j("appName",d.target.value),placeholder:"DataSync",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Spark Home (Optional)"}),e.jsx("input",{type:"text",value:a.sparkHome||"",onChange:d=>j("sparkHome",d.target.value),placeholder:"/opt/spark",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Spark Connect URL (Optional)"}),e.jsx("input",{type:"text",value:a.connectUrl||"",onChange:d=>j("connectUrl",d.target.value),placeholder:"sc://localhost:15002",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:r.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Executor Memory (MB)"}),e.jsx("input",{type:"number",value:a.executorMemoryMB||2048,onChange:d=>j("executorMemoryMB",parseInt(d.target.value)||2048),min:"512",step:"256",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Executor Cores"}),e.jsx("input",{type:"number",value:a.executorCores||2,onChange:d=>j("executorCores",parseInt(d.target.value)||2),min:"1",step:"1",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:r.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Max Retries"}),e.jsx("input",{type:"number",value:a.maxRetries||3,onChange:d=>j("maxRetries",parseInt(d.target.value)||3),min:"0",step:"1",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Retry Delay (seconds)"}),e.jsx("input",{type:"number",value:a.retryDelaySeconds||5,onChange:d=>j("retryDelaySeconds",parseInt(d.target.value)||5),min:"1",step:"1",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Custom Spark Configuration"}),e.jsxs("div",{style:{display:"flex",gap:r.spacing.xs,marginBottom:r.spacing.sm},children:[e.jsx("input",{type:"text",value:C,onChange:d=>i(d.target.value),placeholder:"spark.sql.shuffle.partitions",style:{flex:1,padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx("input",{type:"text",value:u,onChange:d=>x(d.target.value),placeholder:"200",style:{flex:1,padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx(D,{onClick:g,disabled:!C.trim()||!u.trim(),children:"Add"})]}),a.sparkConf&&Object.keys(a.sparkConf).length>0&&e.jsx("div",{style:{padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:Object.entries(a.sparkConf).map(([d,R])=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:r.spacing.xs,marginBottom:r.spacing.xs},children:[e.jsxs("span",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground},children:[d," = ",R]}),e.jsx("button",{onClick:()=>w(d),style:{background:"transparent",border:`1px solid ${o.border}`,color:o.foreground,cursor:"pointer",padding:`${r.spacing.xs} ${r.spacing.sm}`,borderRadius:2,fontSize:11,fontFamily:"Consolas, monospace"},children:"Remove"})]},d))})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:r.spacing.md,marginTop:r.spacing.xl,paddingTop:r.spacing.md,borderTop:`1px solid ${o.border}`},children:[e.jsx(D,{onClick:t,disabled:m||v,children:"Cancel"}),e.jsx(D,{onClick:l,disabled:m||v,children:v?"Testing...":"Test Connection"}),e.jsx(D,{onClick:y,disabled:m||v||!a.masterUrl||!a.appName,children:m?"Saving...":"Save"})]})]})})},N=({config:t,sparkConfig:k,onUpdate:s})=>{var C;const[a,S]=n.useState({distributedThresholdRows:(t==null?void 0:t.distributedThresholdRows)||1e6,distributedThresholdSizeMB:(t==null?void 0:t.distributedThresholdSizeMB)||100,broadcastJoinThresholdMB:(t==null?void 0:t.broadcastJoinThresholdMB)||10,forceMode:(t==null?void 0:t.forceMode)||"AUTO",complexityScore:(t==null?void 0:t.complexityScore)||0,sparkConfig:(t==null?void 0:t.sparkConfig)||k||void 0}),[M,z]=n.useState(null),[m,f]=n.useState(!1),[v,B]=n.useState(!1);n.useEffect(()=>{S(i=>({...i,distributedThresholdRows:(t==null?void 0:t.distributedThresholdRows)||1e6,distributedThresholdSizeMB:(t==null?void 0:t.distributedThresholdSizeMB)||100,broadcastJoinThresholdMB:(t==null?void 0:t.broadcastJoinThresholdMB)||10,forceMode:(t==null?void 0:t.forceMode)||"AUTO",complexityScore:(t==null?void 0:t.complexityScore)||0,sparkConfig:(t==null?void 0:t.sparkConfig)||k||void 0}))},[t,k]),n.useEffect(()=>{(async()=>{var u;try{const x=await $.getDistributedProcessingStats();B(x.sparkAvailable||!1)}catch(x){if(((u=x==null?void 0:x.response)==null?void 0:u.status)===404){B(!1);return}console.warn("Error checking Spark availability:",x),B(!1)}})()},[]);const b=n.useCallback((i,u)=>{S(x=>({...x,[i]:u})),z(null)},[]),T=n.useCallback(async()=>{f(!0),z(null);try{await $.updateDistributedProcessingConfig(a),s(a)}catch(i){z(I(i))}finally{f(!1)}},[a,s]);return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:r.spacing.lg},children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,color:o.foreground,marginBottom:r.spacing.sm},children:"Processing Mode Selection"}),e.jsx("p",{style:{color:o.muted,fontSize:12,marginBottom:r.spacing.md},children:"Configure automatic decision between local and distributed processing based on data size and complexity."})]}),M&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:M}),!v&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:"Spark is not available. Configure Spark first to enable distributed processing."}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Force Mode"}),e.jsxs("select",{value:a.forceMode||"AUTO",onChange:i=>b("forceMode",i.target.value),style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"AUTO",children:"Auto (Automatic decision)"}),e.jsx("option",{value:"LOCAL_ONLY",children:"Local Only (Force local processing)"}),e.jsx("option",{value:"DISTRIBUTED_ONLY",children:"Distributed Only (Force distributed processing)"})]}),e.jsxs("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:[a.forceMode==="AUTO"&&"Automatically choose based on thresholds",a.forceMode==="LOCAL_ONLY"&&"Always use local thread pools",a.forceMode==="DISTRIBUTED_ONLY"&&"Always use Spark (if available)"]})]}),a.forceMode==="AUTO"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Distributed Threshold (Rows)"}),e.jsx("input",{type:"number",value:a.distributedThresholdRows||1e6,onChange:i=>b("distributedThresholdRows",parseInt(i.target.value)||1e6),min:"1000",step:"10000",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:"Use distributed processing when estimated rows exceed this threshold"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Distributed Threshold (Size MB)"}),e.jsx("input",{type:"number",value:a.distributedThresholdSizeMB||100,onChange:i=>b("distributedThresholdSizeMB",parseInt(i.target.value)||100),min:"1",step:"10",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:"Use distributed processing when estimated size exceeds this threshold (MB)"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Broadcast Join Threshold (MB)"}),e.jsx("input",{type:"number",value:a.broadcastJoinThresholdMB||10,onChange:i=>b("broadcastJoinThresholdMB",parseInt(i.target.value)||10),min:"1",step:"1",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:"Use broadcast join when smaller table size is below this threshold (MB)"})]})]}),e.jsxs("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsx("h4",{style:{fontSize:12,fontWeight:600,color:o.foreground,marginBottom:r.spacing.xs},children:"Current Configuration Summary"}),e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground},children:[e.jsxs("div",{children:["Mode: ",a.forceMode]}),a.forceMode==="AUTO"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Row Threshold: ",(C=a.distributedThresholdRows)==null?void 0:C.toLocaleString()," rows"]}),e.jsxs("div",{children:["Size Threshold: ",a.distributedThresholdSizeMB," MB"]}),e.jsxs("div",{children:["Broadcast Join Threshold: ",a.broadcastJoinThresholdMB," MB"]})]}),e.jsxs("div",{children:["Spark Available: ",v?"Yes":"No"]})]})]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:r.spacing.xl,paddingTop:r.spacing.md,borderTop:`1px solid ${o.border}`},children:e.jsx(D,{onClick:T,disabled:m,children:m?"Saving...":"Save Configuration"})})]})},F=({checked:t,onChange:k,size:s=18})=>e.jsx("div",{onClick:()=>k(!t),style:{width:`${s}px`,height:`${s}px`,border:`1px solid ${t?o.accent:o.border}`,borderRadius:2,backgroundColor:t?o.accent:"transparent",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.15s ease",flexShrink:0},children:t&&e.jsx("span",{style:{color:"#ffffff",fontSize:s*.7,lineHeight:1,fontFamily:"Consolas, monospace",fontWeight:"bold"},children:"✓"})}),J=({onClose:t,onSave:k,tableId:s})=>{var g,w;const[a,S]=n.useState({enabled:!0,autoDetect:!0,partitionTypes:["DATE","REGION"],dateColumnPattern:"",regionColumnPattern:""}),[M,z]=n.useState([]),[m,f]=n.useState(s||""),[v,B]=n.useState(null),[b,T]=n.useState(!1),[C,i]=n.useState(!0);n.useEffect(()=>{(async()=>{try{i(!0);const[y,d]=await Promise.all([$.getPartitioningConfig(m||void 0).catch(R=>{var E;return((E=R==null?void 0:R.response)==null?void 0:E.status)===404||console.warn("Error getting partitioning config:",R),null}),L.getCatalog({limit:1e4}).catch(()=>({tables:[]}))]);y&&S(y.config||y),d!=null&&d.tables&&z(d.tables)}catch(y){B(I(y))}finally{i(!1)}})()},[m]);const u=n.useCallback((l,y)=>{S(d=>({...d,[l]:y})),B(null)},[]),x=n.useCallback(l=>{S(y=>{const d=y.partitionTypes||[],R=d.includes(l)?d.filter(E=>E!==l):[...d,l];return{...y,partitionTypes:R}})},[]),j=n.useCallback(async()=>{T(!0),B(null);try{await $.updatePartitioningConfig(a,m||void 0),k(),t()}catch(l){B(I(l))}finally{T(!1)}},[a,m,k,t]);return C?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsx("div",{style:{padding:r.spacing.xl,backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:2,color:o.foreground},children:"Loading..."})}):e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:r.spacing.lg},children:e.jsxs("div",{style:{backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:2,padding:r.spacing.xl,maxWidth:"700px",width:"100%",maxHeight:"90vh",overflowY:"auto",boxShadow:r.shadows.lg},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:r.spacing.lg,borderBottom:`1px solid ${o.border}`,paddingBottom:r.spacing.md},children:[e.jsx("h2",{style:{fontSize:18,fontWeight:600,color:o.foreground,margin:0},children:"Partitioning Configuration"}),e.jsx("button",{onClick:t,style:{background:"transparent",border:"none",color:o.foreground,cursor:"pointer",fontSize:20,padding:r.spacing.xs,lineHeight:1},"aria-label":"Close",children:"×"})]}),v&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:v}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.md},children:[!s&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Table (Optional - leave empty for global config)"}),e.jsxs("select",{value:m,onChange:l=>{f(l.target.value)},style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"",children:"Global Configuration"}),M.map(l=>e.jsxs("option",{value:`${l.schema_name}.${l.table_name}`,children:[l.schema_name,".",l.table_name," (",l.db_engine,")"]},`${l.schema_name}.${l.table_name}`))]})]}),e.jsx("div",{children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:r.spacing.sm,color:o.foreground,fontSize:12,fontWeight:500,cursor:"pointer"},children:[e.jsx(F,{checked:a.enabled,onChange:l=>u("enabled",l)}),"Enable Partitioning"]})}),a.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:r.spacing.sm,color:o.foreground,fontSize:12,fontWeight:500,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:a.autoDetect,onChange:l=>u("autoDetect",l.target.checked),style:{width:"18px",height:"18px",cursor:"pointer",borderRadius:2,border:`1px solid ${o.border}`,appearance:"none",WebkitAppearance:"none",MozAppearance:"none"}}),"Auto-detect Partition Columns"]}),e.jsx("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:"Automatically detect partition columns based on naming patterns and data types"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Partition Types"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:r.spacing.sm},children:["DATE","REGION","RANGE","HASH","LIST"].map(l=>{var y,d;return e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:r.spacing.xs,padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:(y=a.partitionTypes)!=null&&y.includes(l)?o.backgroundSoft:"transparent",cursor:"pointer",fontSize:11},children:[e.jsx(F,{checked:((d=a.partitionTypes)==null?void 0:d.includes(l))||!1,onChange:()=>x(l),size:16}),l]},l)})})]}),((g=a.partitionTypes)==null?void 0:g.includes("DATE"))&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Date Column Pattern (Optional)"}),e.jsx("input",{type:"text",value:a.dateColumnPattern||"",onChange:l=>u("dateColumnPattern",l.target.value),placeholder:".*_date|.*_timestamp|created_at",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:"Regex pattern to identify date columns (e.g., .*_date|.*_timestamp)"})]}),((w=a.partitionTypes)==null?void 0:w.includes("REGION"))&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Region Column Pattern (Optional)"}),e.jsx("input",{type:"text",value:a.regionColumnPattern||"",onChange:l=>u("regionColumnPattern",l.target.value),placeholder:".*_region|.*_country|.*_location",style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:"Regex pattern to identify region columns (e.g., .*_region|.*_country)"})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:r.spacing.md,marginTop:r.spacing.xl,paddingTop:r.spacing.md,borderTop:`1px solid ${o.border}`},children:[e.jsx(D,{onClick:t,disabled:b,children:"Cancel"}),e.jsx(D,{onClick:j,disabled:b,children:b?"Saving...":"Save"})]})]})})},Y=()=>{const[t,k]=n.useState({defaultStrategy:"UPSERT",useDistributed:!1,enableHistoryTable:!1,enableHybrid:!1}),[s,a]=n.useState([]),[S,M]=n.useState(""),[z,m]=n.useState(null),[f,v]=n.useState(!1),[B,b]=n.useState(!0);n.useEffect(()=>{(async()=>{try{b(!0);const[u,x]=await Promise.all([$.getMergeStrategyConfig(S||void 0).catch(j=>{var g;return((g=j==null?void 0:j.response)==null?void 0:g.status)===404||console.warn("Error getting merge strategy config:",j),null}),L.getCatalog({limit:1e4}).catch(()=>({tables:[]}))]);u&&k(u.config||u),x!=null&&x.tables&&a(x.tables)}catch(u){m(I(u))}finally{b(!1)}})()},[S]);const T=n.useCallback((i,u)=>{k(x=>({...x,[i]:u})),m(null)},[]),C=n.useCallback(async()=>{v(!0),m(null);try{await $.updateMergeStrategyConfig(t,S||void 0)}catch(i){m(I(i))}finally{v(!1)}},[t,S]);return B?e.jsx("div",{style:{padding:r.spacing.lg,color:o.foreground},children:"Loading..."}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:r.spacing.lg},children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,color:o.foreground,marginBottom:r.spacing.sm},children:"Merge Strategies Configuration"}),e.jsx("p",{style:{color:o.muted,fontSize:12,marginBottom:r.spacing.md},children:"Configure merge strategies for data synchronization. Strategies can be set globally or per table."})]}),z&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:z}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Table (Optional - leave empty for global config)"}),e.jsxs("select",{value:S,onChange:i=>M(i.target.value),style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"",children:"Global Configuration"}),s.map(i=>e.jsxs("option",{value:`${i.schema_name}.${i.table_name}`,children:[i.schema_name,".",i.table_name," (",i.db_engine,")"]},`${i.schema_name}.${i.table_name}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:r.spacing.xs,color:o.foreground,fontSize:12,fontWeight:500},children:"Default Merge Strategy"}),e.jsxs("select",{value:t.defaultStrategy||"UPSERT",onChange:i=>T("defaultStrategy",i.target.value),style:{width:"100%",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"UPSERT",children:"UPSERT (Update or Insert)"}),e.jsx("option",{value:"SCD_TYPE_4",children:"SCD Type 4 (History Table)"}),e.jsx("option",{value:"SCD_TYPE_6",children:"SCD Type 6 (Hybrid)"}),e.jsx("option",{value:"INCREMENTAL",children:"Incremental Merge"})]}),e.jsxs("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:[t.defaultStrategy==="UPSERT"&&"Update existing records or insert new ones",t.defaultStrategy==="SCD_TYPE_4"&&"Maintain history in a separate history table",t.defaultStrategy==="SCD_TYPE_6"&&"Hybrid approach with current and history tracking",t.defaultStrategy==="INCREMENTAL"&&"Only process changed records based on timestamps or CDC"]})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:r.spacing.sm,color:o.foreground,fontSize:12,fontWeight:500,cursor:"pointer"},children:[e.jsx(F,{checked:t.useDistributed||!1,onChange:i=>T("useDistributed",i)}),"Use Distributed Processing (Spark)"]}),e.jsx("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:"Use Spark for large volume merges to improve performance"})]}),(t.defaultStrategy==="SCD_TYPE_4"||t.defaultStrategy==="SCD_TYPE_6")&&e.jsxs("div",{children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:r.spacing.sm,color:o.foreground,fontSize:12,fontWeight:500,cursor:"pointer"},children:[e.jsx(F,{checked:t.enableHistoryTable||!1,onChange:i=>T("enableHistoryTable",i)}),"Enable History Table"]}),e.jsx("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:"Create and maintain a separate history table for tracking changes"})]}),t.defaultStrategy==="SCD_TYPE_6"&&e.jsxs("div",{children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:r.spacing.sm,color:o.foreground,fontSize:12,fontWeight:500,cursor:"pointer"},children:[e.jsx(F,{checked:t.enableHybrid||!1,onChange:i=>T("enableHybrid",i)}),"Enable Hybrid Mode"]}),e.jsx("div",{style:{marginTop:r.spacing.xs,fontSize:11,color:o.muted},children:"Use hybrid approach combining current and history tracking"})]}),e.jsxs("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsx("h4",{style:{fontSize:12,fontWeight:600,color:o.foreground,marginBottom:r.spacing.xs},children:"Strategy Details"}),e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Strategy:"})," ",t.defaultStrategy]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Distributed:"})," ",t.useDistributed?"Yes":"No"]}),t.enableHistoryTable&&e.jsxs("div",{children:[e.jsx("strong",{children:"History Table:"})," Enabled"]}),t.enableHybrid&&e.jsxs("div",{children:[e.jsx("strong",{children:"Hybrid Mode:"})," Enabled"]})]})]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:r.spacing.xl,paddingTop:r.spacing.md,borderTop:`1px solid ${o.border}`},children:e.jsx(D,{onClick:C,disabled:f,children:f?"Saving...":"Save Configuration"})})]})},G=()=>{const[t,k]=n.useState([]),[s,a]=n.useState(null),[S,M]=n.useState(!0),[z,m]=n.useState(null),[f,v]=n.useState({status:"",executionMode:"",search:""}),[B,b]=n.useState(""),[T,C]=n.useState(null),[i,u]=n.useState(!1),[x,j]=n.useState(!1),g=n.useRef(!0),w=n.useRef(null),l=n.useCallback(async()=>{var c;if(g.current)try{m(null);const p={};f.status&&(p.status=f.status),f.executionMode&&(p.executionMode=f.executionMode),f.search&&(p.search=f.search);const h=await $.getDistributedJobs(p);g.current&&k(h.jobs||[])}catch(p){if(g.current){if(((c=p==null?void 0:p.response)==null?void 0:c.status)===404){k([]);return}m(I(p))}}finally{g.current&&M(!1)}},[f]);n.useEffect(()=>(g.current=!0,M(!0),l(),w.current=setInterval(()=>{l()},5e3),()=>{g.current=!1,w.current&&clearInterval(w.current)}),[l]);const y=n.useCallback(async c=>{a(c),u(!1),j(!1),b(""),C(null)},[]),d=n.useCallback(async c=>{var p;try{const h=await $.getDistributedJobLogs(c,1e3);b(h.logs||""),u(!0)}catch(h){if(((p=h==null?void 0:h.response)==null?void 0:p.status)===404){b("Logs not available - endpoint not implemented yet"),u(!0);return}m(I(h))}},[]),R=n.useCallback(async c=>{var p;try{const h=await $.getDistributedJobMetrics(c);C(h.metrics||h),j(!0)}catch(h){if(((p=h==null?void 0:h.response)==null?void 0:p.status)===404){C({message:"Metrics not available - endpoint not implemented yet"}),j(!0);return}m(I(h))}},[]),E=n.useCallback(async c=>{var p;if(confirm("Are you sure you want to cancel this job?"))try{await $.cancelDistributedJob(c),l(),(s==null?void 0:s.jobId)===c&&a(null)}catch(h){if(((p=h==null?void 0:h.response)==null?void 0:p.status)===404){m("Cancel endpoint not implemented yet");return}m(I(h))}},[s,l]),A=c=>{switch(c){case"completed":return o.accent;case"running":return o.foreground;case"failed":return o.foreground;case"cancelled":return o.muted;default:return o.border}},W=c=>{if(!c)return"N/A";const p=Math.floor(c/1e3),h=Math.floor(p/60),_=Math.floor(h/60);return _>0?`${_}h ${h%60}m ${p%60}s`:h>0?`${h}m ${p%60}s`:`${p}s`};return S&&t.length===0?e.jsx(U,{}):e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 400px",gap:r.spacing.lg},children:[e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:r.spacing.md},children:e.jsx("h3",{style:{fontSize:14,fontWeight:600,color:o.foreground,marginBottom:r.spacing.sm},children:"Distributed Jobs"})}),z&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.md},children:z}),e.jsxs("div",{style:{display:"flex",gap:r.spacing.sm,marginBottom:r.spacing.md,flexWrap:"wrap"},children:[e.jsxs("select",{value:f.status,onChange:c=>v(p=>({...p,status:c.target.value})),style:{padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsxs("select",{value:f.executionMode,onChange:c=>v(p=>({...p,executionMode:c.target.value})),style:{padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"",children:"All Modes"}),e.jsx("option",{value:"local",children:"Local"}),e.jsx("option",{value:"distributed",children:"Distributed"})]}),e.jsx("input",{type:"text",value:f.search,onChange:c=>v(p=>({...p,search:c.target.value})),placeholder:"Search jobs...",style:{flex:1,minWidth:"200px",padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsx("div",{style:{border:`1px solid ${o.border}`,borderRadius:2,overflow:"hidden"},children:t.length===0?e.jsx("div",{style:{padding:r.spacing.xl,textAlign:"center",color:o.muted},children:"No jobs found"}):e.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:t.map(c=>e.jsxs("div",{onClick:()=>y(c),style:{padding:r.spacing.md,borderBottom:`1px solid ${o.border}`,cursor:"pointer",backgroundColor:(s==null?void 0:s.jobId)===c.jobId?o.backgroundSoft:"transparent",transition:"background-color 0.15s ease"},onMouseEnter:p=>{(s==null?void 0:s.jobId)!==c.jobId&&(p.currentTarget.style.backgroundColor=o.backgroundSoft)},onMouseLeave:p=>{(s==null?void 0:s.jobId)!==c.jobId&&(p.currentTarget.style.backgroundColor="transparent")},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:r.spacing.xs},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600,color:o.foreground,marginBottom:r.spacing.xs,fontFamily:"Consolas, monospace",fontSize:12},children:c.taskId||c.jobId}),e.jsxs("div",{style:{fontSize:11,color:o.muted,marginBottom:r.spacing.xs},children:[c.taskType," • ",c.executionMode]})]}),e.jsx("div",{style:{padding:`${r.spacing.xs} ${r.spacing.sm}`,border:`1px solid ${A(c.status)}`,borderRadius:2,backgroundColor:"transparent",color:A(c.status),fontSize:11,fontFamily:"Consolas, monospace",textTransform:"uppercase"},children:c.status})]}),c.rowsProcessed!==void 0&&e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Rows: ",c.rowsProcessed.toLocaleString()]}),c.duration&&e.jsxs("div",{style:{fontSize:11,color:o.muted},children:["Duration: ",W(c.duration)]})]},c.jobId))})})]}),s&&e.jsxs("div",{style:{border:`1px solid ${o.border}`,borderRadius:2,padding:r.spacing.md,backgroundColor:o.backgroundSoft},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:r.spacing.md,borderBottom:`1px solid ${o.border}`,paddingBottom:r.spacing.sm},children:[e.jsx("h4",{style:{fontSize:14,fontWeight:600,color:o.foreground,margin:0},children:"Job Details"}),s.status==="running"&&e.jsx(D,{onClick:()=>E(s.jobId),style:{fontSize:11,padding:`${r.spacing.xs} ${r.spacing.sm}`},children:"Cancel"})]}),e.jsxs("div",{style:{marginBottom:r.spacing.md},children:[e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,marginBottom:r.spacing.xs},children:[e.jsx("strong",{children:"Job ID:"})," ",s.jobId]}),e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,marginBottom:r.spacing.xs},children:[e.jsx("strong",{children:"Task ID:"})," ",s.taskId]}),e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,marginBottom:r.spacing.xs},children:[e.jsx("strong",{children:"Type:"})," ",s.taskType]}),e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,marginBottom:r.spacing.xs},children:[e.jsx("strong",{children:"Mode:"})," ",s.executionMode]}),e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,marginBottom:r.spacing.xs},children:[e.jsx("strong",{children:"Status:"})," ",s.status]}),s.rowsProcessed!==void 0&&e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,marginBottom:r.spacing.xs},children:[e.jsx("strong",{children:"Rows Processed:"})," ",s.rowsProcessed.toLocaleString()]}),s.outputPath&&e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,marginBottom:r.spacing.xs},children:[e.jsx("strong",{children:"Output:"})," ",s.outputPath]}),s.startTime&&e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,marginBottom:r.spacing.xs},children:[e.jsx("strong",{children:"Start:"})," ",new Date(s.startTime).toLocaleString()]}),s.endTime&&e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,marginBottom:r.spacing.xs},children:[e.jsx("strong",{children:"End:"})," ",new Date(s.endTime).toLocaleString()]}),s.duration&&e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,marginBottom:r.spacing.xs},children:[e.jsx("strong",{children:"Duration:"})," ",W(s.duration)]}),s.errorMessage&&e.jsxs("div",{style:{padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,color:o.foreground,marginTop:r.spacing.sm,fontFamily:"Consolas, monospace",fontSize:11},children:[e.jsx("strong",{children:"Error:"})," ",s.errorMessage]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:r.spacing.sm},children:[e.jsx(D,{onClick:()=>d(s.jobId),style:{width:"100%"},children:i?"Hide Logs":"View Logs"}),e.jsx(D,{onClick:()=>R(s.jobId),style:{width:"100%"},children:x?"Hide Metrics":"View Metrics"})]}),i&&B&&e.jsx("div",{style:{marginTop:r.spacing.md,padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,maxHeight:"300px",overflowY:"auto"},children:e.jsx("pre",{style:{margin:0,fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:B})}),x&&T&&e.jsx("div",{style:{marginTop:r.spacing.md,padding:r.spacing.sm,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.background,maxHeight:"300px",overflowY:"auto"},children:e.jsx("pre",{style:{margin:0,fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(T,null,2)})})]})]})},Z=()=>{const[t,k]=n.useState("spark"),[s,a]=n.useState(null),[S,M]=n.useState(null),[z,m]=n.useState(!0),[f,v]=n.useState(null),[B,b]=n.useState(!1),[T,C]=n.useState(!1),i=n.useRef(!0),u=n.useCallback(async()=>{if(i.current)try{m(!0),v(null);const[g,w]=await Promise.all([$.getSparkConfig().catch(l=>{var y;return((y=l==null?void 0:l.response)==null?void 0:y.status)===404||console.warn("Error getting Spark config:",l),null}),$.getDistributedProcessingConfig().catch(l=>{var y;return((y=l==null?void 0:l.response)==null?void 0:y.status)===404||console.warn("Error getting distributed processing config:",l),null})]);i.current&&(g&&a(g.config||g),w&&M(w.config||w))}catch(g){i.current&&v(I(g))}finally{i.current&&m(!1)}},[]);n.useEffect(()=>(i.current=!0,u(),()=>{i.current=!1}),[u]);const x=n.useCallback(g=>{a(g),u()},[u]),j=n.useCallback(g=>{M(g),u()},[u]);return z?e.jsx(U,{}):e.jsxs("div",{style:{padding:r.spacing.lg},children:[e.jsxs(H,{children:[e.jsxs("div",{style:{marginBottom:r.spacing.lg},children:[e.jsx("h1",{style:{fontSize:18,fontWeight:600,color:o.foreground,marginBottom:r.spacing.md},children:"Big Data Processing"}),e.jsx("p",{style:{color:o.muted,fontSize:12,marginBottom:r.spacing.lg},children:"Configure and monitor distributed processing, Spark integration, partitioning, and merge strategies."})]}),f&&e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.foreground,marginBottom:r.spacing.lg},children:f}),e.jsx("div",{style:{display:"flex",gap:r.spacing.sm,marginBottom:r.spacing.lg,borderBottom:`2px solid ${o.border}`,paddingBottom:r.spacing.sm},children:["spark","distributed","partitioning","merge","monitor"].map(g=>e.jsxs("button",{onClick:()=>k(g),style:{padding:`${r.spacing.sm} ${r.spacing.md}`,border:"none",background:t===g?o.accent:"transparent",color:t===g?"#ffffff":o.foreground,borderRadius:"2 2 0 0",cursor:"pointer",fontWeight:t===g?600:500,transition:"all 0.15s ease",textTransform:"capitalize",fontFamily:"Consolas, monospace",fontSize:12},onMouseEnter:w=>{t!==g&&(w.currentTarget.style.background=o.backgroundSoft)},onMouseLeave:w=>{t!==g&&(w.currentTarget.style.background="transparent")},children:[g==="spark"&&"Spark Config",g==="distributed"&&"Distributed Mode",g==="partitioning"&&"Partitioning",g==="merge"&&"Merge Strategies",g==="monitor"&&"Job Monitor"]},g))}),e.jsxs("div",{style:{minHeight:"400px"},children:[t==="spark"&&e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:r.spacing.md},children:e.jsx(D,{onClick:()=>b(!0),style:{marginBottom:r.spacing.md},children:s?"Edit Spark Configuration":"Configure Spark"})}),s&&e.jsxs("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft},children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,color:o.foreground,marginBottom:r.spacing.sm},children:"Current Configuration"}),e.jsxs("div",{style:{fontFamily:"Consolas, monospace",fontSize:11,color:o.foreground},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Master URL:"})," ",s.masterUrl||"Not set"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"App Name:"})," ",s.appName||"Not set"]}),s.sparkHome&&e.jsxs("div",{children:[e.jsx("strong",{children:"Spark Home:"})," ",s.sparkHome]}),s.executorMemoryMB&&e.jsxs("div",{children:[e.jsx("strong",{children:"Executor Memory:"})," ",s.executorMemoryMB," MB"]}),s.executorCores&&e.jsxs("div",{children:[e.jsx("strong",{children:"Executor Cores:"})," ",s.executorCores]})]})]})]}),t==="distributed"&&e.jsx(N,{config:S,sparkConfig:s,onUpdate:j}),t==="partitioning"&&e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:r.spacing.md},children:e.jsx(D,{onClick:()=>C(!0),children:"Configure Partitioning"})}),e.jsx("div",{style:{padding:r.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,backgroundColor:o.backgroundSoft,color:o.muted,fontSize:12},children:"Configure automatic partitioning for tables. Partitioning can be set per table or globally."})]}),t==="merge"&&e.jsx(Y,{}),t==="monitor"&&e.jsx(G,{})]})]}),B&&e.jsx(O,{onClose:()=>b(!1),onSave:x,initialConfig:s}),T&&e.jsx(J,{onClose:()=>C(!1),onSave:()=>{C(!1),u()}})]})};export{Z as default};
