import{r as g,j as e,t as o,b as n,s as j}from"./index-b1fa964d.js";import{A as b}from"./AsciiPanel-3399d5be.js";import $ from"./DataMasking-2bae5ef1.js";import{A as k}from"./AsciiButton-3fcfdd9b.js";import{e as v}from"./errorHandler-5ea9ae85.js";import"./SkeletonLoader-09c12074.js";const P=()=>{const[p,u]=g.useState(!1),[m,c]=g.useState(null),[x,_]=g.useState([]),[l,y]=g.useState({schema:"",table:"",column:""}),[t,r]=g.useState({value:"",schema_name:"",table_name:"",column_name:"",reversible:!0,token_type:"REVERSIBLE"}),[d,h]=g.useState({token:"",schema_name:"",table_name:"",column_name:"",reason:""}),s=async()=>{u(!0),c(null);try{const a=await j.getTokens({schema:l.schema||void 0,table:l.table||void 0,column:l.column||void 0,limit:100});_(a)}catch(a){c(v(a))}finally{u(!1)}};g.useEffect(()=>{s()},[l]);const S=async()=>{if(!t.value||!t.schema_name||!t.table_name||!t.column_name){c("All fields are required");return}u(!0),c(null);try{await j.tokenize({value:t.value,schema_name:t.schema_name,table_name:t.table_name,column_name:t.column_name,reversible:t.reversible,token_type:t.token_type}),r({...t,value:""}),s()}catch(a){c(v(a))}finally{u(!1)}},z=async()=>{if(!d.token||!d.schema_name||!d.table_name||!d.column_name){c("All fields are required");return}u(!0),c(null);try{await j.detokenize({token:d.token,schema_name:d.schema_name,table_name:d.table_name,column_name:d.column_name,reason:d.reason}),h({...d,token:"",reason:""})}catch(a){c(v(a))}finally{u(!1)}};return e.jsxs("div",{children:[m&&e.jsx("div",{style:{padding:o.spacing.md,background:n.error,color:"#ffffff",marginBottom:o.spacing.md,borderRadius:2,fontSize:12},children:m}),e.jsxs(b,{style:{marginBottom:o.spacing.lg},children:[e.jsx("h2",{style:{fontSize:14,fontWeight:600,marginBottom:o.spacing.md,color:n.foreground},children:"Tokenize Value"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:o.spacing.md,marginBottom:o.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Schema Name"}),e.jsx("input",{type:"text",value:t.schema_name,onChange:a=>r({...t,schema_name:a.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Table Name"}),e.jsx("input",{type:"text",value:t.table_name,onChange:a=>r({...t,table_name:a.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Column Name"}),e.jsx("input",{type:"text",value:t.column_name,onChange:a=>r({...t,column_name:a.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Value"}),e.jsx("input",{type:"text",value:t.value,onChange:a=>r({...t,value:a.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),e.jsxs("div",{style:{display:"flex",gap:o.spacing.md,alignItems:"center",marginBottom:o.spacing.md},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:o.spacing.xs,fontSize:12,color:n.foreground},children:[e.jsx("input",{type:"checkbox",checked:t.reversible,onChange:a=>r({...t,reversible:a.target.checked})}),"Reversible"]}),e.jsxs("select",{value:t.token_type,onChange:a=>r({...t,token_type:a.target.value}),style:{padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"REVERSIBLE",children:"Reversible"}),e.jsx("option",{value:"IRREVERSIBLE",children:"Irreversible"}),e.jsx("option",{value:"FPE",children:"Format-Preserving"})]})]}),e.jsx(k,{onClick:S,disabled:p,children:"Tokenize"})]}),e.jsxs(b,{style:{marginBottom:o.spacing.lg},children:[e.jsx("h2",{style:{fontSize:14,fontWeight:600,marginBottom:o.spacing.md,color:n.foreground},children:"Detokenize"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:o.spacing.md,marginBottom:o.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Schema Name"}),e.jsx("input",{type:"text",value:d.schema_name,onChange:a=>h({...d,schema_name:a.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Table Name"}),e.jsx("input",{type:"text",value:d.table_name,onChange:a=>h({...d,table_name:a.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Column Name"}),e.jsx("input",{type:"text",value:d.column_name,onChange:a=>h({...d,column_name:a.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Token"}),e.jsx("input",{type:"text",value:d.token,onChange:a=>h({...d,token:a.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),e.jsxs("div",{style:{marginBottom:o.spacing.md},children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Reason (required for audit)"}),e.jsx("textarea",{value:d.reason,onChange:a=>h({...d,reason:a.target.value}),rows:3,style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12,resize:"vertical"}})]}),e.jsx(k,{onClick:z,disabled:p,children:"Detokenize"})]}),e.jsxs(b,{style:{marginBottom:o.spacing.lg},children:[e.jsx("h2",{style:{fontSize:14,fontWeight:600,marginBottom:o.spacing.md,color:n.foreground},children:"Filters"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:o.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Schema"}),e.jsx("input",{type:"text",value:l.schema,onChange:a=>y({...l,schema:a.target.value}),placeholder:"Filter by schema",style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Table"}),e.jsx("input",{type:"text",value:l.table,onChange:a=>y({...l,table:a.target.value}),placeholder:"Filter by table",style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Column"}),e.jsx("input",{type:"text",value:l.column,onChange:a=>y({...l,column:a.target.value}),placeholder:"Filter by column",style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]})]}),e.jsxs(b,{children:[e.jsxs("h2",{style:{fontSize:14,fontWeight:600,marginBottom:o.spacing.md,color:n.foreground},children:["Tokens (",x.length,")"]}),p?e.jsx("div",{style:{padding:o.spacing.lg,textAlign:"center",color:n.muted},children:"Loading..."}):x.length===0?e.jsx("div",{style:{padding:o.spacing.lg,textAlign:"center",color:n.muted},children:"No tokens found"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:`2px solid ${n.border}`},children:[e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Schema"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Table"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Column"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Token"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Type"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Access Count"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Created"})]})}),e.jsx("tbody",{children:x.map(a=>e.jsxs("tr",{style:{borderBottom:`1px solid ${n.border}`},children:[e.jsx("td",{style:{padding:o.spacing.sm},children:a.schema_name}),e.jsx("td",{style:{padding:o.spacing.sm},children:a.table_name}),e.jsx("td",{style:{padding:o.spacing.sm},children:a.column_name}),e.jsxs("td",{style:{padding:o.spacing.sm,fontFamily:"monospace"},children:[a.token_value.substring(0,20),"..."]}),e.jsx("td",{style:{padding:o.spacing.sm},children:a.token_type===0?"Reversible":a.token_type===1?"Irreversible":"FPE"}),e.jsx("td",{style:{padding:o.spacing.sm},children:a.access_count}),e.jsx("td",{style:{padding:o.spacing.sm},children:new Date(a.created_at).toLocaleDateString()})]},a.token_id))})]})]})]})},I=()=>{var A;const[p,u]=g.useState(!1),[m,c]=g.useState(null),[x,_]=g.useState([]),[l,y]=g.useState(null),[t,r]=g.useState({profile_name:"",schema_name:"",table_name:"",anonymization_type:"K_ANONYMITY",k_value:2,l_value:2,t_value:.1,epsilon:1,quasi_identifiers:[],sensitive_attributes:[],suppression_threshold:0,active:!0}),[d,h]=g.useState(""),[s,S]=g.useState(""),z=async()=>{u(!0),c(null);try{const i=await j.getAnonymizationProfiles();_(i)}catch(i){c(v(i))}finally{u(!1)}};g.useEffect(()=>{z()},[]);const a=async()=>{if(!t.profile_name||!t.schema_name||!t.table_name||!t.quasi_identifiers.length){c("Profile name, schema, table, and at least one quasi-identifier are required");return}u(!0),c(null);try{await j.createAnonymizationProfile(t),r({profile_name:"",schema_name:"",table_name:"",anonymization_type:"K_ANONYMITY",k_value:2,l_value:2,t_value:.1,epsilon:1,quasi_identifiers:[],sensitive_attributes:[],suppression_threshold:0,active:!0}),h(""),S(""),z()}catch(i){c(v(i))}finally{u(!1)}},C=()=>{d.trim()&&(r({...t,quasi_identifiers:[...t.quasi_identifiers,d.trim()]}),h(""))},T=i=>{r({...t,quasi_identifiers:t.quasi_identifiers.filter((f,F)=>F!==i)})},B=()=>{s.trim()&&(r({...t,sensitive_attributes:[...t.sensitive_attributes||[],s.trim()]}),S(""))},E=i=>{var f;r({...t,sensitive_attributes:((f=t.sensitive_attributes)==null?void 0:f.filter((F,w)=>w!==i))||[]})};return e.jsxs("div",{children:[m&&e.jsx("div",{style:{padding:o.spacing.md,background:n.error,color:"#ffffff",marginBottom:o.spacing.md,borderRadius:2,fontSize:12},children:m}),e.jsxs(b,{style:{marginBottom:o.spacing.lg},children:[e.jsx("h2",{style:{fontSize:14,fontWeight:600,marginBottom:o.spacing.md,color:n.foreground},children:"Create Anonymization Profile"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:o.spacing.md,marginBottom:o.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Profile Name"}),e.jsx("input",{type:"text",value:t.profile_name,onChange:i=>r({...t,profile_name:i.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Anonymization Type"}),e.jsxs("select",{value:t.anonymization_type,onChange:i=>r({...t,anonymization_type:i.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"K_ANONYMITY",children:"K-Anonymity"}),e.jsx("option",{value:"L_DIVERSITY",children:"L-Diversity"}),e.jsx("option",{value:"T_CLOSENESS",children:"T-Closeness"}),e.jsx("option",{value:"DIFFERENTIAL_PRIVACY",children:"Differential Privacy"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Schema Name"}),e.jsx("input",{type:"text",value:t.schema_name,onChange:i=>r({...t,schema_name:i.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Table Name"}),e.jsx("input",{type:"text",value:t.table_name,onChange:i=>r({...t,table_name:i.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),t.anonymization_type==="K_ANONYMITY"&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"K Value"}),e.jsx("input",{type:"number",min:"2",value:t.k_value||2,onChange:i=>r({...t,k_value:parseInt(i.target.value)||2}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),t.anonymization_type==="L_DIVERSITY"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"K Value"}),e.jsx("input",{type:"number",min:"2",value:t.k_value||2,onChange:i=>r({...t,k_value:parseInt(i.target.value)||2}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"L Value"}),e.jsx("input",{type:"number",min:"2",value:t.l_value||2,onChange:i=>r({...t,l_value:parseInt(i.target.value)||2}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),t.anonymization_type==="T_CLOSENESS"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"K Value"}),e.jsx("input",{type:"number",min:"2",value:t.k_value||2,onChange:i=>r({...t,k_value:parseInt(i.target.value)||2}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"T Value"}),e.jsx("input",{type:"number",min:"0",max:"1",step:"0.01",value:t.t_value||.1,onChange:i=>r({...t,t_value:parseFloat(i.target.value)||.1}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),t.anonymization_type==="DIFFERENTIAL_PRIVACY"&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Epsilon (Privacy Budget)"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:t.epsilon||1,onChange:i=>r({...t,epsilon:parseFloat(i.target.value)||1}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),e.jsxs("div",{style:{marginBottom:o.spacing.md},children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Quasi-Identifiers (comma-separated or add one by one)"}),e.jsxs("div",{style:{display:"flex",gap:o.spacing.sm,marginBottom:o.spacing.sm},children:[e.jsx("input",{type:"text",value:d,onChange:i=>h(i.target.value),onKeyPress:i=>i.key==="Enter"&&C(),placeholder:"Enter quasi-identifier",style:{flex:1,padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx(k,{onClick:C,children:"Add"})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:o.spacing.xs},children:t.quasi_identifiers.map((i,f)=>e.jsxs("span",{style:{padding:`${o.spacing.xs} ${o.spacing.sm}`,background:n.backgroundSoft,border:`1px solid ${n.border}`,borderRadius:2,fontSize:11,display:"flex",alignItems:"center",gap:o.spacing.xs},children:[i,e.jsx("button",{onClick:()=>T(f),style:{background:"none",border:"none",color:n.error,cursor:"pointer",fontSize:14,padding:0,width:16,height:16},children:"×"})]},f))})]}),(t.anonymization_type==="L_DIVERSITY"||t.anonymization_type==="T_CLOSENESS")&&e.jsxs("div",{style:{marginBottom:o.spacing.md},children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Sensitive Attributes"}),e.jsxs("div",{style:{display:"flex",gap:o.spacing.sm,marginBottom:o.spacing.sm},children:[e.jsx("input",{type:"text",value:s,onChange:i=>S(i.target.value),onKeyPress:i=>i.key==="Enter"&&B(),placeholder:"Enter sensitive attribute",style:{flex:1,padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}}),e.jsx(k,{onClick:B,children:"Add"})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:o.spacing.xs},children:(A=t.sensitive_attributes)==null?void 0:A.map((i,f)=>e.jsxs("span",{style:{padding:`${o.spacing.xs} ${o.spacing.sm}`,background:n.backgroundSoft,border:`1px solid ${n.border}`,borderRadius:2,fontSize:11,display:"flex",alignItems:"center",gap:o.spacing.xs},children:[i,e.jsx("button",{onClick:()=>E(f),style:{background:"none",border:"none",color:n.error,cursor:"pointer",fontSize:14,padding:0,width:16,height:16},children:"×"})]},f))})]}),e.jsx(k,{onClick:a,disabled:p,children:"Create Profile"})]}),e.jsxs(b,{children:[e.jsxs("h2",{style:{fontSize:14,fontWeight:600,marginBottom:o.spacing.md,color:n.foreground},children:["Anonymization Profiles (",x.length,")"]}),p?e.jsx("div",{style:{padding:o.spacing.lg,textAlign:"center",color:n.muted},children:"Loading..."}):x.length===0?e.jsx("div",{style:{padding:o.spacing.lg,textAlign:"center",color:n.muted},children:"No profiles found"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:`2px solid ${n.border}`},children:[e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Profile Name"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Schema"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Table"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Type"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"K"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"L"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"T/Epsilon"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Status"})]})}),e.jsx("tbody",{children:x.map(i=>e.jsxs("tr",{style:{borderBottom:`1px solid ${n.border}`,cursor:"pointer"},onClick:()=>y(i),children:[e.jsx("td",{style:{padding:o.spacing.sm},children:i.profile_name}),e.jsx("td",{style:{padding:o.spacing.sm},children:i.schema_name}),e.jsx("td",{style:{padding:o.spacing.sm},children:i.table_name}),e.jsx("td",{style:{padding:o.spacing.sm},children:i.anonymization_type}),e.jsx("td",{style:{padding:o.spacing.sm},children:i.k_value||"-"}),e.jsx("td",{style:{padding:o.spacing.sm},children:i.l_value||"-"}),e.jsx("td",{style:{padding:o.spacing.sm},children:i.t_value!==void 0?i.t_value:i.epsilon!==void 0?i.epsilon:"-"}),e.jsx("td",{style:{padding:o.spacing.sm},children:e.jsx("span",{style:{color:i.active?n.accent:n.muted},children:i.active?"Active":"Inactive"})})]},i.profile_id))})]})]})]})},N=()=>{const[p,u]=g.useState(!1),[m,c]=g.useState(null),[x,_]=g.useState([]),[l,y]=g.useState({policy_name:"",policy_type:"COLUMN",schema_name:"",table_name:"",column_name:"",role_name:"",username:"",operation:"SELECT",condition_expression:"",attribute_conditions:{},priority:0,active:!0}),[t,r]=g.useState({schema:"",table:"",policy_type:""}),d=async()=>{u(!0),c(null);try{const s=await j.getPermissionPolicies({schema:t.schema||void 0,table:t.table||void 0,policy_type:t.policy_type||void 0});_(s)}catch(s){c(v(s))}finally{u(!1)}};g.useEffect(()=>{d()},[t]);const h=async()=>{if(!l.policy_name||!l.operation){c("Policy name and operation are required");return}u(!0),c(null);try{await j.createPermissionPolicy(l),y({policy_name:"",policy_type:"COLUMN",schema_name:"",table_name:"",column_name:"",role_name:"",username:"",operation:"SELECT",condition_expression:"",attribute_conditions:{},priority:0,active:!0}),d()}catch(s){c(v(s))}finally{u(!1)}};return e.jsxs("div",{children:[m&&e.jsx("div",{style:{padding:o.spacing.md,background:n.error,color:"#ffffff",marginBottom:o.spacing.md,borderRadius:2,fontSize:12},children:m}),e.jsxs(b,{style:{marginBottom:o.spacing.lg},children:[e.jsx("h2",{style:{fontSize:14,fontWeight:600,marginBottom:o.spacing.md,color:n.foreground},children:"Create Permission Policy"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:o.spacing.md,marginBottom:o.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Policy Name"}),e.jsx("input",{type:"text",value:l.policy_name,onChange:s=>y({...l,policy_name:s.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Policy Type"}),e.jsxs("select",{value:l.policy_type,onChange:s=>y({...l,policy_type:s.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"COLUMN",children:"Column"}),e.jsx("option",{value:"ROW",children:"Row"}),e.jsx("option",{value:"TABLE",children:"Table"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Schema Name"}),e.jsx("input",{type:"text",value:l.schema_name||"",onChange:s=>y({...l,schema_name:s.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Table Name"}),e.jsx("input",{type:"text",value:l.table_name||"",onChange:s=>y({...l,table_name:s.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),l.policy_type==="COLUMN"&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Column Name"}),e.jsx("input",{type:"text",value:l.column_name||"",onChange:s=>y({...l,column_name:s.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Operation"}),e.jsxs("select",{value:l.operation,onChange:s=>y({...l,operation:s.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"SELECT",children:"SELECT"}),e.jsx("option",{value:"INSERT",children:"INSERT"}),e.jsx("option",{value:"UPDATE",children:"UPDATE"}),e.jsx("option",{value:"DELETE",children:"DELETE"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Role Name (optional)"}),e.jsx("input",{type:"text",value:l.role_name||"",onChange:s=>y({...l,role_name:s.target.value}),placeholder:"Leave empty for all roles",style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Username (optional)"}),e.jsx("input",{type:"text",value:l.username||"",onChange:s=>y({...l,username:s.target.value}),placeholder:"Leave empty for all users",style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Priority"}),e.jsx("input",{type:"number",value:l.priority,onChange:s=>y({...l,priority:parseInt(s.target.value)||0}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]})]}),l.policy_type==="ROW"&&e.jsxs("div",{style:{marginBottom:o.spacing.md},children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Condition Expression (SQL WHERE clause)"}),e.jsx("textarea",{value:l.condition_expression||"",onChange:s=>y({...l,condition_expression:s.target.value}),placeholder:"e.g., department = 'Sales' AND salary < 50000",rows:3,style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12,resize:"vertical"}})]}),e.jsx("div",{style:{display:"flex",gap:o.spacing.md,alignItems:"center",marginBottom:o.spacing.md},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:o.spacing.xs,fontSize:12,color:n.foreground},children:[e.jsx("input",{type:"checkbox",checked:l.active,onChange:s=>y({...l,active:s.target.checked})}),"Active"]})}),e.jsx(k,{onClick:h,disabled:p,children:"Create Policy"})]}),e.jsxs(b,{style:{marginBottom:o.spacing.lg},children:[e.jsx("h2",{style:{fontSize:14,fontWeight:600,marginBottom:o.spacing.md,color:n.foreground},children:"Filters"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:o.spacing.md},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Schema"}),e.jsx("input",{type:"text",value:t.schema,onChange:s=>r({...t,schema:s.target.value}),placeholder:"Filter by schema",style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Table"}),e.jsx("input",{type:"text",value:t.table,onChange:s=>r({...t,table:s.target.value}),placeholder:"Filter by table",style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:o.spacing.xs,fontSize:12,color:n.muted},children:"Policy Type"}),e.jsxs("select",{value:t.policy_type,onChange:s=>r({...t,policy_type:s.target.value}),style:{width:"100%",padding:o.spacing.sm,background:n.background,border:`1px solid ${n.border}`,color:n.foreground,fontFamily:"Consolas, monospace",fontSize:12},children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"COLUMN",children:"Column"}),e.jsx("option",{value:"ROW",children:"Row"}),e.jsx("option",{value:"TABLE",children:"Table"})]})]})]})]}),e.jsxs(b,{children:[e.jsxs("h2",{style:{fontSize:14,fontWeight:600,marginBottom:o.spacing.md,color:n.foreground},children:["Permission Policies (",x.length,")"]}),p?e.jsx("div",{style:{padding:o.spacing.lg,textAlign:"center",color:n.muted},children:"Loading..."}):x.length===0?e.jsx("div",{style:{padding:o.spacing.lg,textAlign:"center",color:n.muted},children:"No policies found"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:`2px solid ${n.border}`},children:[e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Policy Name"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Type"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Schema"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Table"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Column"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Operation"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Role/User"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Priority"}),e.jsx("th",{style:{padding:o.spacing.sm,textAlign:"left",color:n.accent},children:"Status"})]})}),e.jsx("tbody",{children:x.map(s=>e.jsxs("tr",{style:{borderBottom:`1px solid ${n.border}`},children:[e.jsx("td",{style:{padding:o.spacing.sm},children:s.policy_name}),e.jsx("td",{style:{padding:o.spacing.sm},children:s.policy_type}),e.jsx("td",{style:{padding:o.spacing.sm},children:s.schema_name||"-"}),e.jsx("td",{style:{padding:o.spacing.sm},children:s.table_name||"-"}),e.jsx("td",{style:{padding:o.spacing.sm},children:s.column_name||"-"}),e.jsx("td",{style:{padding:o.spacing.sm},children:s.operation}),e.jsx("td",{style:{padding:o.spacing.sm},children:s.role_name||s.username||"All"}),e.jsx("td",{style:{padding:o.spacing.sm},children:s.priority}),e.jsx("td",{style:{padding:o.spacing.sm},children:e.jsx("span",{style:{color:s.active?n.accent:n.muted},children:s.active?"Active":"Inactive"})})]},s.policy_id))})]})]})]})},V=()=>{const[p,u]=g.useState("masking");return e.jsx("div",{style:{padding:o.spacing.lg},children:e.jsx(b,{children:e.jsxs("div",{style:{marginBottom:o.spacing.lg},children:[e.jsx("h1",{style:{fontSize:18,fontWeight:600,color:n.foreground,marginBottom:o.spacing.md},children:"Security Advanced"}),e.jsx("p",{style:{color:n.muted,fontSize:12,marginBottom:o.spacing.lg},children:"Advanced security features: dynamic masking, tokenization, anonymization, and fine-grained permissions"}),e.jsx("div",{style:{display:"flex",gap:o.spacing.sm,marginBottom:o.spacing.lg,borderBottom:`2px solid ${n.border}`,paddingBottom:o.spacing.sm,flexWrap:"wrap"},children:["masking","tokenization","anonymization","permissions"].map(m=>e.jsxs("button",{onClick:()=>u(m),style:{padding:`${o.spacing.sm} ${o.spacing.md}`,border:"none",background:p===m?n.accent:"transparent",color:p===m?"#ffffff":n.foreground,borderRadius:"2 2 0 0",cursor:"pointer",fontWeight:p===m?600:500,transition:"all 0.15s ease",textTransform:"capitalize",fontFamily:"Consolas, monospace",fontSize:12},onMouseEnter:c=>{p!==m&&(c.currentTarget.style.background=n.backgroundSoft)},onMouseLeave:c=>{p!==m&&(c.currentTarget.style.background="transparent")},children:[m==="masking"&&"Dynamic Masking",m==="tokenization"&&"Tokenization",m==="anonymization"&&"Anonymization",m==="permissions"&&"Fine-Grained Permissions"]},m))}),e.jsxs("div",{style:{minHeight:"400px"},children:[p==="masking"&&e.jsx($,{}),p==="tokenization"&&e.jsx(P,{}),p==="anonymization"&&e.jsx(I,{}),p==="permissions"&&e.jsx(N,{})]})]})})})};export{V as default};
