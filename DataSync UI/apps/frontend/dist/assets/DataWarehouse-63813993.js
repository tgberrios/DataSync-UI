import{r as c,j as e,b as o,e as h,Z as ie,_ as Q}from"./index-b1fa964d.js";import{A as P}from"./AsciiPanel-3399d5be.js";import{A as x}from"./AsciiButton-3fcfdd9b.js";import{u as de}from"./usePagination-05d2e222.js";import{u as ce}from"./useTableFilters-34614e65.js";import{e as Y}from"./errorHandler-5ea9ae85.js";import{s as ue}from"./validation-24839588.js";import{S as ge}from"./SkeletonLoader-09c12074.js";import{A as le}from"./AsciiConnectionStringSelector-7dd1e3aa.js";import"./GCSConnectionConfig-e2d15d83.js";const me=({warehouses:F,onWarehouseClick:u,onWarehouseEdit:n,onWarehouseBuild:H,onWarehouseToggleActive:R,onWarehouseDelete:i})=>{const[v,_]=c.useState(new Set),k=c.useMemo(()=>{const f=new Map;return F.forEach(j=>{const d=j.target_schema||"Other";f.has(d)||f.set(d,{name:d,warehouses:[]}),f.get(d).warehouses.push(j)}),Array.from(f.values()).sort((j,d)=>j.name.localeCompare(d.name))},[F]),S=f=>{_(j=>{const d=new Set(j);return d.has(f)?d.delete(f):d.add(f),d})};return F.length===0?e.jsxs("div",{style:{padding:40,textAlign:"center",color:o.muted,fontFamily:"Consolas"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12,opacity:.4,fontFamily:"Consolas"},children:h.blockFull}),e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas",marginBottom:4},children:"No warehouses found"}),e.jsx("div",{style:{fontSize:11,fontFamily:"Consolas",color:o.muted,opacity:.7},children:"Try adjusting your filters"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:k.map(f=>{const j=v.has(f.name);return e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"10px 14px",cursor:"pointer",backgroundColor:"transparent",borderRadius:2,userSelect:"none",transition:"all 0.2s",border:j?`1px solid ${o.border}`:"1px solid transparent",marginBottom:4},onClick:()=>S(f.name),onMouseEnter:d=>{d.currentTarget.style.backgroundColor=o.backgroundSoft,d.currentTarget.style.borderColor=o.border},onMouseLeave:d=>{d.currentTarget.style.backgroundColor="transparent",d.currentTarget.style.borderColor=j?o.border:"transparent"},children:[e.jsx("span",{style:{marginRight:10,fontSize:12,fontFamily:"Consolas",transition:"transform 0.2s",transform:j?"rotate(90deg)":"rotate(0deg)",color:j?o.accent:o.muted},children:h.arrowRight}),e.jsx("h3",{style:{margin:0,fontSize:13,fontFamily:"Consolas",fontWeight:600,color:j?o.accent:o.foreground,flex:1,transition:"color 0.2s"},children:f.name}),e.jsx("span",{style:{fontSize:11,color:o.muted,fontFamily:"Consolas",padding:"4px 8px",backgroundColor:j?o.accent+"20":"transparent",borderRadius:2,fontWeight:500,transition:"all 0.2s",border:`1px solid ${j?o.accent:o.border}`},children:f.warehouses.length})]}),j&&e.jsx("div",{style:{marginLeft:24,marginTop:6,marginBottom:8,display:"flex",flexDirection:"column",gap:6,paddingLeft:12,borderLeft:`2px solid ${o.border}`},children:f.warehouses.map(d=>e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"10px 12px",cursor:"pointer",borderRadius:2,border:`1px solid ${o.border}`,backgroundColor:"transparent",transition:"all 0.2s",position:"relative"},onMouseEnter:w=>{w.currentTarget.style.backgroundColor=o.backgroundSoft,w.currentTarget.style.borderColor=o.accent,w.currentTarget.style.transform="translateX(4px)",w.currentTarget.style.boxShadow=`0 2px 8px ${o.accent}20`},onMouseLeave:w=>{w.currentTarget.style.backgroundColor="transparent",w.currentTarget.style.borderColor=o.border,w.currentTarget.style.transform="translateX(0)",w.currentTarget.style.boxShadow="none"},onClick:()=>u==null?void 0:u(d),children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas",color:o.foreground,fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginBottom:4},children:d.warehouse_name}),e.jsxs("div",{style:{fontSize:11,color:o.muted,fontFamily:"Consolas",display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:d.schema_type.replace("_"," ")}),e.jsx("span",{style:{color:o.border},children:"•"}),e.jsx("span",{style:{padding:"2px 6px",borderRadius:2,backgroundColor:d.target_layer==="GOLD"?o.backgroundSoft:d.target_layer==="SILVER"?o.backgroundSoft:"transparent",color:d.target_layer==="GOLD"?o.accent:d.target_layer==="SILVER"?o.foreground:o.muted,fontWeight:600,fontSize:10,border:`1px solid ${d.target_layer==="GOLD"?o.accent:d.target_layer==="SILVER"?o.foreground:o.border}`},children:d.target_layer||"BRONZE"}),e.jsx("span",{style:{color:o.border},children:"•"}),e.jsxs("span",{children:[d.dimensions.length,"D"]}),e.jsx("span",{style:{color:o.border},children:"•"}),e.jsxs("span",{children:[d.facts.length,"F"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",marginLeft:12,paddingLeft:12,borderLeft:`1px solid ${o.border}`},children:[e.jsx("span",{style:{padding:"1px 6px",borderRadius:2,fontSize:10,fontWeight:500,backgroundColor:"transparent",color:o.muted,fontFamily:"Consolas",border:`1px solid ${o.border}`},children:d.active?"Active":"Inactive"}),e.jsx("span",{style:{padding:"1px 6px",borderRadius:2,fontSize:10,fontWeight:500,backgroundColor:d.enabled?o.backgroundSoft:"transparent",color:d.enabled?o.accent:o.foreground,fontFamily:"Consolas",border:`1px solid ${d.enabled?o.accent:o.border}`},children:d.enabled?"Enabled":"Disabled"}),d.last_build_status==="SUCCESS"&&e.jsx("span",{style:{fontSize:14,color:o.accent,fontFamily:"Consolas",lineHeight:1},title:"Last build successful",children:"✓"}),d.last_build_status==="ERROR"&&e.jsx("span",{style:{fontSize:14,color:o.foreground,fontFamily:"Consolas",lineHeight:1},title:"Last build failed",children:"✗"}),e.jsxs("div",{style:{display:"flex",gap:4,marginLeft:4},onClick:w=>w.stopPropagation(),children:[n&&e.jsx(x,{label:"Edit",onClick:()=>n(d),variant:"ghost"}),i&&e.jsx(x,{label:"Delete",onClick:()=>i(d.warehouse_name),variant:"ghost"})]})]})]},d.warehouse_name))})]},f.name)})})},G={MariaDB:"host=localhost;user=myuser;password=mypassword;db=mydatabase;port=3306",MSSQL:"DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;DATABASE=mydatabase;UID=myuser;PWD=mypassword",Oracle:"host=localhost;user=myuser;password=mypassword;db=mydatabase;port=1521",PostgreSQL:"postgresql://myuser:mypassword@localhost:5432/mydatabase",MongoDB:"mongodb://myuser:mypassword@localhost:27017/mydatabase",Snowflake:"DRIVER={Snowflake Driver};SERVER=myaccount.snowflakecomputing.com;UID=myuser;PWD=mypassword;WAREHOUSE=mywarehouse;DATABASE=mydatabase;SCHEMA=myschema",BigQuery:JSON.stringify({project_id:"my-project-id",dataset_id:"my_dataset",access_token:"ya29.xxx..."},null,2),Redshift:"postgresql://myuser:mypassword@mycluster.region.redshift.amazonaws.com:5439/mydatabase"},ae={PostgreSQL:`Format: postgresql://user:password@host:port/database
Or: host=hostname;user=username;password=password;db=database;port=5432`,MariaDB:"Format: host=hostname;user=username;password=password;db=database;port=3306",MSSQL:"Format: DRIVER={ODBC Driver 17 for SQL Server};SERVER=hostname,port;DATABASE=database;UID=username;PWD=password",Oracle:"Format: host=hostname;user=username;password=password;db=database;port=1521",MongoDB:"Format: mongodb://user:password@host:port/database",Snowflake:`Format: DRIVER={Snowflake Driver};SERVER=account.snowflakecomputing.com;UID=username;PWD=password;WAREHOUSE=warehouse;DATABASE=database;SCHEMA=schema

Note: Requires Snowflake ODBC driver installed on the server.`,BigQuery:`Format: JSON object with project_id, dataset_id, and access_token

Example:
{
  "project_id": "my-project-id",
  "dataset_id": "my_dataset",
  "access_token": "ya29.xxx..."
}

To get access_token:
1. Use gcloud CLI: gcloud auth application-default print-access-token
2. Or use service account JSON key file path in credentials_json field`,Redshift:`Format: postgresql://user:password@cluster.region.redshift.amazonaws.com:5439/database
Or: host=cluster.region.redshift.amazonaws.com;port=5439;user=username;password=password;db=database`},he=({onClose:F,onSave:u,initialData:n})=>{const H=(n==null?void 0:n.source_db_engine)||"PostgreSQL",R=(n==null?void 0:n.target_db_engine)||"PostgreSQL",[i,v]=c.useState({warehouse_name:(n==null?void 0:n.warehouse_name)||"",description:(n==null?void 0:n.description)||"",schema_type:(n==null?void 0:n.schema_type)||"STAR_SCHEMA",target_layer:(n==null?void 0:n.target_layer)||"BRONZE",source_db_engine:H,source_connection_string:(n==null?void 0:n.source_connection_string)||G[H]||"",target_db_engine:R,target_connection_string:(n==null?void 0:n.target_connection_string)||G[R]||"",target_schema:(n==null?void 0:n.target_schema)||"",schedule_cron:(n==null?void 0:n.schedule_cron)||"",active:(n==null?void 0:n.active)!==void 0?n.active:!0,enabled:(n==null?void 0:n.enabled)!==void 0?n.enabled:!0,metadata:(n==null?void 0:n.metadata)||{}}),[_,k]=c.useState((n==null?void 0:n.dimensions)||[]),[S,f]=c.useState((n==null?void 0:n.facts)||[]),[j,d]=c.useState(null),[w,V]=c.useState(!1),[p,D]=c.useState("basic"),[a,E]=c.useState(!1),[N,B]=c.useState(null),[U,Z]=c.useState(!1),[K,L]=c.useState(null),[A,z]=c.useState(!1),[y,J]=c.useState(null),[T,$]=c.useState({}),[X,ne]=c.useState(!1),ee=c.useCallback(()=>{const r={dimension_name:"",target_schema:i.target_schema||"",target_table:"",scd_type:"TYPE_1",source_query:"",business_keys:[],valid_from_column:"valid_from",valid_to_column:"valid_to",is_current_column:"is_current",index_columns:[],partition_column:""};k([..._,r])},[_,i.target_schema]),O=c.useCallback((r,s,l)=>{k(m=>{const g=[...m];return s==="business_keys"||s==="index_columns"?g[r]={...g[r],[s]:typeof l=="string"?l.split(",").map(C=>C.trim()).filter(C=>C):l}:g[r]={...g[r],[s]:l},g})},[]),oe=c.useCallback(r=>{k(s=>s.filter((l,m)=>m!==r))},[]),re=c.useCallback(()=>{const r={fact_name:"",target_schema:i.target_schema||"",target_table:"",source_query:"",dimension_keys:[],measures:[],index_columns:[],partition_column:""};f([...S,r])},[S,i.target_schema]),q=c.useCallback((r,s,l)=>{f(m=>{const g=[...m];return s==="dimension_keys"||s==="measures"||s==="index_columns"?g[r]={...g[r],[s]:typeof l=="string"?l.split(",").map(C=>C.trim()).filter(C=>C):l}:g[r]={...g[r],[s]:l},g})},[]),t=c.useCallback(r=>{f(s=>s.filter((l,m)=>m!==r))},[]),b=c.useCallback(r=>{const s=G[r]||"";v(l=>{const m=l.source_connection_string.trim(),g=G[l.source_db_engine]||"";return{...l,source_db_engine:r,source_connection_string:!m||m===g?s:m}}),B(null)},[]),I=c.useCallback(r=>{const s=G[r]||"";v(l=>{const m=l.target_connection_string.trim(),g=G[l.target_db_engine]||"";return{...l,target_db_engine:r,target_connection_string:!m||m===g?s:m}}),L(null)},[]),W=c.useCallback(async()=>{if(!i.source_db_engine){B({success:!1,message:"Please select a source database engine first"});return}if(!i.source_connection_string.trim()){B({success:!1,message:"Please enter a source connection string"});return}E(!0),B(null);try{const r=localStorage.getItem("authToken"),s=await fetch("/api/test-connection",{method:"POST",headers:{"Content-Type":"application/json",...r&&{Authorization:`Bearer ${r}`}},body:JSON.stringify({db_engine:i.source_db_engine,connection_string:i.source_connection_string.trim()})});if(!s.ok){if(s.status===401){B({success:!1,message:"Authentication required. Please log in again."});return}if(s.status===0||s.status>=500){B({success:!1,message:"Server error. Please check if the server is running."});return}}let l;try{l=await s.json()}catch{B({success:!1,message:"Invalid response from server"});return}s.ok&&l.success?B({success:!0,message:"Connection successful!"}):B({success:!1,message:l.error||l.message||"Connection failed"})}catch(r){B({success:!1,message:r.message||"Error testing connection"})}finally{E(!1)}},[i.source_db_engine,i.source_connection_string]),M=c.useCallback(async(r,s)=>{const l=r==="dimension"?_[s]:S[s];if(!l.source_query.trim()){$(g=>({...g,[`${r}-${s}`]:{success:!1,message:"Please enter a source query"}}));return}if(!i.source_db_engine||!i.source_connection_string.trim()){$(g=>({...g,[`${r}-${s}`]:{success:!1,message:"Please configure source connection first"}}));return}J({type:r,index:s});const m=`${r}-${s}`;$(g=>({...g,[m]:{success:!1,message:"Testing..."}}));try{const g=await ie.previewQuery({db_engine:i.source_db_engine,connection_string:i.source_connection_string.trim(),query_sql:l.source_query.trim(),limit:10});g.success?$(C=>({...C,[m]:{success:!0,message:`Query successful! Found ${g.rowCount||0} rows. Columns: ${(g.columns||[]).join(", ")}`,data:g}})):$(C=>({...C,[m]:{success:!1,message:g.error||"Query failed"}}))}catch(g){$(C=>({...C,[m]:{success:!1,message:g.message||"Error testing query"}}))}finally{J(null)}},[_,S,i.source_db_engine,i.source_connection_string]),se=c.useCallback(async()=>{if(!i.target_db_engine){L({success:!1,message:"Please select a target database engine first"});return}if(!i.target_connection_string.trim()){L({success:!1,message:"Please enter a target connection string"});return}Z(!0),L(null);try{const r=localStorage.getItem("authToken"),s=await fetch("/api/test-connection",{method:"POST",headers:{"Content-Type":"application/json",...r&&{Authorization:`Bearer ${r}`}},body:JSON.stringify({db_engine:i.target_db_engine,connection_string:i.target_connection_string.trim()})});if(!s.ok){if(s.status===401){L({success:!1,message:"Authentication required. Please log in again."});return}if(s.status===0||s.status>=500){L({success:!1,message:"Server error. Please check if the server is running."});return}}let l;try{l=await s.json()}catch{L({success:!1,message:"Invalid response from server"});return}s.ok&&l.success?L({success:!0,message:"Connection successful!"}):L({success:!1,message:l.error||l.message||"Connection failed"})}catch(r){L({success:!1,message:r.message||"Error testing connection"})}finally{Z(!1)}},[i.target_db_engine,i.target_connection_string]),te=c.useCallback(async()=>{if(d(null),!i.warehouse_name.trim()){d("Warehouse name is required");return}if(!i.target_schema.trim()){d("Target schema is required");return}if(_.length===0&&S.length===0){d("At least one dimension or fact table is required");return}for(const r of _){if(!r.dimension_name.trim()){d("Dimension name is required for all dimensions");return}if(!r.source_query.trim()){d(`Source query is required for dimension: ${r.dimension_name}`);return}if(r.scd_type==="TYPE_2"){if(!r.valid_from_column||!r.valid_to_column||!r.is_current_column){d(`SCD Type 2 requires valid_from, valid_to, and is_current columns for dimension: ${r.dimension_name}`);return}if(r.business_keys.length===0){d(`Business keys are required for SCD Type 2 dimension: ${r.dimension_name}`);return}}}for(const r of S){if(!r.fact_name.trim()){d("Fact name is required for all facts");return}if(!r.source_query.trim()){d(`Source query is required for fact: ${r.fact_name}`);return}}V(!0);try{const r={...i,dimensions:_,facts:S,notes:(n==null?void 0:n.notes)||null};n?(await Q.updateWarehouse(n.warehouse_name,r),u(n,r)):(await Q.createWarehouse(r),u())}catch(r){d(Y(r))}finally{V(!1)}},[i,_,S,n,u]);return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:20},onClick:r=>{r.target===r.currentTarget&&F()},children:e.jsxs("div",{style:{backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:4,width:"90%",maxWidth:1200,maxHeight:"90vh",display:"flex",flexDirection:"column",overflow:"hidden"},onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{style:{padding:"18px 24px",borderBottom:`2px solid ${o.border}`,display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:o.backgroundSoft},children:[e.jsxs("h2",{style:{margin:0,fontSize:14,fontFamily:"Consolas",color:o.foreground,fontWeight:600,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:n?h.blockFull:"+"}),e.jsx("span",{children:n?"Edit Data Warehouse":"Create Data Warehouse"})]}),e.jsx(x,{label:"×",onClick:F,variant:"ghost"})]}),e.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[e.jsxs("div",{style:{width:220,borderRight:`1px solid ${o.border}`,backgroundColor:o.backgroundSoft,padding:"16px 0",display:"flex",flexDirection:"column",gap:4},children:[e.jsxs("div",{style:{padding:"12px 20px",cursor:"pointer",backgroundColor:p==="basic"?o.background:"transparent",borderLeft:p==="basic"?`4px solid ${o.accent}`:"4px solid transparent",fontSize:12,fontFamily:"Consolas",color:p==="basic"?o.accent:o.foreground,fontWeight:p==="basic"?600:400,transition:"all 0.2s",display:"flex",alignItems:"center",gap:8},onClick:()=>D("basic"),onMouseEnter:r=>{p!=="basic"&&(r.currentTarget.style.backgroundColor=o.background)},onMouseLeave:r=>{p!=="basic"&&(r.currentTarget.style.backgroundColor="transparent")},children:[e.jsx("span",{children:h.blockFull}),e.jsx("span",{children:"Basic Info"})]}),e.jsxs("div",{style:{padding:"12px 20px",cursor:"pointer",backgroundColor:p==="dimensions"?o.background:"transparent",borderLeft:p==="dimensions"?`4px solid ${o.accent}`:"4px solid transparent",fontSize:12,fontFamily:"Consolas",color:p==="dimensions"?o.accent:o.foreground,fontWeight:p==="dimensions"?600:400,transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"space-between"},onClick:()=>D("dimensions"),onMouseEnter:r=>{p!=="dimensions"&&(r.currentTarget.style.backgroundColor=o.background)},onMouseLeave:r=>{p!=="dimensions"&&(r.currentTarget.style.backgroundColor="transparent")},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:h.blockFull}),e.jsx("span",{children:"Dimensions"})]}),e.jsx("span",{style:{fontSize:11,padding:"2px 8px",backgroundColor:p==="dimensions"?o.accent+"20":o.background,borderRadius:10,fontWeight:500},children:_.length})]}),e.jsxs("div",{style:{padding:"12px 20px",cursor:"pointer",backgroundColor:p==="facts"?o.background:"transparent",borderLeft:p==="facts"?`4px solid ${o.accent}`:"4px solid transparent",fontSize:12,fontFamily:"Consolas",color:p==="facts"?o.accent:o.foreground,fontWeight:p==="facts"?600:400,transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"space-between"},onClick:()=>D("facts"),onMouseEnter:r=>{p!=="facts"&&(r.currentTarget.style.backgroundColor=o.background)},onMouseLeave:r=>{p!=="facts"&&(r.currentTarget.style.backgroundColor="transparent")},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:h.blockFull}),e.jsx("span",{children:"Facts"})]}),e.jsx("span",{style:{fontSize:11,padding:"2px 8px",backgroundColor:p==="facts"?o.accent+"20":o.background,borderRadius:10,fontWeight:500},children:S.length})]})]}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:24},children:[j&&e.jsxs("div",{style:{padding:"14px 16px",marginBottom:20,backgroundColor:o.danger+"20",border:`1px solid ${o.danger}`,borderRadius:2,color:o.danger,fontSize:12,fontFamily:"Consolas",display:"flex",alignItems:"center",gap:10},children:[e.jsx("span",{style:{fontSize:16},children:"!"}),e.jsx("span",{children:j})]}),p==="basic"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,fontWeight:600,color:o.foreground,marginBottom:8,fontFamily:"Consolas",textTransform:"uppercase",letterSpacing:.5},children:"Warehouse Name *"}),e.jsx("input",{type:"text",value:i.warehouse_name,onChange:r=>v(s=>({...s,warehouse_name:r.target.value})),disabled:!!n,placeholder:"my_warehouse",style:{width:"100%",padding:"10px 14px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:n?o.backgroundSoft:o.background,color:n?o.muted:o.foreground,outline:"none",transition:"border-color 0.2s, box-shadow 0.2s",cursor:n?"not-allowed":"text"},onFocus:r=>{r.currentTarget.style.borderColor=o.accent,r.currentTarget.style.boxShadow=`0 0 0 2px ${o.accent}20`},onBlur:r=>{r.currentTarget.style.borderColor=o.border,r.currentTarget.style.boxShadow="none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,fontWeight:600,color:o.foreground,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase"},children:"Description"}),e.jsx("textarea",{value:i.description,onChange:r=>v(s=>({...s,description:r.target.value})),placeholder:"Description of the data warehouse",rows:3,style:{width:"100%",padding:"8px 12px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none",resize:"vertical"}})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsx("label",{style:{display:"block",fontSize:11,fontWeight:600,color:o.foreground,fontFamily:"Consolas",textTransform:"uppercase"},children:"Schema Type *"}),e.jsx(x,{label:A?"Hide Guide":"Show Guide",onClick:()=>z(!A),variant:"ghost"})]}),A&&e.jsxs("div",{style:{marginBottom:16,padding:16,backgroundColor:o.backgroundSoft,border:`1px solid ${o.border}`,borderRadius:2,fontSize:11,fontFamily:"Consolas"},children:[e.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:13,color:o.accent,fontFamily:"Consolas"},children:"Data Warehouse Schema Guide"}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:13,color:o.foreground,fontFamily:"Consolas",fontWeight:600},children:"What are Dimensions?"}),e.jsxs("p",{style:{margin:"0 0 8px 0",color:o.muted,lineHeight:1.6},children:["Dimensions are descriptive attributes that provide context for analysis. They are things you ",e.jsx("strong",{children:"cannot measure"})," directly, but use to group, filter, and categorize your data."]}),e.jsxs("div",{style:{padding:"8px 12px",backgroundColor:o.background,borderRadius:2,marginTop:8},children:[e.jsx("strong",{style:{color:o.accent},children:"Examples:"})," Customer, Product, Date, Store, Region"]})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:13,color:o.foreground,fontFamily:"Consolas",fontWeight:600},children:"What are Facts?"}),e.jsxs("p",{style:{margin:"0 0 8px 0",color:o.muted,lineHeight:1.6},children:["Facts are numeric measures and business metrics. They are things you ",e.jsx("strong",{children:"can measure"})," - values that can be summed, averaged, counted, etc."]}),e.jsxs("div",{style:{padding:"8px 12px",backgroundColor:o.background,borderRadius:2,marginTop:8},children:[e.jsx("strong",{style:{color:o.accent},children:"Examples:"})," Sales Amount, Quantity, Profit, Revenue, Cost"]})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:13,color:o.foreground,fontFamily:"Consolas",fontWeight:600},children:"Star Schema *"}),e.jsxs("div",{style:{padding:12,backgroundColor:o.background,borderRadius:2,fontFamily:"Consolas",fontSize:10,lineHeight:1.8,marginTop:8},children:[e.jsx("div",{style:{color:o.accent,marginBottom:8},children:"Fact_Sales (Center)"}),e.jsxs("div",{style:{marginLeft:20,color:o.foreground},children:["├─ Dim_Customer (customer_id, name, city, country)",e.jsx("br",{}),"├─ Dim_Product (product_id, name, category, brand)",e.jsx("br",{}),"├─ Dim_Date (date_key, date, month, year)",e.jsx("br",{}),"└─ Measures: sales_amount, quantity, profit"]})]}),e.jsxs("p",{style:{margin:"8px 0 0 0",color:o.muted,fontSize:10,lineHeight:1.5},children:[e.jsx("strong",{children:"Characteristics:"})," Simple, flat dimensions. Fast queries. Some data redundancy in dimensions."]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:13,color:o.foreground,fontFamily:"Consolas",fontWeight:600},children:"Snowflake Schema *"}),e.jsxs("div",{style:{padding:12,backgroundColor:o.background,borderRadius:2,fontFamily:"Consolas",fontSize:10,lineHeight:1.8,marginTop:8},children:[e.jsx("div",{style:{color:o.accent,marginBottom:8},children:"Fact_Sales (Center)"}),e.jsxs("div",{style:{marginLeft:20,color:o.foreground},children:["├─ Dim_Customer → Dim_City → Dim_Country",e.jsx("br",{}),"├─ Dim_Product → Dim_Category → Dim_Brand",e.jsx("br",{}),"├─ Dim_Date → Dim_Month → Dim_Quarter → Dim_Year",e.jsx("br",{}),"└─ Measures: sales_amount, quantity, profit"]})]}),e.jsxs("p",{style:{margin:"8px 0 0 0",color:o.muted,fontSize:10,lineHeight:1.5},children:[e.jsx("strong",{children:"Characteristics:"})," Normalized dimensions with hierarchies. Less storage, but more complex queries. Better for large datasets."]})]}),e.jsxs("div",{style:{marginTop:16,padding:12,backgroundColor:o.accentLight,borderRadius:2,border:`1px solid ${o.accent}`},children:[e.jsx("strong",{style:{color:o.accent,display:"block",marginBottom:4},children:"Quick Example:"}),e.jsxs("div",{style:{color:o.foreground,fontSize:10,lineHeight:1.6},children:['"How much did we sell (Fact) by customer (Dimension) in January (Dimension)?"',e.jsx("br",{}),"The ",e.jsx("strong",{children:"Fact"})," contains the numbers (sales amount), the ",e.jsx("strong",{children:"Dimensions"})," provide the context (who, when)."]})]})]}),e.jsxs("select",{value:i.schema_type,onChange:r=>v(s=>({...s,schema_type:r.target.value})),style:{width:"100%",padding:"8px 12px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none"},children:[e.jsx("option",{value:"STAR_SCHEMA",children:"Star Schema *"}),e.jsx("option",{value:"SNOWFLAKE_SCHEMA",children:"Snowflake Schema *"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,fontWeight:600,color:o.foreground,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase"},children:"Medallion Layer *"}),e.jsxs("select",{value:i.target_layer,onChange:r=>v(s=>({...s,target_layer:r.target.value})),style:{width:"100%",padding:"8px 12px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none"},children:[e.jsx("option",{value:"BRONZE",children:"BRONZE (Raw Data)"}),e.jsx("option",{value:"SILVER",children:"SILVER (Cleaned/Validated)"}),e.jsx("option",{value:"GOLD",children:"GOLD (Business-Ready)"})]}),e.jsx("div",{style:{marginTop:6,fontSize:10,color:o.muted,fontFamily:"Consolas",lineHeight:1.4},children:"BRONZE: Raw data from source | SILVER: Cleaned & validated | GOLD: Business-ready analytics"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,fontWeight:600,color:o.foreground,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase"},children:"Source DB Engine *"}),e.jsxs("select",{value:i.source_db_engine,onChange:r=>b(r.target.value),style:{width:"100%",padding:"8px 12px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none"},children:[e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"MariaDB",children:"MariaDB"}),e.jsx("option",{value:"MSSQL",children:"MSSQL"}),e.jsx("option",{value:"Oracle",children:"Oracle"}),e.jsx("option",{value:"MongoDB",children:"MongoDB"})]})]}),e.jsx("div",{children:e.jsx(le,{value:i.source_connection_string,onChange:r=>{v(s=>({...s,source_connection_string:r})),B(null)},dbEngine:i.source_db_engine,label:"Source Connection String",required:!0,onTestConnection:W,isTesting:a,testResult:N,placeholder:G[i.source_db_engine]||"Enter connection string..."})}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,fontWeight:600,color:o.foreground,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase"},children:"Target DB Engine *"}),e.jsxs("select",{value:i.target_db_engine,onChange:r=>I(r.target.value),style:{width:"100%",padding:"8px 12px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none"},children:[e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"Snowflake",children:"Snowflake"}),e.jsx("option",{value:"BigQuery",children:"BigQuery"}),e.jsx("option",{value:"Redshift",children:"Redshift"})]})]}),e.jsxs("div",{children:[X&&i.target_db_engine&&ae[i.target_db_engine]&&e.jsxs("div",{style:{padding:"12px",marginBottom:8,backgroundColor:o.background,border:`1px solid ${o.border}`,borderRadius:2,fontSize:11,fontFamily:"Consolas",color:o.foreground,whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto"},children:[e.jsxs("div",{style:{fontWeight:600,marginBottom:8,color:o.accent},children:[i.target_db_engine," Connection Format:"]}),ae[i.target_db_engine]]}),e.jsx(le,{value:i.target_connection_string,onChange:r=>{v(s=>({...s,target_connection_string:r})),L(null)},dbEngine:i.target_db_engine,label:"Target Connection String",required:!0,onTestConnection:se,isTesting:U,testResult:K?{success:K.success,message:K.message}:null})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,fontWeight:600,color:o.foreground,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase"},children:"Target Schema *"}),e.jsx("input",{type:"text",value:i.target_schema,onChange:r=>{const s=r.target.value;v(l=>({...l,target_schema:s})),k(l=>l.map(m=>({...m,target_schema:s}))),f(l=>l.map(m=>({...m,target_schema:s})))},placeholder:"warehouse_schema",style:{width:"100%",padding:"8px 12px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,fontWeight:600,color:o.foreground,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase"},children:"Schedule (Cron)"}),e.jsx("input",{type:"text",value:i.schedule_cron,onChange:r=>v(s=>({...s,schedule_cron:r.target.value})),placeholder:"Leave empty for manual execution, or enter Cron: * * * * *",style:{width:"100%",padding:"8px 12px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{style:{display:"flex",gap:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("input",{type:"checkbox",checked:i.active,onChange:r=>v(s=>({...s,active:r.target.checked})),style:{width:18,height:18,cursor:"pointer"}}),e.jsx("label",{style:{fontSize:12,fontFamily:"Consolas",color:o.foreground,cursor:"pointer"},children:"Active"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("input",{type:"checkbox",checked:i.enabled,onChange:r=>v(s=>({...s,enabled:r.target.checked})),style:{width:18,height:18,cursor:"pointer"}}),e.jsx("label",{style:{fontSize:12,fontFamily:"Consolas",color:o.foreground,cursor:"pointer"},children:"Enabled"})]})]})]}),p==="dimensions"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0,fontSize:13,fontFamily:"Consolas",color:o.foreground},children:"Dimensions"}),e.jsx(x,{label:"+ Add Dimension",onClick:ee})]}),_.length===0?e.jsxs("div",{style:{padding:40,textAlign:"center",color:o.muted},children:[e.jsx("div",{style:{fontSize:32,marginBottom:8,fontFamily:"Consolas"},children:h.blockFull}),e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas"},children:"No dimensions defined"}),e.jsx("div",{style:{fontSize:11,marginTop:4},children:'Click "Add Dimension" to create one'})]}):_.map((r,s)=>e.jsxs("div",{style:{border:`1px solid ${o.border}`,borderRadius:2,padding:16,backgroundColor:o.backgroundSoft},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("h3",{style:{margin:0,fontSize:13,fontFamily:"Consolas",color:o.accent},children:["Dimension ",s+1]}),e.jsx(x,{label:"[X] Remove",onClick:()=>oe(s),variant:"ghost"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Dimension Name *"}),e.jsx("input",{type:"text",value:r.dimension_name,onChange:l=>O(s,"dimension_name",l.target.value),placeholder:"dim_customer",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Target Table *"}),e.jsx("input",{type:"text",value:r.target_table,onChange:l=>O(s,"target_table",l.target.value),placeholder:"dim_customer",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"SCD Type *"}),e.jsxs("select",{value:r.scd_type,onChange:l=>O(s,"scd_type",l.target.value),style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none"},children:[e.jsx("option",{value:"TYPE_1",children:"Type 1 (Overwrite)"}),e.jsx("option",{value:"TYPE_2",children:"Type 2 (Historical)"}),e.jsx("option",{value:"TYPE_3",children:"Type 3 (Previous Value)"})]})]}),r.scd_type==="TYPE_2"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Business Keys (comma-separated) *"}),e.jsx("input",{type:"text",value:r.business_keys.join(", "),onChange:l=>O(s,"business_keys",l.target.value),placeholder:"customer_id, order_id",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Valid From Column"}),e.jsx("input",{type:"text",value:r.valid_from_column,onChange:l=>O(s,"valid_from_column",l.target.value),placeholder:"valid_from",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Valid To Column"}),e.jsx("input",{type:"text",value:r.valid_to_column,onChange:l=>O(s,"valid_to_column",l.target.value),placeholder:"valid_to",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Is Current Column"}),e.jsx("input",{type:"text",value:r.is_current_column,onChange:l=>O(s,"is_current_column",l.target.value),placeholder:"is_current",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,fontFamily:"Consolas"},children:"Source Query (SQL) *"}),e.jsx(x,{label:(y==null?void 0:y.type)==="dimension"&&(y==null?void 0:y.index)===s?"Testing...":"Test Query",onClick:()=>M("dimension",s),variant:"ghost",disabled:(y==null?void 0:y.type)==="dimension"&&(y==null?void 0:y.index)===s||!r.source_query.trim()||!i.source_db_engine||!i.source_connection_string.trim()})]}),T[`dimension-${s}`]&&e.jsxs("div",{style:{padding:"8px 12px",marginBottom:8,backgroundColor:T[`dimension-${s}`].success?o.success+"20":o.danger+"20",border:`1px solid ${T[`dimension-${s}`].success?o.success:o.danger}`,borderRadius:2,color:T[`dimension-${s}`].success?o.success:o.danger,fontSize:11,fontFamily:"Consolas"},children:[T[`dimension-${s}`].success?"[OK] ":"[ERR] ",T[`dimension-${s}`].message]}),e.jsx("textarea",{value:r.source_query,onChange:l=>{O(s,"source_query",l.target.value);const m=`dimension-${s}`;T[m]&&$(g=>{const C={...g};return delete C[m],C})},placeholder:"SELECT * FROM source_table WHERE ...",rows:6,style:{width:"100%",padding:"8px 12px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none",resize:"vertical"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Index Columns (comma-separated, optional)"}),e.jsx("input",{type:"text",value:r.index_columns.join(", "),onChange:l=>O(s,"index_columns",l.target.value),placeholder:"customer_id, order_date",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Partition Column (optional)"}),e.jsx("input",{type:"text",value:r.partition_column,onChange:l=>O(s,"partition_column",l.target.value),placeholder:"created_date",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]})]})]},s))]}),p==="facts"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0,fontSize:13,fontFamily:"Consolas",color:o.foreground},children:"Fact Tables"}),e.jsx(x,{label:"+ Add Fact Table",onClick:re})]}),S.length===0?e.jsxs("div",{style:{padding:40,textAlign:"center",color:o.muted},children:[e.jsx("div",{style:{fontSize:32,marginBottom:8,fontFamily:"Consolas"},children:h.blockFull}),e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas"},children:"No fact tables defined"}),e.jsx("div",{style:{fontSize:11,marginTop:4},children:'Click "Add Fact Table" to create one'})]}):S.map((r,s)=>e.jsxs("div",{style:{border:`1px solid ${o.border}`,borderRadius:2,padding:16,backgroundColor:o.backgroundSoft},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("h3",{style:{margin:0,fontSize:13,fontFamily:"Consolas",color:o.accent},children:["Fact Table ",s+1]}),e.jsx(x,{label:"[X] Remove",onClick:()=>t(s),variant:"ghost"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Fact Name *"}),e.jsx("input",{type:"text",value:r.fact_name,onChange:l=>q(s,"fact_name",l.target.value),placeholder:"fact_sales",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Target Table *"}),e.jsx("input",{type:"text",value:r.target_table,onChange:l=>q(s,"target_table",l.target.value),placeholder:"fact_sales",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,fontFamily:"Consolas"},children:"Source Query (SQL) *"}),e.jsx(x,{label:(y==null?void 0:y.type)==="fact"&&(y==null?void 0:y.index)===s?"Testing...":"Test Query",onClick:()=>M("fact",s),variant:"ghost",disabled:(y==null?void 0:y.type)==="fact"&&(y==null?void 0:y.index)===s||!r.source_query.trim()||!i.source_db_engine||!i.source_connection_string.trim()})]}),T[`fact-${s}`]&&e.jsxs("div",{style:{padding:"8px 12px",marginBottom:8,backgroundColor:T[`fact-${s}`].success?o.success+"20":o.danger+"20",border:`1px solid ${T[`fact-${s}`].success?o.success:o.danger}`,borderRadius:2,color:T[`fact-${s}`].success?o.success:o.danger,fontSize:11,fontFamily:"Consolas"},children:[T[`fact-${s}`].success?"[OK] ":"[ERR] ",T[`fact-${s}`].message]}),e.jsx("textarea",{value:r.source_query,onChange:l=>{q(s,"source_query",l.target.value);const m=`fact-${s}`;T[m]&&$(g=>{const C={...g};return delete C[m],C})},placeholder:"SELECT d1.dim_key, d2.dim_key, SUM(amount) as total_amount FROM ...",rows:8,style:{width:"100%",padding:"8px 12px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none",resize:"vertical"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Dimension Keys (comma-separated, optional)"}),e.jsx("input",{type:"text",value:r.dimension_keys.join(", "),onChange:l=>q(s,"dimension_keys",l.target.value),placeholder:"customer_key, product_key, date_key",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Measures (comma-separated, optional)"}),e.jsx("input",{type:"text",value:r.measures.join(", "),onChange:l=>q(s,"measures",l.target.value),placeholder:"total_amount, quantity, discount",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Index Columns (comma-separated, optional)"}),e.jsx("input",{type:"text",value:r.index_columns.join(", "),onChange:l=>q(s,"index_columns",l.target.value),placeholder:"customer_key, date_key",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas"},children:"Partition Column (optional)"}),e.jsx("input",{type:"text",value:r.partition_column,onChange:l=>q(s,"partition_column",l.target.value),placeholder:"sale_date",style:{width:"100%",padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"}})]})]})]},s))]})]})]}),e.jsxs("div",{style:{padding:"18px 24px",borderTop:`2px solid ${o.border}`,display:"flex",justifyContent:"flex-end",gap:12,backgroundColor:o.backgroundSoft},children:[e.jsx(x,{label:"Cancel",onClick:F,variant:"ghost"}),e.jsx(x,{label:w?"Saving...":n?"Update":"Create",onClick:te,disabled:w})]})]})})},pe=({warehouseName:F,currentLayer:u,onClose:n,onCleanup:H})=>{const[R,i]=c.useState(new Set),[v,_]=c.useState(!1),[k,S]=c.useState(null),f=["BRONZE","SILVER","GOLD"].filter(a=>a!==u),j=a=>{i(E=>{const N=new Set(E);return N.has(a)?N.delete(a):N.add(a),N})},d=()=>{i(new Set(f))},w=()=>{i(new Set)},V=async()=>{if(R.size===0){S("Please select at least one layer to clean up");return}const a=Array.from(R).join(", ");if(confirm(`Are you sure you want to delete the following layer schemas for "${F}"?

Layers: ${a}

This will permanently delete all data in those schemas and cannot be undone.`)){_(!0),S(null);try{await H(Array.from(R)),n()}catch(E){S(E instanceof Error?E.message:"Failed to clean up layers")}finally{_(!1)}}},p=a=>{switch(a){case"BRONZE":return"Raw Data";case"SILVER":return"Cleaned & Validated";case"GOLD":return"Business-Ready";default:return""}},D=a=>{switch(a){case"BRONZE":return o.muted;case"SILVER":return o.accent;case"GOLD":return o.success;default:return o.foreground}};return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:20},onClick:a=>{a.target===a.currentTarget&&n()},children:e.jsx("div",{style:{backgroundColor:o.background,border:`2px solid ${o.border}`,borderRadius:2,width:"90%",maxWidth:600,maxHeight:"90vh",overflowY:"auto"},onClick:a=>a.stopPropagation(),children:e.jsx(P,{title:"CLEANUP PREVIOUS LAYERS",children:e.jsxs("div",{style:{padding:16,fontFamily:"Consolas",fontSize:12},children:[e.jsxs("div",{style:{marginBottom:20},children:[e.jsxs("div",{style:{fontSize:11,color:o.muted,marginBottom:8,fontFamily:"Consolas"},children:["Warehouse: ",e.jsx("strong",{style:{color:o.foreground},children:F})]}),e.jsxs("div",{style:{fontSize:11,color:o.muted,marginBottom:12,fontFamily:"Consolas"},children:["Current Layer: ",e.jsx("strong",{style:{color:D(u)},children:u})," (",p(u),")"]}),e.jsxs("div",{style:{fontSize:11,color:o.muted,fontFamily:"Consolas",lineHeight:1.5},children:["Select the layer schemas you want to delete. The current layer (",u,") cannot be deleted."]})]}),k&&e.jsxs("div",{style:{marginBottom:16,padding:"10px 12px",backgroundColor:o.danger+"20",border:`1px solid ${o.danger}`,borderRadius:2,color:o.danger,fontSize:11,fontFamily:"Consolas",wordBreak:"break-word",lineHeight:1.4},children:[e.jsx("strong",{children:"Error:"})," ",k]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:o.foreground,fontFamily:"Consolas",textTransform:"uppercase",letterSpacing:.5},children:"Available Layers"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx(x,{label:"Select All",onClick:d,variant:"ghost"}),e.jsx(x,{label:"Deselect All",onClick:w,variant:"ghost"})]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:f.map(a=>{const E=R.has(a),B=`${F.toLowerCase().replace(/\s+/g,"_")}_${a.toLowerCase()}`;return e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,padding:"10px 12px",backgroundColor:E?o.accent+"20":"transparent",border:`1px solid ${E?o.accent:o.border}`,borderRadius:2,cursor:"pointer",fontFamily:"Consolas",fontSize:12,transition:"all 0.2s"},onMouseEnter:U=>{E||(U.currentTarget.style.borderColor=o.accent)},onMouseLeave:U=>{E||(U.currentTarget.style.borderColor=o.border)},children:[e.jsx("input",{type:"checkbox",checked:E,onChange:()=>j(a),style:{width:16,height:16,cursor:"pointer",accentColor:o.accent}}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[e.jsx("span",{style:{fontWeight:600,color:D(a),fontSize:12},children:a}),e.jsxs("span",{style:{fontSize:10,color:o.muted},children:["(",p(a),")"]})]}),e.jsxs("div",{style:{fontSize:10,color:o.muted,fontFamily:"Consolas"},children:["Schema: ",e.jsx("code",{style:{color:o.accent,backgroundColor:o.background,padding:"2px 4px",borderRadius:2},children:B})]})]})]},a)})})]}),R.size>0&&e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:o.warning+"20",border:`1px solid ${o.warning}`,borderRadius:2,fontSize:11,fontFamily:"Consolas",color:o.foreground,lineHeight:1.5},children:[e.jsx("strong",{style:{color:o.warning},children:"Warning:"})," This action will permanently delete ",R.size," layer schema",R.size>1?"s":""," and all data within them. This cannot be undone."]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:12,paddingTop:12,borderTop:`1px solid ${o.border}`},children:[e.jsx(x,{label:"Cancel",onClick:n,variant:"ghost",disabled:v}),e.jsx(x,{label:v?"Cleaning...":`Delete ${R.size>0?`${R.size} `:""}Layer${R.size!==1?"s":""}`,onClick:V,disabled:v||R.size===0})]})]})})})})},Re=()=>{const{setPage:F}=de(1,20),{filters:u,setFilter:n}=ce({schema_type:"",source_db_engine:"",target_db_engine:"",active:"",enabled:""}),[H,R]=c.useState(""),[i,v]=c.useState(""),[_,k]=c.useState(null),[S,f]=c.useState([]),[j,d]=c.useState(!0),[w,V]=c.useState(!1),[p,D]=c.useState(null),[a,E]=c.useState(null),[N,B]=c.useState(!1),[U,Z]=c.useState(!1),[K,L]=c.useState(!1),A=c.useRef(!0),z=c.useCallback(async()=>{if(!A.current)return;const t=Date.now(),b=300;try{d(!0),k(null);const W={page:1,limit:1e4,search:ue(i,100)};u.schema_type&&(W.schema_type=u.schema_type),u.source_db_engine&&(W.source_db_engine=u.source_db_engine),u.target_db_engine&&(W.target_db_engine=u.target_db_engine),u.active&&(W.active=u.active),u.enabled&&(W.enabled=u.enabled);const M=await Q.getWarehouses(W),se=Date.now()-t,te=Math.max(0,b-se);await new Promise(r=>setTimeout(r,te)),A.current&&f(M.warehouses||[])}catch(I){A.current&&k(Y(I))}finally{A.current&&d(!1)}},[i,u]);c.useEffect(()=>(A.current=!0,z(),()=>{A.current=!1}),[z]);const y=c.useCallback(()=>{v(H),F(1)},[H,F]),J=c.useCallback(t=>{t.key==="Enter"&&y()},[y]),T=c.useCallback(async t=>{var W;const b=S.find(M=>M.warehouse_name===t);if(!b)return;const I=`Are you sure you want to delete warehouse "${t}"?

This will delete the warehouse from the catalog.

IMPORTANT: Remember to manually delete the target schemas if no longer needed:
   Schemas: ${b.target_schema}_bronze, ${b.target_schema}_silver, ${b.target_schema}_gold
   Database: ${b.target_db_engine}
   Connection: ${(W=b.target_connection_string)==null?void 0:W.substring(0,50)}...

This action cannot be undone.`;if(confirm(I))try{await Q.deleteWarehouse(t),await z(),(a==null?void 0:a.warehouse_name)===t&&E(null);const M=`Warehouse "${t}" deleted successfully.

REMINDER: Don't forget to manually delete the target schemas if no longer needed:
   DROP SCHEMA IF EXISTS "${b.target_schema}_bronze" CASCADE;
   DROP SCHEMA IF EXISTS "${b.target_schema}_silver" CASCADE;
   DROP SCHEMA IF EXISTS "${b.target_schema}_gold" CASCADE;
   (In database: ${b.target_db_engine})`;alert(M)}catch(M){A.current&&k(Y(M))}},[S,a,z]),$=c.useCallback(t=>{D(t||null),V(!0)},[]),X=c.useCallback(()=>{V(!1),D(null)},[]),ne=c.useCallback(async(t,b)=>{if(await z(),X(),t&&b&&t.target_schema!==b.target_schema){let I=`Warehouse "${t.warehouse_name}" updated successfully.`;I+=`

REMINDER: The target schema has changed.
   Old schema: ${t.target_schema}
   New schema: ${b.target_schema}

   Consider manually deleting the old schemas if no longer needed:
   DROP SCHEMA IF EXISTS "${t.target_schema}_bronze" CASCADE;
   DROP SCHEMA IF EXISTS "${t.target_schema}_silver" CASCADE;
   DROP SCHEMA IF EXISTS "${t.target_schema}_gold" CASCADE;`,alert(I)}},[z,X]),ee=c.useCallback(async(t,b)=>{try{await Q.updateActive(t,!b),z()}catch(I){A.current&&k(Y(I))}},[z]),O=c.useCallback(async t=>{try{k(null),await Q.buildWarehouse(t),z(),setTimeout(()=>{z()},2e3)}catch(b){A.current&&k(Y(b))}},[z]),oe=c.useCallback(async t=>{E(t),k(null)},[]),re=c.useCallback(async t=>{if(a)try{k(null),await Q.cleanupLayers(a.warehouse_name,t),z()}catch(b){throw A.current&&k(Y(b)),b}},[a,z]),q=S.filter(t=>!(u.schema_type&&t.schema_type!==u.schema_type||u.source_db_engine&&t.source_db_engine!==u.source_db_engine||u.target_db_engine&&t.target_db_engine!==u.target_db_engine||u.active&&String(t.active)!==u.active||u.enabled&&String(t.enabled)!==u.enabled));return j&&S.length===0?e.jsx(ge,{variant:"table"}):e.jsxs("div",{style:{padding:"20px",fontFamily:"Consolas",fontSize:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:0,color:o.foreground,textTransform:"uppercase",fontFamily:"Consolas"},children:[e.jsx("span",{style:{color:o.accent,marginRight:8},children:h.blockFull}),"DATA WAREHOUSE"]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx(x,{label:"Data Warehouse Playbook",onClick:()=>Z(!0),variant:"ghost"}),e.jsx(x,{label:"Medallion Architecture Playbook",onClick:()=>B(!0),variant:"ghost"})]})]}),_&&e.jsx("div",{style:{marginBottom:20},children:e.jsx(P,{title:"ERROR",children:e.jsx("div",{style:{padding:"12px",color:o.foreground,fontSize:12,fontFamily:"Consolas",border:`2px solid ${o.foreground}`},children:_})})}),e.jsx(P,{title:"SEARCH",children:e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",padding:"8px 0"},children:[e.jsx("input",{type:"text",placeholder:"Search by warehouse name, schema, or target...",value:H,onChange:t=>R(t.target.value),onKeyPress:J,style:{flex:1,padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none"},onFocus:t=>{t.currentTarget.style.borderColor=o.accent},onBlur:t=>{t.currentTarget.style.borderColor=o.border}}),e.jsx(x,{label:"Search",onClick:y,variant:"primary"}),i&&e.jsx(x,{label:"Clear",onClick:()=>{R(""),v(""),F(1)},variant:"ghost"})]})}),e.jsx("div",{style:{marginTop:20},children:e.jsx(P,{title:"FILTERS",children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,padding:"8px 0"},children:[e.jsx(x,{label:"Add Warehouse",onClick:()=>$(),variant:"primary"}),e.jsxs("select",{value:u.schema_type,onChange:t=>n("schema_type",t.target.value),style:{padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none"},onFocus:t=>{t.currentTarget.style.borderColor=o.accent},onBlur:t=>{t.currentTarget.style.borderColor=o.border},children:[e.jsx("option",{value:"",children:"All Schemas"}),e.jsx("option",{value:"STAR_SCHEMA",children:"Star Schema"}),e.jsx("option",{value:"SNOWFLAKE_SCHEMA",children:"Snowflake Schema"})]}),e.jsxs("select",{value:u.source_db_engine,onChange:t=>n("source_db_engine",t.target.value),style:{padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none"},onFocus:t=>{t.currentTarget.style.borderColor=o.accent},onBlur:t=>{t.currentTarget.style.borderColor=o.border},children:[e.jsx("option",{value:"",children:"All Sources"}),e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"MariaDB",children:"MariaDB"}),e.jsx("option",{value:"MSSQL",children:"MSSQL"}),e.jsx("option",{value:"Oracle",children:"Oracle"}),e.jsx("option",{value:"MongoDB",children:"MongoDB"}),e.jsx("option",{value:"DB2",children:"DB2"}),e.jsx("option",{value:"Salesforce",children:"Salesforce"}),e.jsx("option",{value:"SAP",children:"SAP"}),e.jsx("option",{value:"Teradata",children:"Teradata"}),e.jsx("option",{value:"Netezza",children:"Netezza"}),e.jsx("option",{value:"Hive",children:"Hive"}),e.jsx("option",{value:"Cassandra",children:"Cassandra"}),e.jsx("option",{value:"DynamoDB",children:"DynamoDB"}),e.jsx("option",{value:"AS400",children:"AS/400"}),e.jsx("option",{value:"S3",children:"S3"}),e.jsx("option",{value:"AzureBlob",children:"Azure Blob"}),e.jsx("option",{value:"GCS",children:"Google Cloud Storage"}),e.jsx("option",{value:"FTP",children:"FTP"}),e.jsx("option",{value:"SFTP",children:"SFTP"}),e.jsx("option",{value:"Email",children:"Email"}),e.jsx("option",{value:"SOAP",children:"SOAP"}),e.jsx("option",{value:"GraphQL",children:"GraphQL"}),e.jsx("option",{value:"Excel",children:"Excel"}),e.jsx("option",{value:"FixedWidth",children:"Fixed Width"}),e.jsx("option",{value:"EBCDIC",children:"EBCDIC"}),e.jsx("option",{value:"XML",children:"XML"}),e.jsx("option",{value:"Avro",children:"Avro"}),e.jsx("option",{value:"Parquet",children:"Parquet"}),e.jsx("option",{value:"ORC",children:"ORC"}),e.jsx("option",{value:"Compressed",children:"Compressed"})]}),e.jsxs("select",{value:u.target_db_engine,onChange:t=>n("target_db_engine",t.target.value),style:{padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none"},onFocus:t=>{t.currentTarget.style.borderColor=o.accent},onBlur:t=>{t.currentTarget.style.borderColor=o.border},children:[e.jsx("option",{value:"",children:"All Targets"}),e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"Snowflake",children:"Snowflake"}),e.jsx("option",{value:"BigQuery",children:"BigQuery"}),e.jsx("option",{value:"Redshift",children:"Redshift"})]}),e.jsxs("select",{value:u.active,onChange:t=>n("active",t.target.value),style:{padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none"},onFocus:t=>{t.currentTarget.style.borderColor=o.accent},onBlur:t=>{t.currentTarget.style.borderColor=o.border},children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]}),e.jsxs("select",{value:u.enabled,onChange:t=>n("enabled",t.target.value),style:{padding:"6px 10px",border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none"},onFocus:t=>{t.currentTarget.style.borderColor=o.accent},onBlur:t=>{t.currentTarget.style.borderColor=o.border},children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"true",children:"Enabled"}),e.jsx("option",{value:"false",children:"Disabled"})]})]})})}),j?e.jsx("div",{style:{marginTop:20},children:e.jsx(P,{title:"LOADING",children:e.jsxs("div",{style:{padding:"40px",textAlign:"center",fontSize:12,fontFamily:"Consolas",color:o.muted},children:[h.blockFull," Loading tree view..."]})})}):e.jsxs("div",{style:{marginTop:20,display:"flex",gap:20,alignItems:"stretch"},children:[e.jsx("div",{style:{flex:"0 0 400px",display:"flex",flexDirection:"column"},children:e.jsx(P,{title:"WAREHOUSE TREE",children:e.jsx("div",{style:{minHeight:300,maxHeight:800,overflowY:"auto",overflowX:"hidden",fontFamily:"Consolas",fontSize:12},children:e.jsx(me,{warehouses:q,onWarehouseClick:oe,onWarehouseEdit:$,onWarehouseBuild:O,onWarehouseToggleActive:ee,onWarehouseDelete:T})})})}),e.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:a?e.jsxs(P,{title:`WAREHOUSE DETAILS: ${a.warehouse_name}`,children:[a.description&&e.jsx("p",{style:{margin:0,marginBottom:16,fontSize:12,color:o.muted,fontFamily:"Consolas",lineHeight:1.5},children:a.description}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:16,marginBottom:20,padding:"16px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase",letterSpacing:.5},children:"Schema Type"}),e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas",fontWeight:500},children:a.schema_type.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase",letterSpacing:.5},children:"Source Engine"}),e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas",fontWeight:500},children:a.source_db_engine})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase",letterSpacing:.5},children:"Target Engine"}),e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas",fontWeight:500},children:a.target_db_engine})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase",letterSpacing:.5},children:"Medallion Layer"}),e.jsxs("div",{style:{fontSize:12,fontFamily:"Consolas",fontWeight:600,color:a.target_layer==="GOLD"?o.accent:a.target_layer==="SILVER"?o.foreground:o.muted},children:[a.target_layer||"BRONZE",a.target_layer==="BRONZE"&&" (Raw Data)",a.target_layer==="SILVER"&&" (Cleaned & Validated)",a.target_layer==="GOLD"&&" (Business-Ready)"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase",letterSpacing:.5},children:"Target Schema"}),e.jsxs("div",{style:{fontSize:12,fontFamily:"Consolas",fontWeight:500},children:[a.target_schema,a.target_layer&&e.jsxs("span",{style:{fontSize:10,color:o.muted,marginLeft:8},children:["(Layer: ",a.target_layer.toLowerCase(),")"]})]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase",letterSpacing:.5},children:"Build Status"}),e.jsxs("div",{style:{fontSize:12,fontFamily:"Consolas",fontWeight:500,color:a.last_build_status==="SUCCESS"?o.accent:a.last_build_status==="ERROR"?o.foreground:o.muted,display:"flex",alignItems:"center",gap:6},children:[a.last_build_status==="SUCCESS"&&e.jsx("span",{children:"✓"}),a.last_build_status==="ERROR"&&e.jsx("span",{children:"✗"}),e.jsx("span",{children:a.last_build_status||"Never built"})]}),a.last_build_status==="ERROR"&&a.notes&&e.jsxs("div",{style:{marginTop:8,padding:"10px 12px",backgroundColor:o.backgroundSoft,border:`2px solid ${o.foreground}`,borderRadius:2,color:o.foreground,fontSize:11,fontFamily:"Consolas",wordBreak:"break-word",lineHeight:1.4},children:[e.jsx("strong",{children:"Error:"})," ",a.notes]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:6,fontFamily:"Consolas",textTransform:"uppercase",letterSpacing:.5},children:"Last Build"}),e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas",fontWeight:500},children:a.last_build_time?new Date(a.last_build_time).toLocaleString():"N/A"})]})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginBottom:20,padding:"12px 16px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas",textTransform:"uppercase",letterSpacing:.5},children:"Dimensions"}),e.jsx("div",{style:{fontSize:18,fontFamily:"Consolas",fontWeight:600,color:o.accent},children:a.dimensions.length})]}),e.jsx("div",{style:{width:1,backgroundColor:o.border}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:11,color:o.muted,marginBottom:4,fontFamily:"Consolas",textTransform:"uppercase",letterSpacing:.5},children:"Facts"}),e.jsx("div",{style:{fontSize:18,fontFamily:"Consolas",fontWeight:600,color:o.accent},children:a.facts.length})]})]}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx(x,{label:"▶ Build Now",onClick:()=>O(a.warehouse_name)}),e.jsx(x,{label:"Edit",onClick:()=>$(a),variant:"ghost"}),(a.target_layer==="SILVER"||a.target_layer==="GOLD")&&e.jsx(x,{label:"Cleanup Layers",onClick:()=>L(!0),variant:"ghost"})]})]}):e.jsx(P,{title:"WAREHOUSE DETAILS",children:e.jsxs("div",{style:{padding:60,textAlign:"center",color:o.muted,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300,fontFamily:"Consolas",fontSize:12},children:[e.jsx("div",{style:{fontSize:48,marginBottom:16,opacity:.5},children:h.blockFull}),e.jsx("div",{style:{fontSize:13,fontFamily:"Consolas",marginBottom:8,color:o.foreground,fontWeight:600},children:"No warehouse selected"}),e.jsx("div",{style:{fontSize:12,color:o.muted,fontFamily:"Consolas",opacity:.7},children:"Click on a warehouse from the list to see its configuration and build history"})]})})})]}),w&&e.jsx(he,{onClose:X,onSave:ne,initialData:p}),K&&a&&e.jsx(pe,{warehouseName:a.warehouse_name,currentLayer:a.target_layer||"BRONZE",onClose:()=>L(!1),onCleanup:re}),N&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>B(!1),children:e.jsx("div",{style:{width:"90%",maxWidth:1e3,maxHeight:"90vh",overflowY:"auto"},onClick:t=>t.stopPropagation(),children:e.jsx(P,{title:"MEDALLION ARCHITECTURE PLAYBOOK",children:e.jsxs("div",{style:{padding:16,fontFamily:"Consolas",fontSize:12,lineHeight:1.6},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[h.blockFull," OVERVIEW"]}),e.jsx("div",{style:{color:o.foreground,marginLeft:16},children:"The Medallion Architecture organizes data into three layers (Bronze, Silver, Gold) based on quality and transformation levels. Data flows automatically through these layers, with each layer applying progressively more sophisticated processing and validation."})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[h.blockFull," MEDALLION LAYERS"]}),e.jsxs("div",{style:{color:o.foreground,marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:12,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.muted,marginBottom:6,fontSize:11},children:"BRONZE (Raw Data)"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:["• ",e.jsx("strong",{children:"Function:"})," Copy data exactly as it appears in the source",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Schema:"})," ",e.jsx("code",{style:{color:o.accent},children:"{warehouse_name}_bronze"}),e.jsx("br",{}),"• ",e.jsx("strong",{children:"Processing:"})," Minimal - direct extraction from source_query",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Example:"})," ",e.jsx("code",{style:{color:o.muted},children:"SELECT * FROM source"})," → ",e.jsx("code",{style:{color:o.muted},children:"INSERT INTO bronze.table"})]})]}),e.jsxs("div",{style:{marginBottom:12,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.accent,marginBottom:6,fontSize:11},children:"SILVER (Cleaned & Validated)"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:["• ",e.jsx("strong",{children:"Function:"})," Clean and validate data from Bronze layer",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Schema:"})," ",e.jsx("code",{style:{color:o.accent},children:"{warehouse_name}_silver"}),e.jsx("br",{}),"• ",e.jsx("strong",{children:"Processing:"})," Deduplication, trimming, data quality validation (quality_score ≥ 70)",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Example:"})," ",e.jsx("code",{style:{color:o.muted},children:"SELECT cleaned FROM bronze.table"})," → ",e.jsx("code",{style:{color:o.muted},children:"INSERT INTO silver.table"})]})]}),e.jsxs("div",{style:{marginBottom:12,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.accent,marginBottom:6,fontSize:11},children:"GOLD (Business-Ready)"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:["• ",e.jsx("strong",{children:"Function:"})," Transform data into business-ready analytical models",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Schema:"})," ",e.jsx("code",{style:{color:o.accent},children:"{warehouse_name}_gold"}),e.jsx("br",{}),"• ",e.jsx("strong",{children:"Processing:"})," Star/Snowflake schema construction, SCD Type 1/2/3, dimension and fact tables",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Example:"})," ",e.jsx("code",{style:{color:o.muted},children:"SELECT transformed FROM silver.table"})," → ",e.jsx("code",{style:{color:o.muted},children:"INSERT INTO gold.dim_customer, gold.fact_sales"})]})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[h.blockFull," AUTOMATED PROMOTION FLOW"]}),e.jsxs("div",{style:{color:o.foreground,marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.muted,marginBottom:8,fontSize:11},children:"1. CREATE WAREHOUSE (BRONZE)"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.6,marginLeft:8},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," User creates warehouse with ",e.jsx("code",{style:{color:o.accent},children:"target_layer = 'BRONZE'"})]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," ",e.jsx("code",{style:{color:o.accent},children:"buildWarehouse()"})," → ",e.jsx("code",{style:{color:o.accent},children:"buildBronzeLayer()"})]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," Data is copied raw from ",e.jsx("code",{style:{color:o.accent},children:"source_query"})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," Saved to schema: ",e.jsx("code",{style:{color:o.accent},children:"{warehouse_name}_bronze"})]})]})]}),e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.accent,marginBottom:8,fontSize:11},children:"2. AUTOMATIC PROMOTION BRONZE → SILVER (every 60 sec)"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.6,marginLeft:8},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," ",e.jsx("code",{style:{color:o.accent},children:"warehouseBuilderThread"})," checks warehouses in BRONZE"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," If ",e.jsx("code",{style:{color:o.accent},children:"last_build_status = 'SUCCESS'"}),":"]}),e.jsxs("div",{style:{marginBottom:4,marginLeft:16},children:[e.jsx("span",{style:{color:o.muted},children:"├─"})," ",e.jsx("code",{style:{color:o.accent},children:"validateDataQuality()"})," checks quality ≥ 70"]}),e.jsxs("div",{style:{marginBottom:4,marginLeft:16},children:[e.jsx("span",{style:{color:o.muted},children:"├─"})," If passes: ",e.jsx("code",{style:{color:o.accent},children:"promoteToSilver()"})]}),e.jsxs("div",{style:{marginBottom:4,marginLeft:16},children:[e.jsx("span",{style:{color:o.muted},children:"├─"})," ",e.jsx("code",{style:{color:o.accent},children:"buildWarehouse()"})," → ",e.jsx("code",{style:{color:o.accent},children:"buildSilverLayer()"})]}),e.jsxs("div",{style:{marginBottom:4,marginLeft:16},children:[e.jsx("span",{style:{color:o.muted},children:"├─"})," Reads from ",e.jsx("code",{style:{color:o.accent},children:"{warehouse_name}_bronze"})]}),e.jsxs("div",{style:{marginBottom:4,marginLeft:16},children:[e.jsx("span",{style:{color:o.muted},children:"├─"})," Cleans data (trim, deduplicate)"]}),e.jsxs("div",{style:{marginBottom:4,marginLeft:16},children:[e.jsx("span",{style:{color:o.muted},children:"├─"})," Validates quality"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," Saves to schema: ",e.jsx("code",{style:{color:o.accent},children:"{warehouse_name}_silver"})]})]})]}),e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.accent,marginBottom:8,fontSize:11},children:"3. AUTOMATIC PROMOTION SILVER → GOLD (every 60 sec)"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.6,marginLeft:8},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," ",e.jsx("code",{style:{color:o.accent},children:"warehouseBuilderThread"})," checks warehouses in SILVER"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," If ",e.jsx("code",{style:{color:o.accent},children:"last_build_status = 'SUCCESS'"}),":"]}),e.jsxs("div",{style:{marginBottom:4,marginLeft:16},children:[e.jsx("span",{style:{color:o.muted},children:"├─"})," ",e.jsx("code",{style:{color:o.accent},children:"promoteToGold()"})]}),e.jsxs("div",{style:{marginBottom:4,marginLeft:16},children:[e.jsx("span",{style:{color:o.muted},children:"├─"})," ",e.jsx("code",{style:{color:o.accent},children:"buildWarehouse()"})," → ",e.jsx("code",{style:{color:o.accent},children:"buildGoldLayer()"})]}),e.jsxs("div",{style:{marginBottom:4,marginLeft:16},children:[e.jsx("span",{style:{color:o.muted},children:"├─"})," Reads from ",e.jsx("code",{style:{color:o.accent},children:"{warehouse_name}_silver"})]}),e.jsxs("div",{style:{marginBottom:4,marginLeft:16},children:[e.jsx("span",{style:{color:o.muted},children:"├─"})," Applies transformations (Star/Snowflake Schema)"]}),e.jsxs("div",{style:{marginBottom:4,marginLeft:16},children:[e.jsx("span",{style:{color:o.muted},children:"├─"})," Builds dimensions and facts with SCD"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," Saves to schema: ",e.jsx("code",{style:{color:o.accent},children:"{warehouse_name}_gold"})]})]})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[h.blockFull," KEY FEATURES"]}),e.jsxs("div",{style:{color:o.foreground,marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent},children:h.blockFull})," ",e.jsx("strong",{children:"Automatic Promotion:"})," System checks and promotes warehouses every 60 seconds"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent},children:h.blockFull})," ",e.jsx("strong",{children:"Quality Gates:"})," BRONZE → SILVER requires quality_score ≥ 70"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent},children:h.blockFull})," ",e.jsx("strong",{children:"Separate Schemas:"})," Each layer has its own schema to prevent conflicts"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent},children:h.blockFull})," ",e.jsx("strong",{children:"Sequential Flow:"})," Data must flow BRONZE → SILVER → GOLD (cannot skip layers)"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent},children:h.blockFull})," ",e.jsx("strong",{children:"Historical Preservation:"})," Each layer maintains its own data snapshot"]})]})]}),e.jsxs("div",{style:{marginTop:16,padding:12,background:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:o.muted,marginBottom:4},children:[h.blockSemi," Best Practices"]}),e.jsxs("div",{style:{fontSize:11,color:o.foreground,lineHeight:1.6},children:["• Start with BRONZE layer to capture raw data without transformation",e.jsx("br",{}),"• Monitor data quality scores to ensure successful promotion to SILVER",e.jsx("br",{}),"• Use SILVER layer for data cleaning and validation before business transformations",e.jsx("br",{}),"• Design GOLD layer schemas (Star/Snowflake) based on your analytical requirements",e.jsx("br",{}),"• Each layer serves a specific purpose - don't skip layers in the flow",e.jsx("br",{}),"• Monitor promotion status in the warehouse details panel",e.jsx("br",{}),"• Use separate schemas per layer to maintain data lineage and auditability"]})]}),e.jsx("div",{style:{marginTop:16,textAlign:"right"},children:e.jsx(x,{label:"Close",onClick:()=>B(!1),variant:"ghost"})})]})})})}),U&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>Z(!1),children:e.jsx("div",{style:{width:"90%",maxWidth:1e3,maxHeight:"90vh",overflowY:"auto"},onClick:t=>t.stopPropagation(),children:e.jsx(P,{title:"DATA WAREHOUSE PLAYBOOK",children:e.jsxs("div",{style:{padding:16,fontFamily:"Consolas",fontSize:12,lineHeight:1.6},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[h.blockFull," OVERVIEW"]}),e.jsx("div",{style:{color:o.foreground,marginLeft:16},children:"A Data Warehouse is a centralized repository that stores integrated data from multiple sources, organized in dimensional models (Star Schema or Snowflake Schema) for analytical and reporting purposes. The system automatically builds dimensional models with fact and dimension tables, supporting SCD (Slowly Changing Dimension) types and automatic promotion through Medallion Architecture layers (Bronze → Silver → Gold)."})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[h.blockFull," KEY CONCEPTS"]}),e.jsxs("div",{style:{color:o.foreground,marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:12,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.accent,marginBottom:6,fontSize:11},children:"DIMENSIONAL MODELING"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:["• ",e.jsx("strong",{children:"Star Schema:"})," Central fact table surrounded by denormalized dimension tables",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Snowflake Schema:"})," Normalized dimensions with sub-dimensions for complex hierarchies",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Fact Tables:"})," Store measurable business events (sales, transactions, metrics)",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Dimension Tables:"})," Store descriptive attributes (customers, products, time, geography)"]})]}),e.jsxs("div",{style:{marginBottom:12,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.accent,marginBottom:6,fontSize:11},children:"SLOWLY CHANGING DIMENSIONS (SCD)"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:["• ",e.jsx("strong",{children:"Type 1:"})," Overwrite old values (no history)",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Type 2:"})," Create new row with valid_from/valid_to dates (full history)",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Type 3:"})," Add previous value column (limited history)"]})]}),e.jsxs("div",{style:{marginBottom:12,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.accent,marginBottom:6,fontSize:11},children:"MEDALLION ARCHITECTURE"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.5},children:["• ",e.jsx("strong",{children:"BRONZE:"})," Raw data copied from source (no transformation)",e.jsx("br",{}),"• ",e.jsx("strong",{children:"SILVER:"})," Cleaned and validated data (quality score ≥ 70)",e.jsx("br",{}),"• ",e.jsx("strong",{children:"GOLD:"})," Business-ready dimensional models (Star/Snowflake schemas)",e.jsx("br",{}),"• Automatic promotion every 60 seconds when quality gates are met"]})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[h.blockFull," BUILD PROCESS"]}),e.jsxs("div",{style:{color:o.foreground,marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.muted,marginBottom:8,fontSize:11},children:"1. CREATE WAREHOUSE"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.6,marginLeft:8},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," Define warehouse name, schema type (Star/Snowflake), and target layer (BRONZE/SILVER/GOLD)"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," Configure source and target database connections"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," Define dimensions with business keys, SCD type, and source queries"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," Define facts with source queries and grain (level of detail)"]})]})]}),e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.accent,marginBottom:8,fontSize:11},children:"2. BUILD WAREHOUSE"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.6,marginLeft:8},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," Execute ",e.jsx("code",{style:{color:o.accent},children:"buildWarehouse()"})," to start construction"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," For BRONZE: Copy raw data from source_query to target schema"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," For SILVER: Clean, validate, and deduplicate data from BRONZE"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," For GOLD: Build dimensional models (dimensions + facts) with SCD logic"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," Create indexes, partitions, and constraints as configured"]})]})]}),e.jsxs("div",{style:{marginBottom:16,padding:"12px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsx("div",{style:{fontWeight:600,color:o.accent,marginBottom:8,fontSize:11},children:"3. AUTOMATIC PROMOTION (if enabled)"}),e.jsxs("div",{style:{fontSize:11,lineHeight:1.6,marginLeft:8},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," System checks warehouses every 60 seconds"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," If BRONZE build succeeds: Validate quality → Promote to SILVER"]}),e.jsxs("div",{style:{marginBottom:4},children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," If SILVER build succeeds: Promote to GOLD and build dimensional models"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:o.muted},children:"└─"})," Each layer maintains separate schema: ",e.jsx("code",{style:{color:o.accent},children:"{warehouse_name}_bronze"}),", ",e.jsx("code",{style:{color:o.accent},children:"{warehouse_name}_silver"}),", ",e.jsx("code",{style:{color:o.accent},children:"{warehouse_name}_gold"})]})]})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:o.accent,marginBottom:12},children:[h.blockFull," KEY FEATURES"]}),e.jsxs("div",{style:{color:o.foreground,marginLeft:16},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent},children:h.blockFull})," ",e.jsx("strong",{children:"Dimensional Modeling:"})," Automatic Star/Snowflake schema construction"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent},children:h.blockFull})," ",e.jsx("strong",{children:"SCD Support:"})," Type 1, 2, and 3 for historical tracking"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent},children:h.blockFull})," ",e.jsx("strong",{children:"Medallion Architecture:"})," Automatic data quality-based promotion"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent},children:h.blockFull})," ",e.jsx("strong",{children:"Multi-Engine Support:"})," PostgreSQL, Snowflake, BigQuery, Redshift"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent},children:h.blockFull})," ",e.jsx("strong",{children:"Incremental Loading:"})," Support for incremental fact table updates"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("span",{style:{color:o.accent},children:h.blockFull})," ",e.jsx("strong",{children:"Partitioning:"})," Automatic table partitioning by date/range"]})]})]}),e.jsxs("div",{style:{marginTop:16,padding:12,background:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`},children:[e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:o.muted,marginBottom:4},children:[h.blockSemi," Best Practices"]}),e.jsxs("div",{style:{fontSize:11,color:o.foreground,lineHeight:1.6},children:["• Start with BRONZE layer to capture raw data without transformation",e.jsx("br",{}),"• Design dimensions with clear business keys and appropriate SCD type",e.jsx("br",{}),"• Use Type 2 SCD for dimensions that change over time (customers, products)",e.jsx("br",{}),"• Define fact tables with clear grain (transaction level, daily aggregates, etc.)",e.jsx("br",{}),"• Monitor data quality scores to ensure successful promotion to SILVER",e.jsx("br",{}),"• Use GOLD layer for business-ready analytical models",e.jsx("br",{}),"• Schedule regular builds using cron expressions or workflow orchestration",e.jsx("br",{}),"• Use separate schemas per layer to maintain data lineage"]})]}),e.jsx("div",{style:{marginTop:16,textAlign:"right"},children:e.jsx(x,{label:"Close",onClick:()=>Z(!1),variant:"ghost"})})]})})})})]})};export{Re as default};
