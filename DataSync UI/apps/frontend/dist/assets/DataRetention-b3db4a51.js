import{r as o,ah as c,j as s,C as h,t,b as r,e as A}from"./index-b1fa964d.js";import{e as d}from"./errorHandler-5ea9ae85.js";import{A as g}from"./AsciiPanel-3399d5be.js";import{A as u}from"./AsciiButton-3fcfdd9b.js";import{S as L}from"./SkeletonLoader-09c12074.js";const N=()=>{const[a,l]=o.useState("policies"),[b,j]=o.useState([]),[y,v]=o.useState([]),[S,E]=o.useState([]),[T,k]=o.useState(!0),[m,n]=o.useState(null),i=o.useRef(!0),p=o.useCallback(async()=>{if(i.current)try{n(null);const e=await c.getPolicies();i.current&&j(e)}catch(e){i.current&&n(d(e))}finally{i.current&&k(!1)}},[]),f=o.useCallback(async()=>{if(i.current)try{n(null);const e=await c.getJobs();i.current&&v(e)}catch(e){i.current&&n(d(e))}},[]),x=o.useCallback(async()=>{if(i.current)try{n(null);const e=await c.getLegalHolds();i.current&&E(e)}catch(e){i.current&&n(d(e))}},[]);return o.useEffect(()=>(i.current=!0,a==="policies"?p():a==="jobs"?f():a==="legal-holds"&&x(),()=>{i.current=!1}),[a,p,f,x]),T?s.jsx(h,{children:s.jsx(L,{})}):s.jsx(h,{children:s.jsxs("div",{style:{padding:t.spacing.lg,fontFamily:"Consolas",fontSize:12,background:r.background},children:[s.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:`0 0 ${t.spacing.md} 0`,color:r.foreground},children:[A.blockFull," DATA RETENTION"]}),s.jsxs("div",{style:{display:"flex",gap:t.spacing.sm,marginBottom:t.spacing.md},children:[s.jsx(u,{label:"Policies",onClick:()=>l("policies"),variant:a==="policies"?"primary":"ghost"}),s.jsx(u,{label:"Jobs",onClick:()=>l("jobs"),variant:a==="jobs"?"primary":"ghost"}),s.jsx(u,{label:"Legal Holds",onClick:()=>l("legal-holds"),variant:a==="legal-holds"?"primary":"ghost"})]}),m&&s.jsxs("div",{style:{padding:t.spacing.sm,background:r.foreground+"20",border:`1px solid ${r.foreground}`,marginBottom:t.spacing.md,color:r.foreground},children:["Error: ",m]}),a==="policies"&&s.jsx(g,{title:"RETENTION POLICIES",children:s.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:b.map((e,C)=>s.jsxs("div",{style:{padding:t.spacing.sm,border:`1px solid ${r.border}`,marginBottom:t.spacing.xs},children:[s.jsxs("div",{style:{fontWeight:600,color:r.foreground},children:[e.schema_name,".",e.table_name]}),s.jsxs("div",{style:{color:r.muted,fontSize:11,marginTop:t.spacing.xs},children:["Retention: ",e.retention_period]})]},C))})}),a==="jobs"&&s.jsx(g,{title:"RETENTION JOBS",children:s.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:y.map(e=>s.jsxs("div",{style:{padding:t.spacing.sm,border:`1px solid ${r.border}`,marginBottom:t.spacing.xs},children:[s.jsxs("div",{style:{fontWeight:600,color:r.foreground},children:[e.job_type," - ",e.status]}),s.jsxs("div",{style:{color:r.muted,fontSize:11,marginTop:t.spacing.xs},children:[e.schema_name,".",e.table_name]})]},e.id))})}),a==="legal-holds"&&s.jsx(g,{title:"LEGAL HOLDS",children:s.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:S.map(e=>s.jsxs("div",{style:{padding:t.spacing.sm,border:`1px solid ${r.border}`,marginBottom:t.spacing.xs},children:[s.jsxs("div",{style:{fontWeight:600,color:r.foreground},children:[e.schema_name,".",e.table_name]}),s.jsx("div",{style:{color:r.muted,fontSize:11,marginTop:t.spacing.xs},children:e.reason})]},e.id))})})]})})};export{N as default};
