import{r as c,j as o,t as n,b as e,e as m,ac as T,C as G}from"./index-f6ac47b8.js";import{S as X}from"./SkeletonLoader-792007e7.js";import{e as K}from"./errorHandler-5ea9ae85.js";import{A as M}from"./AsciiPanel-5614714e.js";import{A as w}from"./AsciiButton-4907e65e.js";const J=({policies:C,onEdit:B,onDelete:E,onEncrypt:z,onRotateKey:j})=>{const[L,I]=c.useState(new Set),[u,k]=c.useState(new Set),[a,i]=c.useState(new Set),S=c.useMemo(()=>{const s=new Map;return C.forEach(y=>{const d=y.schema_name||"Other",f=y.table_name||"Other",l=y.column_name||"Other";s.has(d)||s.set(d,{name:d,tables:new Map});const g=s.get(d);g.tables.has(f)||g.tables.set(f,{name:f,columns:new Map});const x=g.tables.get(f);x.columns.has(l)||x.columns.set(l,{name:l,policies:[]}),x.columns.get(l).policies.push(y)}),Array.from(s.values()).sort((y,d)=>y.name.localeCompare(d.name))},[C]),R=s=>{I(y=>{const d=new Set(y);if(d.has(s)){d.delete(s);const f=S.find(l=>l.name===s);f&&f.tables.forEach(l=>{const g=`${s}.${l.name}`;k(x=>{const p=new Set(x);return p.delete(g),p}),l.columns.forEach(x=>{const p=`${s}.${l.name}.${x.name}`;i($=>{const F=new Set($);return F.delete(p),F})})})}else d.add(s);return d})},_=(s,y)=>{const d=`${s}.${y}`;k(f=>{const l=new Set(f);if(l.has(d)){l.delete(d);const g=S.find(x=>x.name===s);if(g){const x=g.tables.get(y);x&&x.columns.forEach(p=>{const $=`${s}.${y}.${p.name}`;i(F=>{const v=new Set(F);return v.delete($),v})})}}else l.add(d);return l})},N=(s,y,d)=>{const f=`${s}.${y}.${d}`;i(l=>{const g=new Set(l);return g.has(f)?g.delete(f):g.add(f),g})},P=(s,y)=>{if(s===0)return null;const d=[];for(let f=0;f<s-1;f++)d.push(`${m.v}  `);return y?d.push(`${m.bl}${m.h}${m.h} `):d.push(`${m.tRight}${m.h}${m.h} `),o.jsx("span",{style:{color:e.border,marginRight:6,fontFamily:"Consolas",fontSize:11},children:d.join("")})},D=s=>s?new Date(s).toLocaleString():"-";return C.length===0?o.jsx("div",{style:{padding:n.spacing.lg,textAlign:"center",color:e.muted,fontFamily:"Consolas",fontSize:12},children:"No encryption policies found. Create one to get started."}):o.jsx("div",{style:{fontFamily:"Consolas",fontSize:12,color:e.foreground},children:S.map((s,y)=>{const d=L.has(s.name),f=Array.from(s.tables.values());return S.length-1,o.jsxs("div",{style:{marginBottom:4},children:[o.jsxs("div",{onClick:()=>R(s.name),style:{display:"flex",alignItems:"center",padding:"10px 8px",cursor:"pointer",borderLeft:`2px solid ${e.accent}`,backgroundColor:d?e.backgroundSoft:e.background,transition:"all 0.15s ease",marginBottom:2},onMouseEnter:l=>{l.currentTarget.style.backgroundColor=e.backgroundSoft},onMouseLeave:l=>{d||(l.currentTarget.style.backgroundColor=e.background)},children:[o.jsx("span",{style:{marginRight:8,color:d?e.accent:e.muted,fontSize:10,transition:"transform 0.15s ease",display:"inline-block",transform:d?"rotate(90deg)":"rotate(0deg)"},children:m.arrowRight}),o.jsx("span",{style:{fontWeight:600,color:e.accent,fontSize:12,flex:1},children:s.name}),o.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${e.border}`,backgroundColor:e.backgroundSoft,color:e.foreground},children:f.reduce((l,g)=>l+Array.from(g.columns.values()).reduce((x,p)=>x+p.policies.length,0),0)})]}),d&&o.jsx("div",{style:{paddingLeft:24},children:f.map((l,g)=>{const x=`${s.name}.${l.name}`,p=u.has(x),$=Array.from(l.columns.values()),F=g===f.length-1;return o.jsxs("div",{children:[o.jsxs("div",{onClick:()=>_(s.name,l.name),style:{display:"flex",alignItems:"center",padding:"8px 8px",marginLeft:8,marginBottom:2,borderLeft:`2px solid ${e.border}`,backgroundColor:p?e.backgroundSoft:"transparent",transition:"all 0.15s ease",cursor:"pointer"},onMouseEnter:v=>{v.currentTarget.style.backgroundColor=e.backgroundSoft,v.currentTarget.style.borderLeftColor=e.accent},onMouseLeave:v=>{p||(v.currentTarget.style.backgroundColor="transparent",v.currentTarget.style.borderLeftColor=e.border)},children:[P(1,F),o.jsx("span",{style:{marginRight:8,color:p?e.accent:e.muted,fontSize:10,transition:"transform 0.15s ease",display:"inline-block",transform:p?"rotate(90deg)":"rotate(0deg)"},children:m.arrowRight}),o.jsx("span",{style:{fontWeight:600,color:e.foreground,fontSize:11,flex:1},children:l.name}),o.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${e.border}`,backgroundColor:"transparent",color:e.muted},children:$.reduce((v,W)=>v+W.policies.length,0)})]}),p&&o.jsx("div",{style:{paddingLeft:24},children:$.map((v,W)=>{const O=`${s.name}.${l.name}.${v.name}`,A=a.has(O),Y=W===$.length-1;return o.jsxs("div",{children:[o.jsxs("div",{onClick:()=>N(s.name,l.name,v.name),style:{display:"flex",alignItems:"center",padding:"6px 8px",marginLeft:8,marginBottom:2,borderLeft:`1px solid ${e.border}`,backgroundColor:A?e.backgroundSoft:"transparent",transition:"all 0.15s ease",cursor:"pointer"},onMouseEnter:h=>{h.currentTarget.style.backgroundColor=e.backgroundSoft,h.currentTarget.style.borderLeftColor=e.accent},onMouseLeave:h=>{A||(h.currentTarget.style.backgroundColor="transparent",h.currentTarget.style.borderLeftColor=e.border)},children:[P(2,Y),o.jsx("span",{style:{marginRight:8,color:A?e.accent:e.muted,fontSize:10,transition:"transform 0.15s ease",display:"inline-block",transform:A?"rotate(90deg)":"rotate(0deg)"},children:m.arrowRight}),o.jsx("span",{style:{fontWeight:500,color:e.accent,fontSize:11,flex:1},children:v.name}),o.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${e.border}`,backgroundColor:"transparent",color:e.muted},children:v.policies.length})]}),A&&o.jsx("div",{style:{paddingLeft:24},children:v.policies.map((h,t)=>{const r=t===v.policies.length-1;return o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",padding:"8px 8px",marginLeft:8,marginBottom:2,borderLeft:`1px solid ${e.border}`,backgroundColor:"transparent",transition:"all 0.15s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor=e.backgroundSoft,b.currentTarget.style.borderLeftColor=e.accent},onMouseLeave:b=>{b.currentTarget.style.backgroundColor="transparent",b.currentTarget.style.borderLeftColor=e.border},children:[P(3,r),o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[o.jsx("span",{style:{fontWeight:600,color:e.foreground,fontSize:11},children:h.policy_name}),o.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${e.accent}`,color:e.accent,backgroundColor:"transparent"},children:h.encryption_algorithm}),o.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${h.active?e.accent:e.muted}`,color:h.active?e.accent:e.muted,backgroundColor:"transparent"},children:h.active?"ACTIVE":"INACTIVE"})]}),o.jsxs("div",{style:{fontSize:10,color:e.muted,marginBottom:4},children:["Key ID: ",o.jsx("code",{style:{color:e.foreground},children:h.key_id})]}),o.jsxs("div",{style:{fontSize:10,color:e.muted},children:["Last Rotated: ",D(h.last_rotated_at||"")]})]}),o.jsxs("div",{style:{display:"flex",gap:4,marginLeft:8},children:[o.jsx(w,{label:"Edit",onClick:b=>{b.stopPropagation(),B==null||B(h)},variant:"ghost",style:{fontSize:10,padding:"2px 6px"}}),o.jsx(w,{label:"Encrypt",onClick:b=>{b.stopPropagation(),z==null||z(h)},variant:"ghost",style:{fontSize:10,padding:"2px 6px"}}),o.jsx(w,{label:"Rotate",onClick:b=>{b.stopPropagation(),j==null||j(h)},variant:"ghost",style:{fontSize:10,padding:"2px 6px"}}),h.policy_id&&o.jsx(w,{label:"Delete",onClick:b=>{b.stopPropagation(),E==null||E(h.policy_id)},variant:"ghost",style:{fontSize:10,padding:"2px 6px"}})]})]},h.policy_id||t)})})]},O)})})]},x)})})]},s.name)})})},Q=({keys:C})=>{const[B,E]=c.useState(new Set),z=c.useMemo(()=>{const u=new Map;return C.forEach(k=>{const a=k.algorithm||"Unknown";u.has(a)||u.set(a,{algorithm:a,keys:[]}),u.get(a).keys.push(k)}),Array.from(u.values()).sort((k,a)=>k.algorithm.localeCompare(a.algorithm))},[C]),j=u=>{E(k=>{const a=new Set(k);return a.has(u)?a.delete(u):a.add(u),a})},L=(u,k)=>{if(u===0)return null;const a=[];for(let i=0;i<u-1;i++)a.push(`${m.v}  `);return k?a.push(`${m.bl}${m.h}${m.h} `):a.push(`${m.tRight}${m.h}${m.h} `),o.jsx("span",{style:{color:e.border,marginRight:6,fontFamily:"Consolas",fontSize:11},children:a.join("")})},I=u=>u?new Date(u).toLocaleString():"-";return C.length===0?o.jsx("div",{style:{padding:n.spacing.lg,textAlign:"center",color:e.muted,fontFamily:"Consolas",fontSize:12},children:"No encryption keys found. Create one above."}):o.jsx("div",{style:{fontFamily:"Consolas",fontSize:12,color:e.foreground},children:z.map((u,k)=>{const a=B.has(u.algorithm);return z.length-1,o.jsxs("div",{style:{marginBottom:4},children:[o.jsxs("div",{onClick:()=>j(u.algorithm),style:{display:"flex",alignItems:"center",padding:"10px 8px",cursor:"pointer",borderLeft:`2px solid ${e.accent}`,backgroundColor:a?e.backgroundSoft:e.background,transition:"all 0.15s ease",marginBottom:2},onMouseEnter:i=>{i.currentTarget.style.backgroundColor=e.backgroundSoft},onMouseLeave:i=>{a||(i.currentTarget.style.backgroundColor=e.background)},children:[o.jsx("span",{style:{marginRight:8,color:a?e.accent:e.muted,fontSize:10,transition:"transform 0.15s ease",display:"inline-block",transform:a?"rotate(90deg)":"rotate(0deg)"},children:m.arrowRight}),o.jsx("span",{style:{fontWeight:600,color:e.accent,fontSize:12,flex:1},children:u.algorithm}),o.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${e.border}`,backgroundColor:e.backgroundSoft,color:e.foreground},children:u.keys.length})]}),a&&o.jsx("div",{style:{paddingLeft:24},children:u.keys.map((i,S)=>{const R=S===u.keys.length-1;return o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",padding:"8px 8px",marginLeft:8,marginBottom:2,borderLeft:`1px solid ${e.border}`,backgroundColor:"transparent",transition:"all 0.15s ease"},onMouseEnter:_=>{_.currentTarget.style.backgroundColor=e.backgroundSoft,_.currentTarget.style.borderLeftColor=e.accent},onMouseLeave:_=>{_.currentTarget.style.backgroundColor="transparent",_.currentTarget.style.borderLeftColor=e.border},children:[L(1,R),o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,flexWrap:"wrap"},children:[o.jsx("code",{style:{fontWeight:600,color:e.accent,fontSize:11,fontFamily:"Consolas"},children:i.key_id}),i.rotation_count!==void 0&&i.rotation_count>0&&o.jsxs("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${e.border}`,color:e.muted,backgroundColor:"transparent"},children:[i.rotation_count," rotations"]})]}),o.jsxs("div",{style:{fontSize:10,color:e.muted,marginBottom:4,fontFamily:"Consolas"},children:["Created: ",I(i.created_at)]}),i.last_used_at&&o.jsxs("div",{style:{fontSize:10,color:e.muted,fontFamily:"Consolas"},children:["Last Used: ",I(i.last_used_at)]})]})]},i.key_id)})})]},u.algorithm)})})},re=()=>{const C=c.useRef(!0),[B,E]=c.useState(!0),[z,j]=c.useState(null),[L,I]=c.useState([]),[u,k]=c.useState(!1),[a,i]=c.useState(null),[S,R]=c.useState({schema_name:"",table_name:"",active:""}),[_,N]=c.useState(1),[P,D]=c.useState(0),s=20,[y,d]=c.useState([]),[f,l]=c.useState(!1),[g,x]=c.useState({key_id:"",key_value:"",algorithm:"AES256"}),p=c.useCallback(async()=>{if(!C.current)return;const t=Date.now(),r=300;try{E(!0),j(null);const b={page:_,limit:s};S.schema_name&&(b.schema_name=S.schema_name),S.table_name&&(b.table_name=S.table_name),S.active!==""&&(b.active=S.active==="true");const V=await T.getAll(b),H=Date.now()-t,U=Math.max(0,r-H);await new Promise(q=>setTimeout(q,U)),C.current&&(I(V.policies||[]),D(V.total||0))}catch(b){C.current&&j(K(b))}finally{C.current&&E(!1)}},[_,S]),$=c.useCallback(async()=>{try{const t=await T.getKeys();d(t.keys||[])}catch(t){console.error("Error fetching encryption keys:",t)}},[]);c.useEffect(()=>(C.current=!0,p(),$(),()=>{C.current=!1}),[p,$]);const F=c.useCallback(()=>{i({policy_name:"",schema_name:"",table_name:"",column_name:"",encryption_algorithm:"AES256",key_id:"",key_rotation_interval_days:90,active:!0}),k(!0)},[]),v=c.useCallback(t=>{i({...t}),k(!0)},[]),W=c.useCallback(async t=>{if(confirm("Are you sure you want to delete this encryption policy?"))try{await T.delete(t),p()}catch(r){C.current&&j(K(r))}},[p]),O=c.useCallback(async()=>{if(a)try{j(null),a.policy_id?await T.update(a.policy_id,a):await T.create(a),k(!1),p()}catch(t){C.current&&j(K(t))}},[a,p]),A=c.useCallback(async t=>{if(confirm(`Are you sure you want to encrypt all data in ${t.schema_name}.${t.table_name}.${t.column_name}? This action cannot be undone.`))try{j(null),await T.encryptColumn(t.schema_name,t.table_name,t.column_name,t.key_id),alert("Column encrypted successfully"),p()}catch(r){C.current&&j(K(r))}},[p]),Y=c.useCallback(async t=>{const r=prompt(`Enter new key ID for policy "${t.policy_name}":`);if(r)try{j(null),await T.rotateKey(t.policy_id,r),alert("Encryption key rotated successfully"),p(),$()}catch(b){C.current&&j(K(b))}},[p,$]),h=c.useCallback(async()=>{if(!g.key_id||!g.key_value){alert("Key ID and Key Value are required");return}try{j(null),await T.createKey(g.key_id,g.key_value,g.algorithm),l(!1),x({key_id:"",key_value:"",algorithm:"AES256"}),$()}catch(t){C.current&&j(K(t))}},[g,$]);return B&&L.length===0?o.jsx(X,{variant:"table"}):o.jsxs(G,{children:[o.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:n.spacing.lg,paddingBottom:n.spacing.md,borderBottom:`2px solid ${e.accent}`},children:o.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:0,color:e.foreground,textTransform:"uppercase",fontFamily:"Consolas"},children:[o.jsx("span",{style:{color:e.accent,marginRight:n.spacing.sm},children:m.blockFull}),"DATA ENCRYPTION"]})}),z&&o.jsx("div",{style:{marginBottom:n.spacing.md},children:o.jsx(M,{title:"ERROR",children:o.jsx("div",{style:{padding:n.spacing.sm,color:e.foreground,fontSize:12,fontFamily:"Consolas",backgroundColor:e.backgroundSoft,borderRadius:2},children:z})})}),o.jsx("div",{style:{marginBottom:n.spacing.md},children:o.jsx(M,{title:"DATA ENCRYPTION",children:o.jsxs("div",{style:{padding:n.spacing.md,fontFamily:"Consolas",fontSize:12},children:[o.jsxs("div",{style:{display:"flex",gap:n.spacing.sm,marginBottom:n.spacing.md,flexWrap:"wrap"},children:[o.jsx(w,{label:`${m.blockFull} Create Encryption Policy`,onClick:F}),o.jsx(w,{label:`${m.blockFull} Manage Keys`,onClick:()=>l(!0),variant:"ghost"})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md,display:"flex",gap:n.spacing.sm,flexWrap:"wrap"},children:[o.jsx("input",{type:"text",placeholder:"Schema name",value:S.schema_name,onChange:t=>R(r=>({...r,schema_name:t.target.value})),style:{padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,flex:1,minWidth:150,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}}),o.jsx("input",{type:"text",placeholder:"Table name",value:S.table_name,onChange:t=>R(r=>({...r,table_name:t.target.value})),style:{padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,flex:1,minWidth:150,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}}),o.jsxs("select",{value:S.active,onChange:t=>R(r=>({...r,active:t.target.value})),style:{padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,minWidth:120,outline:"none",transition:"border-color 0.15s ease",cursor:"pointer"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"},children:[o.jsx("option",{value:"",children:"All Status"}),o.jsx("option",{value:"true",children:"Active"}),o.jsx("option",{value:"false",children:"Inactive"})]})]}),o.jsxs("div",{style:{marginBottom:n.spacing.sm,fontSize:11,color:e.muted,fontFamily:"Consolas"},children:["Encryption Policies (",P,")"]}),o.jsx(J,{policies:L,onEdit:v,onDelete:W,onEncrypt:A,onRotateKey:Y})]})})}),u&&a&&o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:20},onClick:t=>{t.target===t.currentTarget&&k(!1)},children:o.jsxs("div",{style:{backgroundColor:e.background,border:`2px solid ${e.border}`,borderRadius:2,width:"90%",maxWidth:600,maxHeight:"90vh",overflowY:"auto"},onClick:t=>t.stopPropagation(),children:[o.jsx("style",{children:`
              div[style*="overflowY"]::-webkit-scrollbar {
                width: 0px;
                display: none;
              }
              div[style*="overflowY"] {
                -ms-overflow-style: none;
                scrollbar-width: none;
              }
            `}),o.jsx(M,{title:a.policy_id?"EDIT ENCRYPTION POLICY":"CREATE ENCRYPTION POLICY",children:o.jsxs("div",{style:{padding:n.spacing.md,fontFamily:"Consolas",fontSize:12},children:[o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("label",{style:{display:"block",marginBottom:n.spacing.xs,color:e.muted,fontSize:11,fontFamily:"Consolas"},children:"Policy Name *"}),o.jsx("input",{type:"text",value:a.policy_name,onChange:t=>i(r=>r?{...r,policy_name:t.target.value}:null),style:{width:"100%",padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("label",{style:{display:"block",marginBottom:n.spacing.xs,color:e.muted,fontSize:11,fontFamily:"Consolas"},children:"Schema Name *"}),o.jsx("input",{type:"text",value:a.schema_name,onChange:t=>i(r=>r?{...r,schema_name:t.target.value}:null),style:{width:"100%",padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("label",{style:{display:"block",marginBottom:n.spacing.xs,color:e.muted,fontSize:11,fontFamily:"Consolas"},children:"Table Name *"}),o.jsx("input",{type:"text",value:a.table_name,onChange:t=>i(r=>r?{...r,table_name:t.target.value}:null),style:{width:"100%",padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("label",{style:{display:"block",marginBottom:n.spacing.xs,color:e.muted,fontSize:11,fontFamily:"Consolas"},children:"Column Name *"}),o.jsx("input",{type:"text",value:a.column_name,onChange:t=>i(r=>r?{...r,column_name:t.target.value}:null),style:{width:"100%",padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("label",{style:{display:"block",marginBottom:n.spacing.xs,color:e.muted,fontSize:11,fontFamily:"Consolas"},children:"Encryption Algorithm *"}),o.jsxs("select",{value:a.encryption_algorithm,onChange:t=>i(r=>r?{...r,encryption_algorithm:t.target.value}:null),style:{width:"100%",padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease",cursor:"pointer"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"},children:[o.jsx("option",{value:"AES128",children:"AES128"}),o.jsx("option",{value:"AES192",children:"AES192"}),o.jsx("option",{value:"AES256",children:"AES256"})]})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("label",{style:{display:"block",marginBottom:n.spacing.xs,color:e.muted,fontSize:11,fontFamily:"Consolas"},children:"Key ID *"}),o.jsxs("select",{value:a.key_id,onChange:t=>i(r=>r?{...r,key_id:t.target.value}:null),style:{width:"100%",padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease",cursor:"pointer"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"},children:[o.jsx("option",{value:"",children:"Select Key"}),y.map(t=>o.jsxs("option",{value:t.key_id,children:[t.key_id," (",t.algorithm,")"]},t.key_id))]})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("label",{style:{display:"block",marginBottom:n.spacing.xs,color:e.muted,fontSize:11,fontFamily:"Consolas"},children:"Key Rotation Interval (days)"}),o.jsx("input",{type:"number",value:a.key_rotation_interval_days||90,onChange:t=>i(r=>r?{...r,key_rotation_interval_days:parseInt(t.target.value)||90}:null),style:{width:"100%",padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}})]}),o.jsx("div",{style:{marginBottom:n.spacing.md},children:o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:n.spacing.sm,cursor:"pointer"},children:[o.jsx("input",{type:"checkbox",checked:a.active,onChange:t=>i(r=>r?{...r,active:t.target.checked}:null),style:{cursor:"pointer"}}),o.jsx("span",{style:{color:e.foreground,fontSize:12,fontFamily:"Consolas"},children:"Active"})]})}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:n.spacing.sm,marginTop:n.spacing.lg},children:[o.jsx(w,{label:"Cancel",onClick:()=>k(!1),variant:"ghost"}),o.jsx(w,{label:"Save",onClick:O})]})]})})]})}),f&&o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:20},onClick:t=>{t.target===t.currentTarget&&l(!1)},children:o.jsxs("div",{style:{backgroundColor:e.background,border:`2px solid ${e.border}`,borderRadius:2,width:"90%",maxWidth:500,maxHeight:"90vh",overflowY:"auto"},onClick:t=>t.stopPropagation(),children:[o.jsx("style",{children:`
              div[style*="overflowY"]::-webkit-scrollbar {
                width: 0px;
                display: none;
              }
              div[style*="overflowY"] {
                -ms-overflow-style: none;
                scrollbar-width: none;
              }
            `}),o.jsx(M,{title:"ENCRYPTION KEYS",children:o.jsxs("div",{style:{padding:n.spacing.md,fontFamily:"Consolas",fontSize:12},children:[o.jsxs("div",{style:{marginBottom:n.spacing.lg},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:600,color:e.accent,marginBottom:n.spacing.sm,fontFamily:"Consolas"},children:[m.blockFull," CREATE NEW KEY"]}),o.jsxs("div",{style:{marginBottom:n.spacing.sm},children:[o.jsx("label",{style:{display:"block",marginBottom:n.spacing.xs,color:e.muted,fontSize:11,fontFamily:"Consolas"},children:"Key ID *"}),o.jsx("input",{type:"text",value:g.key_id,onChange:t=>x(r=>({...r,key_id:t.target.value})),placeholder:"e.g., key_2024_01",style:{width:"100%",padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}})]}),o.jsxs("div",{style:{marginBottom:n.spacing.sm},children:[o.jsx("label",{style:{display:"block",marginBottom:n.spacing.xs,color:e.muted,fontSize:11,fontFamily:"Consolas"},children:"Key Value *"}),o.jsx("input",{type:"password",value:g.key_value,onChange:t=>x(r=>({...r,key_value:t.target.value})),placeholder:"Enter encryption key",style:{width:"100%",padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"}})]}),o.jsxs("div",{style:{marginBottom:n.spacing.md},children:[o.jsx("label",{style:{display:"block",marginBottom:n.spacing.xs,color:e.muted,fontSize:11,fontFamily:"Consolas"},children:"Algorithm"}),o.jsxs("select",{value:g.algorithm,onChange:t=>x(r=>({...r,algorithm:t.target.value})),style:{width:"100%",padding:`${n.spacing.sm} ${n.spacing.md}`,border:`1px solid ${e.border}`,backgroundColor:e.background,color:e.foreground,fontFamily:"Consolas",fontSize:12,borderRadius:2,outline:"none",transition:"border-color 0.15s ease",cursor:"pointer"},onFocus:t=>{t.target.style.borderColor=e.accent,t.target.style.outline=`2px solid ${e.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=e.border,t.target.style.outline="none"},children:[o.jsx("option",{value:"AES128",children:"AES128"}),o.jsx("option",{value:"AES192",children:"AES192"}),o.jsx("option",{value:"AES256",children:"AES256"})]})]}),o.jsx(w,{label:"Create Key",onClick:h})]}),o.jsxs("div",{style:{marginTop:n.spacing.lg,paddingTop:n.spacing.md,borderTop:`1px solid ${e.border}`},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:600,color:e.accent,marginBottom:n.spacing.sm,fontFamily:"Consolas"},children:[m.blockFull," EXISTING KEYS"]}),y.length===0?o.jsx("div",{style:{color:e.muted,fontSize:11,padding:n.spacing.sm,fontFamily:"Consolas"},children:"No encryption keys found. Create one above."}):o.jsx(Q,{keys:y})]}),o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:n.spacing.lg},children:o.jsx(w,{label:"Close",onClick:()=>l(!1),variant:"ghost"})})]})})]})})]})};export{re as default};
