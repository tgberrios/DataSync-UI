import{j as e,t as s,b as o,r as d,e as h,aa as S,C as ne}from"./index-b1fa964d.js";import{e as B}from"./errorHandler-5ea9ae85.js";import{A as T}from"./AsciiButton-3fcfdd9b.js";import{A as se}from"./AsciiConnectionStringSelector-7dd1e3aa.js";import{S as re}from"./SkeletonLoader-09c12074.js";import{C as ae,a as ie,L as le,e as de,f as ce,p as ue,b as pe,i as ge}from"./chart-29c351ca.js";import{L as xe}from"./index-5bb8c076.js";import"./GCSConnectionConfig-e2d15d83.js";const H=i=>{switch(i){case"completed":return o.accent;case"failed":return o.foreground;case"in_progress":case"pending":return o.muted;default:return o.foreground}},he=i=>i?i<1024?`${i} B`:i<1024*1024?`${(i/1024).toFixed(2)} KB`:i<1024*1024*1024?`${(i/(1024*1024)).toFixed(2)} MB`:`${(i/(1024*1024*1024)).toFixed(2)} GB`:"N/A",fe=({backups:i,onViewHistory:p,onToggleSchedule:y,onRestore:c,onDelete:f,onSelect:l})=>i.length===0?e.jsx("div",{style:{padding:s.spacing.lg,textAlign:"center",color:o.muted,fontFamily:"Consolas",fontSize:12},children:"No backups found"}):e.jsxs("div",{style:{fontFamily:"Consolas",fontSize:12,color:o.foreground,border:`1px solid ${o.border}`,borderRadius:2,overflow:"hidden"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 100px 70px 80px 70px 130px 1fr",gap:s.spacing.sm,padding:`${s.spacing.sm} ${s.spacing.md}`,background:o.backgroundSoft,borderBottom:`1px solid ${o.border}`,fontWeight:600,fontSize:11,textTransform:"uppercase",color:o.muted},children:[e.jsx("span",{children:"Name"}),e.jsx("span",{children:"Engine"}),e.jsx("span",{children:"Database"}),e.jsx("span",{children:"Type"}),e.jsx("span",{children:"Status"}),e.jsx("span",{children:"Size"}),e.jsx("span",{children:"Created"}),e.jsx("span",{style:{textAlign:"right"},children:"Actions"})]}),i.map(u=>e.jsxs("div",{onClick:()=>l==null?void 0:l(u),role:"row",tabIndex:0,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),l==null||l(u))},style:{display:"grid",gridTemplateColumns:"1fr 90px 100px 70px 80px 70px 130px 1fr",gap:s.spacing.sm,padding:`${s.spacing.sm} ${s.spacing.md}`,alignItems:"center",borderBottom:`1px solid ${o.border}`,cursor:"pointer",transition:"background 0.15s ease",background:"transparent"},onMouseEnter:r=>{r.currentTarget.style.background=o.backgroundSoft},onMouseLeave:r=>{r.currentTarget.style.background="transparent"},children:[e.jsx("span",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:u.backup_name}),e.jsx("span",{style:{color:o.muted,fontSize:11},children:u.db_engine||"—"}),e.jsx("span",{style:{color:o.foreground,fontSize:11},children:u.database_name||"—"}),e.jsx("span",{style:{color:o.muted,fontSize:11},children:u.backup_type.toUpperCase()}),e.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${H(u.status)}`,color:H(u.status),backgroundColor:"transparent",width:"fit-content"},children:u.status.toUpperCase()}),e.jsx("span",{style:{color:o.muted,fontSize:11},children:he(u.file_size)}),e.jsx("span",{style:{color:o.muted,fontSize:11},children:u.created_at?new Date(u.created_at).toLocaleString():"—"}),e.jsxs("div",{style:{display:"flex",gap:4,justifyContent:"flex-end",flexWrap:"wrap"},onClick:r=>r.stopPropagation(),children:[e.jsx(T,{label:"History",onClick:()=>p==null?void 0:p(u.backup_id),variant:"ghost",style:{fontSize:10,padding:"2px 6px"}}),u.cron_schedule&&e.jsx(T,{label:u.is_scheduled?"Disable":"Enable",onClick:()=>y==null?void 0:y(u),variant:"ghost",style:{fontSize:10,padding:"2px 6px"}}),u.status==="completed"&&e.jsx(T,{label:"Restore",onClick:()=>c==null?void 0:c(u.backup_id),variant:"ghost",style:{fontSize:10,padding:"2px 6px"}}),e.jsx(T,{label:"Delete",onClick:()=>f==null?void 0:f(u.backup_id),variant:"ghost",style:{fontSize:10,padding:"2px 6px"}})]})]},u.backup_id))]});ae.register(ie,le,de,ce,ue,pe,ge);function be(i){const p=new Map;i.forEach(c=>{if(!c.created_at)return;const f=new Date(c.created_at),l=`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}-${String(f.getDate()).padStart(2,"0")}`;p.set(l,(p.get(l)??0)+1)});const y=Array.from(p.entries()).sort(([c],[f])=>c.localeCompare(f));return{labels:y.map(([c])=>c),counts:y.map(([,c])=>c)}}const me=({backups:i})=>{const p=d.useMemo(()=>{const{labels:c,counts:f}=be(i);return c.length===0?null:{labels:c,datasets:[{label:"Backups",data:f,borderColor:o.accent,backgroundColor:`${o.accent}20`,fill:!0,tension:.3,pointBackgroundColor:o.accent,pointBorderColor:o.background,pointBorderWidth:1}]}},[i]),y=d.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Backups over time (by creation date)",font:{family:"Consolas",size:12},color:o.foreground},legend:{display:!1},tooltip:{titleFont:{family:"Consolas"},bodyFont:{family:"Consolas"}}},scales:{x:{grid:{color:o.border},ticks:{font:{family:"Consolas",size:10},color:o.muted,maxRotation:45}},y:{beginAtZero:!0,grid:{color:o.border},ticks:{font:{family:"Consolas",size:10},color:o.muted,stepSize:1}}}}),[]);return!p||p.labels.length===0?e.jsx("div",{style:{padding:s.spacing.xl,textAlign:"center",color:o.muted,fontFamily:"Consolas",fontSize:12,border:`1px solid ${o.border}`,borderRadius:2,background:o.background},children:"No backup dates to display. Create backups to see the chart."}):e.jsx("div",{style:{height:280,padding:s.spacing.md,border:`1px solid ${o.border}`,borderRadius:2,background:o.background},children:e.jsx(xe,{data:p,options:y})})},ye=({history:i,backupName:p,backupId:y})=>{const[c,f]=d.useState(!0),l=r=>{switch(r){case"completed":return o.accent;case"failed":return o.foreground;case"in_progress":return o.muted;case"pending":return o.muted;default:return o.foreground}},u=r=>r?r<1024?`${r} B`:r<1024*1024?`${(r/1024).toFixed(2)} KB`:r<1024*1024*1024?`${(r/(1024*1024)).toFixed(2)} MB`:`${(r/(1024*1024*1024)).toFixed(2)} GB`:"N/A";return i.length===0?e.jsx("div",{style:{padding:s.spacing.lg,textAlign:"center",color:o.muted,fontFamily:"Consolas",fontSize:12},children:"No backup history available"}):e.jsxs("div",{style:{fontFamily:"Consolas",fontSize:12,color:o.foreground},children:[p&&e.jsxs("div",{onClick:()=>f(!c),style:{display:"flex",alignItems:"center",padding:"10px 8px",cursor:"pointer",borderLeft:`2px solid ${o.accent}`,backgroundColor:c?o.backgroundSoft:o.background,transition:"all 0.15s ease",marginBottom:2},onMouseEnter:r=>{r.currentTarget.style.backgroundColor=o.backgroundSoft},onMouseLeave:r=>{c||(r.currentTarget.style.backgroundColor=o.background)},children:[e.jsx("span",{style:{marginRight:8,color:c?o.accent:o.muted,fontSize:10,transition:"transform 0.15s ease",display:"inline-block",transform:c?"rotate(90deg)":"rotate(0deg)"},children:h.arrowRight}),e.jsx("span",{style:{fontWeight:600,color:o.accent,fontSize:12,flex:1},children:p}),e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${o.border}`,backgroundColor:o.backgroundSoft,color:o.foreground},children:i.length})]}),c&&e.jsx("div",{style:{paddingLeft:p?24:0},children:i.map((r,g)=>{const A=g===i.length-1;return e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",padding:"8px 8px",marginLeft:p?8:0,marginBottom:2,borderLeft:`1px solid ${o.border}`,backgroundColor:"transparent",transition:"all 0.15s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor=o.backgroundSoft,b.currentTarget.style.borderLeftColor=o.accent},onMouseLeave:b=>{b.currentTarget.style.backgroundColor="transparent",b.currentTarget.style.borderLeftColor=o.border},children:[p&&e.jsx("span",{style:{color:o.border,marginRight:6,fontFamily:"Consolas",fontSize:11},children:A?`${h.bl}${h.h}${h.h} `:`${h.tRight}${h.h}${h.h} `}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,flexWrap:"wrap"},children:[e.jsx("span",{style:{fontWeight:500,color:o.foreground,fontSize:11},children:new Date(r.started_at).toLocaleString()}),e.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${l(r.status)}`,color:l(r.status),backgroundColor:"transparent"},children:r.status.toUpperCase()}),r.duration_seconds&&e.jsxs("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${o.border}`,color:o.muted,backgroundColor:"transparent"},children:[r.duration_seconds,"s"]}),r.file_size&&e.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${o.border}`,color:o.muted,backgroundColor:"transparent"},children:u(r.file_size)}),r.triggered_by&&e.jsx("span",{style:{padding:"2px 6px",borderRadius:2,fontSize:10,fontWeight:500,border:`1px solid ${o.border}`,color:o.muted,backgroundColor:"transparent"},children:r.triggered_by.toUpperCase()})]}),r.error_message&&e.jsxs("div",{style:{fontSize:10,color:o.foreground,fontFamily:"Consolas",padding:"4px 8px",backgroundColor:o.backgroundSoft,borderRadius:2,border:`1px solid ${o.border}`,marginTop:4,wordBreak:"break-word"},children:["Error: ",r.error_message]})]})]},r.id||g)})})]})},ze=()=>{var N;const[i,p]=d.useState([]),[y,c]=d.useState(!0),[f,l]=d.useState(null),[u,r]=d.useState(!1),[g,A]=d.useState(null),[b,W]=d.useState({db_engine:"",status:""}),[j,E]=d.useState(1),[$,Q]=d.useState(0),k=20,z=t=>{switch(t){case"PostgreSQL":return"postgresql://username:password@localhost:5432/database_name";case"MariaDB":return"mysql://username:password@localhost:3306/database_name";case"MongoDB":return"mongodb://username:password@localhost:27017/database_name?authSource=admin";case"Oracle":return"oracle://username:password@localhost:1521/XE";default:return""}},[n,m]=d.useState({backup_name:"",db_engine:"PostgreSQL",connection_string:z("PostgreSQL"),database_name:"",selected_databases:[],backup_type:"full",cron_schedule:"",is_scheduled:!1}),[I,P]=d.useState([]),[U,L]=d.useState(!1),[R,M]=d.useState(null),[_,F]=d.useState([]),[D,w]=d.useState(!1),[Y,O]=d.useState(!1);d.useEffect(()=>{if(n.db_engine){const t=z(n.db_engine),a=n.connection_string,x=[z("PostgreSQL"),z("MariaDB"),z("MongoDB"),z("Oracle")].includes(a);(!a||x)&&(m(C=>({...C,connection_string:t})),w(!1),F([]))}},[n.db_engine]);const v=d.useCallback(async()=>{const t=Date.now(),a=300;try{c(!0),l(null);const x={page:j,limit:k};b.db_engine&&(x.db_engine=b.db_engine),b.status&&(x.status=b.status);const C=await S.getAll(x),ee=Date.now()-t,oe=Math.max(0,a-ee);await new Promise(te=>setTimeout(te,oe)),p(C.backups||[]),Q(C.total||0)}catch(x){l(B(x))}finally{c(!1)}},[j,b]);d.useEffect(()=>{v();const t=setInterval(v,5e3);return()=>clearInterval(t)},[v]);const G=d.useCallback(async()=>{if(!n.connection_string){l("Please enter a connection string first");return}try{l(null),O(!0),await S.testConnection(n.db_engine,n.connection_string);const t=await S.discoverDatabases(n.db_engine,n.connection_string);F(t.databases||[]),w(!0)}catch(t){l(B(t)),F([]),w(!1)}finally{O(!1)}},[n.db_engine,n.connection_string]),K=d.useCallback(async()=>{try{l(null);const t=n.is_scheduled&&n.selected_databases.length>0?n.selected_databases:[n.database_name].filter(Boolean);if(t.length===0){l("Please select at least one database");return}for(const a of t){const x=n.is_scheduled?`${a}_${new Date().toISOString().replace(/[:.]/g,"-").slice(0,19)}`:n.backup_name||`${a}_backup`;await S.create({backup_name:x,db_engine:n.db_engine,connection_string:n.connection_string,database_name:a,backup_type:n.backup_type,cron_schedule:n.is_scheduled&&n.cron_schedule?n.cron_schedule:void 0})}r(!1),m({backup_name:"",db_engine:"PostgreSQL",connection_string:"",database_name:"",selected_databases:[],backup_type:"full",cron_schedule:"",is_scheduled:!1}),F([]),w(!1),v()}catch(t){l(B(t))}},[n,v]),q=d.useCallback(async t=>{try{l(null);const a=await S.getHistory(t);P(a.history||[]),M(t),L(!0)}catch(a){l(B(a))}},[]),X=d.useCallback(async t=>{try{l(null),t.is_scheduled?await S.disableSchedule(t.backup_id):await S.enableSchedule(t.backup_id),v()}catch(a){l(B(a))}},[v]),V=d.useCallback(async t=>{if(confirm("Are you sure you want to delete this backup?"))try{l(null),await S.delete(t),v()}catch(a){l(B(a))}},[v]),Z=t=>{if(!t)return"N/A";const a=["B","KB","MB","GB","TB"];let x=t,C=0;for(;x>=1024&&C<a.length-1;)x/=1024,C++;return`${x.toFixed(2)} ${a[C]}`},J=t=>{switch(t){case"completed":return o.accent;case"failed":return o.foreground;case"in_progress":return o.muted;case"pending":return o.muted;default:return o.foreground}};return y&&i.length===0?e.jsx(re,{variant:"table"}):e.jsxs(ne,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:s.spacing.lg,paddingBottom:s.spacing.md,borderBottom:`2px solid ${o.accent}`},children:[e.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:0,color:o.foreground,fontFamily:"Consolas",textTransform:"uppercase"},children:[e.jsx("span",{style:{color:o.accent,marginRight:s.spacing.sm},children:h.blockFull}),"BACKUP MANAGER"]}),e.jsx(T,{label:"+ CREATE BACKUP",onClick:()=>r(!0),variant:"primary"})]}),f&&e.jsx("div",{style:{padding:s.spacing.sm,marginBottom:s.spacing.md,background:o.backgroundSoft,border:`1px solid ${o.border}`,borderRadius:2,color:o.foreground,fontSize:12,fontFamily:"Consolas"},children:f}),e.jsxs("div",{style:{display:"flex",gap:s.spacing.sm,marginBottom:s.spacing.md},children:[e.jsxs("select",{value:b.db_engine,onChange:t=>{W(a=>({...a,db_engine:t.target.value})),E(1)},style:{padding:`${s.spacing.xs} ${s.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,background:o.background,color:o.foreground,fontFamily:"Consolas",fontSize:12,cursor:"pointer",outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=o.accent,t.target.style.outline=`2px solid ${o.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=o.border,t.target.style.outline="none"},children:[e.jsx("option",{value:"",children:"All Engines"}),e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"MariaDB",children:"MariaDB"}),e.jsx("option",{value:"MSSQL",children:"MSSQL"}),e.jsx("option",{value:"MongoDB",children:"MongoDB"}),e.jsx("option",{value:"Oracle",children:"Oracle"}),e.jsx("option",{value:"DB2",children:"DB2"}),e.jsx("option",{value:"Salesforce",children:"Salesforce"}),e.jsx("option",{value:"SAP",children:"SAP"}),e.jsx("option",{value:"Teradata",children:"Teradata"}),e.jsx("option",{value:"Netezza",children:"Netezza"}),e.jsx("option",{value:"Hive",children:"Hive"}),e.jsx("option",{value:"Cassandra",children:"Cassandra"}),e.jsx("option",{value:"DynamoDB",children:"DynamoDB"}),e.jsx("option",{value:"AS400",children:"AS/400"}),e.jsx("option",{value:"S3",children:"S3"}),e.jsx("option",{value:"AzureBlob",children:"Azure Blob"}),e.jsx("option",{value:"GCS",children:"Google Cloud Storage"}),e.jsx("option",{value:"FTP",children:"FTP"}),e.jsx("option",{value:"SFTP",children:"SFTP"}),e.jsx("option",{value:"Email",children:"Email"}),e.jsx("option",{value:"SOAP",children:"SOAP"}),e.jsx("option",{value:"GraphQL",children:"GraphQL"}),e.jsx("option",{value:"Excel",children:"Excel"}),e.jsx("option",{value:"FixedWidth",children:"Fixed Width"}),e.jsx("option",{value:"EBCDIC",children:"EBCDIC"}),e.jsx("option",{value:"XML",children:"XML"}),e.jsx("option",{value:"Avro",children:"Avro"}),e.jsx("option",{value:"Parquet",children:"Parquet"}),e.jsx("option",{value:"ORC",children:"ORC"}),e.jsx("option",{value:"Compressed",children:"Compressed"})]}),e.jsxs("select",{value:b.status,onChange:t=>{W(a=>({...a,status:t.target.value})),E(1)},style:{padding:`${s.spacing.xs} ${s.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,background:o.background,color:o.foreground,fontFamily:"Consolas",fontSize:12,cursor:"pointer",outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=o.accent,t.target.style.outline=`2px solid ${o.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=o.border,t.target.style.outline="none"},children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),y?e.jsx("div",{style:{padding:40,textAlign:"center",color:o.muted,fontFamily:"Consolas",fontSize:12},children:"Loading backups..."}):i.length===0?e.jsx("div",{style:{padding:40,textAlign:"center",color:o.muted,fontFamily:"Consolas",fontSize:12},children:"No backups found"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:s.spacing.lg},children:e.jsx(me,{backups:i})}),e.jsx(fe,{backups:i,onViewHistory:q,onToggleSchedule:X,onRestore:t=>{confirm("Restore this backup?")&&S.restore(t).then(()=>{alert("Restore operation started")}).catch(a=>{l(B(a))})},onDelete:V,onSelect:A}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:s.spacing.md,paddingTop:s.spacing.md,borderTop:`1px solid ${o.border}`},children:[e.jsxs("div",{style:{color:o.muted,fontSize:11,fontFamily:"Consolas"},children:["Showing ",(j-1)*k+1," - ",Math.min(j*k,$)," of ",$]}),e.jsxs("div",{style:{display:"flex",gap:s.spacing.sm},children:[e.jsx("button",{onClick:()=>E(t=>Math.max(1,t-1)),disabled:j===1,style:{padding:`${s.spacing.xs} ${s.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,background:j===1?o.backgroundSoft:o.background,color:j===1?o.muted:o.foreground,cursor:j===1?"not-allowed":"pointer",fontSize:11,fontFamily:"Consolas"},children:"Previous"}),e.jsx("button",{onClick:()=>E(t=>t+1),disabled:j*k>=$,style:{padding:`${s.spacing.xs} ${s.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,background:j*k>=$?o.backgroundSoft:o.background,color:j*k>=$?o.muted:o.foreground,cursor:j*k>=$?"not-allowed":"pointer",fontSize:11,fontFamily:"Consolas"},children:"Next"})]})]})]}),u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",zIndex:999},onClick:()=>r(!1)}),e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:o.background,padding:s.spacing.lg,borderRadius:2,border:`2px solid ${o.accent}`,zIndex:1e3,minWidth:500,maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",fontFamily:"Consolas"},onClick:t=>t.stopPropagation(),children:[e.jsx("style",{children:`
              div[style*="overflowY"]::-webkit-scrollbar {
                width: 0px;
                display: none;
              }
              div[style*="overflowY"] {
                -ms-overflow-style: none;
                scrollbar-width: none;
              }
            `}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:s.spacing.md,paddingBottom:s.spacing.sm,borderBottom:`2px solid ${o.border}`},children:[e.jsxs("h2",{style:{fontSize:14,fontWeight:600,color:o.accent,margin:0,fontFamily:"Consolas",textTransform:"uppercase"},children:[h.blockFull," CREATE BACKUP"]}),e.jsx("button",{onClick:()=>{r(!1),m({backup_name:"",db_engine:"PostgreSQL",connection_string:"",database_name:"",selected_databases:[],backup_type:"full",cron_schedule:"",is_scheduled:!1}),F([]),w(!1)},style:{background:"transparent",border:"none",color:o.foreground,fontSize:20,cursor:"pointer",padding:`0 ${s.spacing.sm}`,fontFamily:"Consolas"},children:"×"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:s.spacing.md},children:[!n.is_scheduled&&e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:o.foreground,marginBottom:s.spacing.xs,fontFamily:"Consolas",textTransform:"uppercase"},children:[h.v," BACKUP NAME *"]}),e.jsx("input",{type:"text",value:n.backup_name,onChange:t=>m(a=>({...a,backup_name:t.target.value})),placeholder:"my_backup_2024",style:{width:"100%",padding:`${s.spacing.xs} ${s.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=o.accent,t.target.style.outline=`2px solid ${o.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=o.border,t.target.style.outline="none"}})]}),n.is_scheduled&&e.jsxs("div",{style:{padding:s.spacing.sm,background:o.backgroundSoft,border:`1px solid ${o.accent}`,borderRadius:2,fontSize:11,color:o.muted,fontFamily:"Consolas"},children:[h.blockSemi," Backup name will be auto-generated as: database_name_YYYY-MM-DDTHH-MM-SS"]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:o.foreground,marginBottom:s.spacing.xs,fontFamily:"Consolas",textTransform:"uppercase"},children:[h.v," DB ENGINE *"]}),e.jsxs("select",{value:n.db_engine,onChange:t=>m(a=>({...a,db_engine:t.target.value})),style:{width:"100%",padding:`${s.spacing.xs} ${s.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=o.accent,t.target.style.outline=`2px solid ${o.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=o.border,t.target.style.outline="none"},children:[e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"MariaDB",children:"MariaDB"}),e.jsx("option",{value:"MSSQL",children:"MSSQL"}),e.jsx("option",{value:"MongoDB",children:"MongoDB"}),e.jsx("option",{value:"Oracle",children:"Oracle"}),e.jsx("option",{value:"DB2",children:"DB2"}),e.jsx("option",{value:"Salesforce",children:"Salesforce"}),e.jsx("option",{value:"SAP",children:"SAP"}),e.jsx("option",{value:"Teradata",children:"Teradata"}),e.jsx("option",{value:"Netezza",children:"Netezza"}),e.jsx("option",{value:"Hive",children:"Hive"}),e.jsx("option",{value:"Cassandra",children:"Cassandra"}),e.jsx("option",{value:"DynamoDB",children:"DynamoDB"}),e.jsx("option",{value:"AS400",children:"AS/400"}),e.jsx("option",{value:"S3",children:"S3"}),e.jsx("option",{value:"AzureBlob",children:"Azure Blob"}),e.jsx("option",{value:"GCS",children:"Google Cloud Storage"}),e.jsx("option",{value:"FTP",children:"FTP"}),e.jsx("option",{value:"SFTP",children:"SFTP"}),e.jsx("option",{value:"Email",children:"Email"}),e.jsx("option",{value:"SOAP",children:"SOAP"}),e.jsx("option",{value:"GraphQL",children:"GraphQL"}),e.jsx("option",{value:"Excel",children:"Excel"}),e.jsx("option",{value:"FixedWidth",children:"Fixed Width"}),e.jsx("option",{value:"EBCDIC",children:"EBCDIC"}),e.jsx("option",{value:"XML",children:"XML"}),e.jsx("option",{value:"Avro",children:"Avro"}),e.jsx("option",{value:"Parquet",children:"Parquet"}),e.jsx("option",{value:"ORC",children:"ORC"}),e.jsx("option",{value:"Compressed",children:"Compressed"})]})]}),e.jsxs("div",{children:[e.jsx(se,{value:n.connection_string,onChange:t=>{m(a=>({...a,connection_string:t})),w(!1),F([])},dbEngine:n.db_engine,label:"Connection String",required:!0,onTestConnection:G,isTesting:Y,testResult:D?{success:!0,message:`Connection successful! Found ${_.length} database(s)`}:null}),D&&_.length>0&&e.jsxs("div",{style:{marginTop:s.spacing.sm,padding:s.spacing.sm,background:o.accent+"20",border:`1px solid ${o.accent}`,borderRadius:2,fontSize:11,color:o.accent,fontFamily:"Consolas"},children:[h.blockSemi," Connection successful! Found ",_.length," database(s)"]})]}),D&&n.is_scheduled&&_.length>0?e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:o.foreground,marginBottom:s.spacing.xs,fontFamily:"Consolas",textTransform:"uppercase"},children:[h.v," SELECT DATABASES TO BACKUP *"]}),e.jsxs("div",{style:{maxHeight:200,overflowY:"auto",border:`1px solid ${o.border}`,borderRadius:2,padding:s.spacing.sm,background:o.background},children:[e.jsx("style",{children:`
                      div[style*="overflowY"]::-webkit-scrollbar {
                        width: 0px;
                        display: none;
                      }
                      div[style*="overflowY"] {
                        -ms-overflow-style: none;
                        scrollbar-width: none;
                      }
                    `}),_.map(t=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:s.spacing.sm,padding:`${s.spacing.xs} 0`,fontFamily:"Consolas",fontSize:12},children:[e.jsx("input",{type:"checkbox",checked:n.selected_databases.includes(t),onChange:a=>{a.target.checked?m(x=>({...x,selected_databases:[...x.selected_databases,t]})):m(x=>({...x,selected_databases:x.selected_databases.filter(C=>C!==t)}))},style:{cursor:"pointer"}}),e.jsx("span",{style:{color:o.foreground},children:t})]},t))]})]}):!n.is_scheduled&&e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:o.foreground,marginBottom:s.spacing.xs,fontFamily:"Consolas",textTransform:"uppercase"},children:[h.v," DATABASE NAME *"]}),D&&_.length>0?e.jsxs("select",{value:n.database_name,onChange:t=>m(a=>({...a,database_name:t.target.value})),style:{width:"100%",padding:`${s.spacing.xs} ${s.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=o.accent,t.target.style.outline=`2px solid ${o.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=o.border,t.target.style.outline="none"},children:[e.jsx("option",{value:"",children:"Select a database"}),_.map(t=>e.jsx("option",{value:t,children:t},t))]}):e.jsx("input",{type:"text",value:n.database_name,onChange:t=>m(a=>({...a,database_name:t.target.value})),placeholder:"mydatabase",style:{width:"100%",padding:`${s.spacing.xs} ${s.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=o.accent,t.target.style.outline=`2px solid ${o.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=o.border,t.target.style.outline="none"}})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:o.foreground,marginBottom:s.spacing.xs,fontFamily:"Consolas",textTransform:"uppercase"},children:[h.v," BACKUP TYPE *"]}),e.jsxs("select",{value:n.backup_type,onChange:t=>m(a=>({...a,backup_type:t.target.value})),style:{width:"100%",padding:`${s.spacing.xs} ${s.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,cursor:"pointer",outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=o.accent,t.target.style.outline=`2px solid ${o.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=o.border,t.target.style.outline="none"},children:[e.jsx("option",{value:"full",children:"Full (Structure + Data)"}),e.jsx("option",{value:"structure",children:"Structure Only"}),e.jsx("option",{value:"data",children:"Data Only"}),e.jsx("option",{value:"config",children:"Config Only"})]})]}),e.jsxs("div",{style:{padding:s.spacing.sm,background:o.backgroundSoft,border:`1px solid ${o.border}`,borderRadius:2},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:s.spacing.sm,marginBottom:s.spacing.sm},children:[e.jsx("input",{type:"checkbox",checked:n.is_scheduled,onChange:t=>m(a=>({...a,is_scheduled:t.target.checked})),style:{cursor:"pointer"}}),e.jsxs("label",{style:{fontSize:12,fontWeight:600,color:o.foreground,fontFamily:"Consolas",textTransform:"uppercase",cursor:"pointer"},children:[h.v," ENABLE SCHEDULED BACKUP"]})]}),n.is_scheduled&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:11,fontWeight:600,color:o.muted,marginBottom:s.spacing.xs,fontFamily:"Consolas"},children:"CRON SCHEDULE (minute hour day month dow)"}),e.jsx("input",{type:"text",value:n.cron_schedule,onChange:t=>m(a=>({...a,cron_schedule:t.target.value})),placeholder:"0 2 * * *",style:{width:"100%",padding:`${s.spacing.xs} ${s.spacing.sm}`,border:`1px solid ${o.border}`,borderRadius:2,fontSize:12,fontFamily:"Consolas",backgroundColor:o.background,color:o.foreground,outline:"none",transition:"border-color 0.15s ease"},onFocus:t=>{t.target.style.borderColor=o.accent,t.target.style.outline=`2px solid ${o.accent}`,t.target.style.outlineOffset="2px"},onBlur:t=>{t.target.style.borderColor=o.border,t.target.style.outline="none"}}),e.jsx("div",{style:{marginTop:s.spacing.sm,fontSize:10,color:o.muted,fontFamily:"Consolas",fontStyle:"italic"},children:'Examples: "0 2 * * *" (daily at 2 AM), "0 */6 * * *" (every 6 hours), "0 0 * * 0" (weekly on Sunday)'})]})]}),e.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:8,paddingTop:16,borderTop:`1px solid ${o.border}`},children:[e.jsx("button",{onClick:()=>r(!1),style:{padding:"8px 16px",border:`1px solid ${o.border}`,borderRadius:2,background:o.backgroundSoft,color:o.foreground,cursor:"pointer",fontSize:12,fontFamily:"Consolas",fontWeight:600},children:"CANCEL"}),e.jsx("button",{onClick:K,disabled:!n.connection_string||(n.is_scheduled?n.selected_databases.length===0:!n.database_name)||!n.is_scheduled&&!n.backup_name,style:{padding:"8px 16px",border:`1px solid ${o.accent}`,borderRadius:2,background:!n.connection_string||(n.is_scheduled?n.selected_databases.length===0:!n.database_name)||!n.is_scheduled&&!n.backup_name?o.backgroundSoft:o.accent,color:!n.connection_string||(n.is_scheduled?n.selected_databases.length===0:!n.database_name)||!n.is_scheduled&&!n.backup_name?o.muted:o.background,cursor:!n.connection_string||(n.is_scheduled?n.selected_databases.length===0:!n.database_name)||!n.is_scheduled&&!n.backup_name?"not-allowed":"pointer",fontSize:12,fontFamily:"Consolas",fontWeight:600},children:"CREATE"})]})]})]})]}),g&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",zIndex:999},onClick:()=>A(null)}),e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:o.background,padding:24,borderRadius:2,border:`2px solid ${o.accent}`,zIndex:1e3,minWidth:600,maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",fontFamily:"Consolas"},onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20,paddingBottom:12,borderBottom:`2px solid ${o.border}`},children:[e.jsxs("h2",{style:{fontSize:14,fontWeight:600,color:o.accent,margin:0,fontFamily:"Consolas",textTransform:"uppercase"},children:[h.blockFull," BACKUP DETAILS"]}),e.jsx("button",{onClick:()=>A(null),style:{background:"transparent",border:"none",color:o.foreground,fontSize:20,cursor:"pointer",padding:"0 8px"},children:"×"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12,fontSize:12},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",g.backup_name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Engine:"})," ",g.db_engine]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Database:"})," ",g.database_name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Type:"})," ",g.backup_type.toUpperCase()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx("span",{style:{color:J(g.status)},children:g.status.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Size:"})," ",Z(g.file_size)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"File Path:"})," ",g.file_path]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Created:"})," ",new Date(g.created_at).toLocaleString()]}),g.completed_at&&e.jsxs("div",{children:[e.jsx("strong",{children:"Completed:"})," ",new Date(g.completed_at).toLocaleString()]}),g.created_by&&e.jsxs("div",{children:[e.jsx("strong",{children:"Created By:"})," ",g.created_by]}),g.error_message&&e.jsxs("div",{style:{color:o.foreground},children:[e.jsx("strong",{children:"Error:"})," ",g.error_message]})]})]})]}),U&&R&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",zIndex:999},onClick:()=>{L(!1),M(null),P([])}}),e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:o.background,padding:24,borderRadius:2,border:`2px solid ${o.accent}`,zIndex:1e3,minWidth:800,maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",fontFamily:"Consolas"},onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20,paddingBottom:12,borderBottom:`2px solid ${o.border}`},children:[e.jsxs("h2",{style:{fontSize:14,fontWeight:600,color:o.accent,margin:0,fontFamily:"Consolas",textTransform:"uppercase"},children:[h.blockFull," BACKUP EXECUTION HISTORY"]}),e.jsx("button",{onClick:()=>{L(!1),M(null),P([])},style:{background:"transparent",border:"none",color:o.foreground,fontSize:20,cursor:"pointer",padding:"0 8px"},children:"×"})]}),I.length===0?e.jsx("div",{style:{padding:40,textAlign:"center",color:o.muted,fontFamily:"Consolas",fontSize:12},children:"No execution history found"}):e.jsx(ye,{history:I,backupName:(N=i.find(t=>t.backup_id===R))==null?void 0:N.backup_name,backupId:R||void 0})]})]})]})};export{ze as default};
