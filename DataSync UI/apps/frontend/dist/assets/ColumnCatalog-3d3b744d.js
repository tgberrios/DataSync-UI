import{m as Z,f as F,b as i,r as g,j as e,e as r,v as O,l as ee,P as ce,n as ie}from"./index-75d7470b.js";import{u as ge}from"./useTableFilters-0b8dd77f.js";import{u as pe}from"./usePagination-b946ac42.js";import{e as oe}from"./errorHandler-5ea9ae85.js";import{s as he}from"./validation-24839588.js";import{A as C}from"./AsciiPanel-9f053981.js";import{A as q}from"./AsciiButton-446d8430.js";const re=Z`
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
`,xe=Z`
  from {
    max-height: 0;
    opacity: 0;
  }
  to {
    max-height: 1000px;
    opacity: 1;
  }
`,me=Z`
  from {
    max-height: 1000px;
    opacity: 1;
  }
  to {
    max-height: 0;
    opacity: 0;
  }
`,te=F.div`
  font-family: Consolas;
  font-size: 12px;
  background: ${i.background};
  border: 1px solid ${i.border};
  border-radius: 2px;
  padding: 16px;
  max-height: 800px;
  overflow-y: auto;
  overflow-x: hidden;
  position: relative;
  
  &::-webkit-scrollbar {
    width: 8px;
  }
  
  &::-webkit-scrollbar-track {
    background: ${i.backgroundSoft};
    border-radius: 2px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: ${i.border};
    border-radius: 2px;
    transition: background 0.2s ease;
    
    &:hover {
      background: ${i.accent};
    }
  }
`,G=F.div`
  user-select: none;
  animation: ${re} 0.3s ease-out;
  margin-bottom: 2px;
`,ue=F.span`
  color: ${i.muted};
  margin-right: 6px;
  font-family: Consolas;
  font-size: 12px;
  transition: color 0.2s ease;
`,K=F.div`
  display: flex;
  align-items: center;
  padding: ${l=>l.$level===0?"8px":(l.$level===1,"6px 8px")};
  padding-left: ${l=>l.$level*24+8}px;
  cursor: pointer;
  border-radius: 2px;
  transition: all 0.2s ease;
  position: relative;
  margin: 2px 0;
  font-family: Consolas;
  font-size: 12px;
  
  ${l=>l.$nodeType==="schema"?`
        background: ${i.accentLight};
        border-left: 3px solid ${i.accent};
        font-weight: 600;
      `:l.$nodeType==="table"?`
        background: ${i.backgroundSoft};
        border-left: 2px solid ${i.border};
      `:`
      border-left: 1px solid ${i.border};
    `}
  
  &:hover {
    background: ${l=>l.$nodeType==="schema"?i.accentLight:i.backgroundSoft};
    transform: translateX(2px);
  }
  
  &:active {
    transform: translateX(1px) scale(0.99);
  }
`,Q=F.div`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  margin-right: 8px;
  border-radius: 2px;
  background: ${l=>l.$isExpanded?i.accent:i.backgroundSoft};
  color: ${l=>l.$isExpanded?"#ffffff":i.accent};
  font-size: 10px;
  font-weight: bold;
  font-family: Consolas;
  transition: all 0.2s ease;
  flex-shrink: 0;
  
  &:hover {
    transform: scale(1.1);
  }
`,V=F.span`
  font-weight: ${l=>l.$isSchema?"700":l.$isTable?"600":"500"};
  font-size: ${l=>l.$isSchema?"13px":(l.$isTable,"12px")};
  font-family: Consolas;
  color: ${l=>l.$isSchema?i.accent:l.$isTable?i.foreground:i.foreground};
  margin-right: 12px;
  transition: color 0.2s ease;
  letter-spacing: ${l=>l.$isSchema?"0.3px":"0"};
`,X=F.div`
  display: inline-flex;
  gap: 6px;
  align-items: center;
  margin-left: auto;
  flex-wrap: wrap;
  font-size: 11px;
  font-family: Consolas;
`,ne=F.span`
  padding: 2px 8px;
  border-radius: 2px;
  font-size: 11px;
  font-weight: 500;
  font-family: Consolas;
  background: ${i.backgroundSoft};
  color: ${i.foreground};
  border: 1px solid ${i.border};
  transition: all 0.2s ease;
  
  &:hover {
    background: ${i.accentLight};
    border-color: ${i.accent};
    color: ${i.accent};
    transform: translateY(-1px);
  }
`,u=(l,k,B)=>{if(l)switch(l){case"PK":return i.accent;case"FK":return i.warning;case"UQ":return i.success;case"IDX":return i.accent;default:return i.muted}if(k)switch(k){case"HIGH":return i.danger;case"MEDIUM":return i.warning;case"LOW":return i.success;default:return i.muted}return B!==void 0?B?i.danger:i.success:i.muted},J=F.div`
  overflow: hidden;
  animation: ${l=>l.$isExpanded?xe:me} 0.3s ease-out;
  padding-left: ${l=>l.$level*24+36}px;
`,fe=F.div`
  padding: 60px 40px;
  text-align: center;
  color: ${i.muted};
  animation: ${re} 0.5s ease-out;
  font-family: Consolas;
`,ye=({columns:l,onColumnClick:k})=>{const[B,L]=g.useState(new Set),[n,W]=g.useState(new Set),[h,E]=g.useState(new Set),f=g.useMemo(()=>{const t=new Map;return l.forEach(a=>{const s=a.schema_name,c=a.table_name;t.has(s)||t.set(s,{name:s,tables:new Map});const d=t.get(s);d.tables.has(c)||d.tables.set(c,{name:c,columns:[]}),d.tables.get(c).columns.push(a)}),t.forEach(a=>{a.tables.forEach(s=>{s.columns.sort((c,d)=>(c.ordinal_position||0)-(d.ordinal_position||0))})}),Array.from(t.values()).sort((a,s)=>a.name.localeCompare(s.name))},[l]),z=t=>{L(a=>{const s=new Set(a);if(s.has(t)){s.delete(t);const c=f.find(d=>d.name===t);c&&c.tables.forEach(d=>{const x=`${t}.${d.name}`;W(S=>{const N=new Set(S);return N.delete(x),N})})}else s.add(t);return s})},I=(t,a)=>{const s=`${t}.${a}`;W(c=>{const d=new Set(c);return d.has(s)?d.delete(s):d.add(s),d})},A=t=>{E(a=>{const s=new Set(a);return s.has(t)?s.delete(t):s.add(t),s})},b=(t,a)=>{if(t===0)return null;const s=[];for(let c=0;c<t-1;c++)s.push("│  ");return a?s.push("└── "):s.push("├── "),e.jsx(ue,{children:s.join("")})},_=(t,a,s,c)=>{var w;const d=t.id,x=h.has(d),S=(w=f.find(p=>p.name===a))==null?void 0:w.tables.get(s),$=((S==null?void 0:S.columns.findIndex(p=>p.id===d))??-1)===((S==null?void 0:S.columns.length)??0)-1;return e.jsxs(G,{children:[e.jsxs(K,{$level:c,$isExpanded:x,$nodeType:"column",onClick:()=>{A(d),k==null||k(t)},children:[b(c,$),e.jsx(Q,{$isExpanded:x,children:x?r.arrowDown:r.arrowRight}),e.jsx("span",{style:{marginRight:"8px",color:i.muted,fontFamily:"Consolas"},children:r.blockFull}),e.jsx(V,{$isColumn:!0,children:t.column_name}),e.jsxs(X,{children:[t.data_type&&e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:i.backgroundSoft,color:i.foreground,border:`1px solid ${i.border}`,marginRight:4},children:t.data_type}),t.sensitivity_level&&e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:u(void 0,t.sensitivity_level)+"20",color:u(void 0,t.sensitivity_level),border:`1px solid ${u(void 0,t.sensitivity_level)}`,marginRight:4},children:t.sensitivity_level}),t.contains_pii&&e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:u(void 0,void 0,!0)+"20",color:u(void 0,void 0,!0),border:`1px solid ${u(void 0,void 0,!0)}`,marginRight:4},children:"PII"}),t.contains_phi&&e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:u(void 0,void 0,!0)+"20",color:u(void 0,void 0,!0),border:`1px solid ${u(void 0,void 0,!0)}`,marginRight:4},children:"PHI"}),t.is_primary_key&&e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:u("PK")+"20",color:u("PK"),border:`1px solid ${u("PK")}`,marginRight:4},children:"PK"}),t.is_foreign_key&&e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:u("FK")+"20",color:u("FK"),border:`1px solid ${u("FK")}`,marginRight:4},children:"FK"}),t.is_unique&&e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:u("UQ")+"20",color:u("UQ"),border:`1px solid ${u("UQ")}`,marginRight:4},children:"UQ"}),t.is_indexed&&e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:u("IDX")+"20",color:u("IDX"),border:`1px solid ${u("IDX")}`,marginRight:4},children:"IDX"}),t.profiling_quality_score!==void 0&&t.profiling_quality_score!==null&&t.profiling_quality_score>0&&e.jsxs("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:t.profiling_quality_score>=90?i.success+"20":t.profiling_quality_score>=70?i.warning+"20":i.danger+"20",color:t.profiling_quality_score>=90?i.success:t.profiling_quality_score>=70?i.warning:i.danger,border:`1px solid ${t.profiling_quality_score>=90?i.success:t.profiling_quality_score>=70?i.warning:i.danger}`,marginRight:4,fontWeight:600},children:["Q:",Number(t.profiling_quality_score).toFixed(0)]}),t.detected_pattern&&e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:i.accent+"20",color:i.accent,border:`1px solid ${i.accent}`,marginRight:4},children:t.detected_pattern}),t.has_anomalies&&e.jsx("span",{style:{padding:"2px 8px",borderRadius:2,fontSize:11,fontFamily:"Consolas",backgroundColor:i.danger+"20",color:i.danger,border:`1px solid ${i.danger}`,marginRight:4},children:"ANOMALIES"})]})]}),e.jsx(J,{$isExpanded:x,$level:c,children:x&&e.jsxs("div",{style:{padding:"12px",margin:"4px 0 8px 0",fontSize:12,fontFamily:"Consolas",color:i.foreground,background:i.backgroundSoft,borderLeft:`3px solid ${i.accent}`,borderRadius:2},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:12,marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Engine:"}),e.jsx("span",{children:t.db_engine||"N/A"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Position:"}),e.jsx("span",{children:t.ordinal_position||"N/A"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Nullable:"}),e.jsx("span",{children:t.is_nullable?"Yes":"No"})]}),t.character_maximum_length&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Max Length:"}),e.jsx("span",{children:t.character_maximum_length})]}),t.numeric_precision&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Precision:"}),e.jsx("span",{children:t.numeric_precision})]}),t.numeric_scale!==void 0&&t.numeric_scale!==null&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Scale:"}),e.jsx("span",{children:t.numeric_scale})]}),t.column_default&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Default:"}),e.jsx("span",{children:t.column_default})]}),t.is_auto_increment&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Auto Increment:"}),e.jsx("span",{style:{color:i.accent,fontWeight:600},children:"Yes"})]}),t.is_generated&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Generated:"}),e.jsx("span",{style:{color:i.accent,fontWeight:600},children:"Yes"})]}),t.data_category&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Data Category:"}),e.jsx("span",{children:t.data_category})]}),t.null_percentage!==void 0&&t.null_percentage!==null&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Null %:"}),e.jsxs("span",{children:[Number(t.null_percentage).toFixed(2),"%"]})]}),t.distinct_percentage!==void 0&&t.distinct_percentage!==null&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("strong",{style:{color:i.foreground,fontWeight:600,minWidth:100},children:"Distinct %:"}),e.jsxs("span",{children:[Number(t.distinct_percentage).toFixed(2),"%"]})]})]}),(t.contains_pii||t.contains_phi)&&e.jsxs("div",{style:{marginTop:16,padding:"12px",background:i.background,borderRadius:2,border:`1px solid ${i.border}`},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.danger,marginBottom:12,paddingBottom:6,borderBottom:`1px solid ${i.border}`},children:[r.blockFull," PII/PHI DETECTION"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10},children:[t.contains_pii&&e.jsxs(e.Fragment,{children:[t.pii_detection_method&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"PII Method"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:t.pii_detection_method})]}),t.pii_confidence_score!==void 0&&t.pii_confidence_score!==null&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"PII Confidence"}),e.jsxs("div",{style:{fontSize:12,fontWeight:600},children:[Number(t.pii_confidence_score).toFixed(2),"%"]})]}),t.pii_category&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"PII Category"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:t.pii_category})]})]}),t.contains_phi&&e.jsxs(e.Fragment,{children:[t.phi_detection_method&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"PHI Method"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:t.phi_detection_method})]}),t.phi_confidence_score!==void 0&&t.phi_confidence_score!==null&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"PHI Confidence"}),e.jsxs("div",{style:{fontSize:12,fontWeight:600},children:[Number(t.phi_confidence_score).toFixed(2),"%"]})]})]})]})]}),(t.masking_applied||t.encryption_applied||t.tokenization_applied)&&e.jsxs("div",{style:{marginTop:16,padding:"12px",background:i.background,borderRadius:2,border:`1px solid ${i.accent}`},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.accent,marginBottom:12,paddingBottom:6,borderBottom:`1px solid ${i.border}`},children:[r.blockFull," SECURITY & PROTECTION"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:10},children:[t.masking_applied&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"Masking"}),e.jsx("div",{style:{fontSize:12,fontWeight:600,color:i.success},children:"Applied"})]}),t.encryption_applied&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"Encryption"}),e.jsx("div",{style:{fontSize:12,fontWeight:600,color:i.success},children:"Applied"})]}),t.tokenization_applied&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"Tokenization"}),e.jsx("div",{style:{fontSize:12,fontWeight:600,color:i.success},children:"Applied"})]}),t.last_pii_scan&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"Last PII Scan"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:new Date(t.last_pii_scan).toLocaleString()})]})]})]}),t.column_metadata&&e.jsxs("div",{style:{marginTop:16,padding:"12px",background:i.background,borderRadius:2,border:`1px solid ${i.border}`},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.accent,marginBottom:12,paddingBottom:6,borderBottom:`1px solid ${i.border}`},children:[r.blockSemi," COLUMN METADATA (JSONB)"]}),e.jsx("pre",{style:{margin:0,padding:12,backgroundColor:i.backgroundSoft,borderRadius:2,overflowX:"auto",fontSize:11,fontFamily:"Consolas",color:i.foreground,maxHeight:"300px",overflowY:"auto"},children:JSON.stringify(t.column_metadata,null,2)})]}),(t.median_value!==void 0||t.std_deviation!==void 0||t.percentile_25!==void 0||t.mode_value)&&e.jsxs("div",{style:{marginTop:16,padding:"12px",background:i.background,borderRadius:2,border:`1px solid ${i.border}`},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.accent,marginBottom:12,paddingBottom:6,borderBottom:`1px solid ${i.border}`},children:[r.blockFull," STATISTICAL ANALYSIS"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:10},children:[t.min_value&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"Min"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:t.min_value})]}),t.max_value&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"Max"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:t.max_value})]}),t.avg_value!==void 0&&t.avg_value!==null&&t.avg_value!==0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"Average"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:Number(t.avg_value).toFixed(2)})]}),t.median_value!==void 0&&t.median_value!==null&&t.median_value!==0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"Median"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:Number(t.median_value).toFixed(2)})]}),t.std_deviation!==void 0&&t.std_deviation!==null&&t.std_deviation!==0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"Std Dev"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:Number(t.std_deviation).toFixed(2)})]}),t.mode_value&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"Mode"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:t.mode_value}),t.mode_frequency!==void 0&&t.mode_frequency!==null&&e.jsxs("div",{style:{fontSize:10,color:i.muted,marginTop:2},children:["(",Number(t.mode_frequency).toFixed(2),"%)"]})]}),t.percentile_25!==void 0&&t.percentile_25!==null&&t.percentile_25!==0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"P25"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:Number(t.percentile_25).toFixed(2)})]}),t.percentile_75!==void 0&&t.percentile_75!==null&&t.percentile_75!==0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"P75"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:Number(t.percentile_75).toFixed(2)})]}),t.percentile_90!==void 0&&t.percentile_90!==null&&t.percentile_90!==0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"P90"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:Number(t.percentile_90).toFixed(2)})]}),t.percentile_95!==void 0&&t.percentile_95!==null&&t.percentile_95!==0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"P95"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:Number(t.percentile_95).toFixed(2)})]}),t.percentile_99!==void 0&&t.percentile_99!==null&&t.percentile_99!==0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:i.muted,marginBottom:2},children:"P99"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:Number(t.percentile_99).toFixed(2)})]})]})]}),t.detected_pattern&&e.jsxs("div",{style:{marginTop:16,padding:"12px",background:i.background,borderRadius:2,border:`1px solid ${i.border}`},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.accent,marginBottom:12,paddingBottom:6,borderBottom:`1px solid ${i.border}`},children:[r.blockSemi," DETECTED PATTERN"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("strong",{children:"Type:"})," ",t.detected_pattern,t.pattern_confidence!==void 0&&t.pattern_confidence!==null&&e.jsxs("span",{style:{marginLeft:8,color:i.muted},children:["(",Number(t.pattern_confidence).toFixed(1),"% confidence)"]})]}),t.pattern_examples&&Array.isArray(t.pattern_examples)&&t.pattern_examples.length>0&&e.jsxs("div",{children:[e.jsx("strong",{style:{display:"block",marginBottom:4},children:"Examples:"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:t.pattern_examples.slice(0,5).map((p,y)=>e.jsx("span",{style:{padding:"2px 6px",background:i.backgroundSoft,borderRadius:2,fontSize:11,fontFamily:"Consolas"},children:p},y))})]})]}),t.top_values&&Array.isArray(t.top_values)&&t.top_values.length>0&&e.jsxs("div",{style:{marginTop:16,padding:"12px",background:i.background,borderRadius:2,border:`1px solid ${i.border}`},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.accent,marginBottom:12,paddingBottom:6,borderBottom:`1px solid ${i.border}`},children:[r.blockLight," TOP VALUES"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:t.top_values.slice(0,10).map((p,y)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:y<3?i.accentLight:i.backgroundSoft,borderRadius:2},children:[e.jsx("span",{style:{fontFamily:"Consolas",fontSize:11},children:p.value!==void 0?String(p.value):"N/A"}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:10,color:i.muted},children:[p.count||0," times"]}),p.percentage!==void 0&&p.percentage!==null&&e.jsxs("span",{style:{fontSize:10,fontWeight:600,color:i.accent},children:[Number(p.percentage).toFixed(2),"%"]})]})]},y))})]}),t.value_distribution&&Array.isArray(t.value_distribution)&&t.value_distribution.length>0&&e.jsxs("div",{style:{marginTop:16,padding:"12px",background:i.background,borderRadius:2,border:`1px solid ${i.border}`},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.accent,marginBottom:12,paddingBottom:6,borderBottom:`1px solid ${i.border}`},children:[r.blockSemi," VALUE DISTRIBUTION (HISTOGRAM)"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:8},children:t.value_distribution.map((p,y)=>{const D=Math.max(...t.value_distribution.map(R=>R.count||0)),U=D>0?(p.count||0)/D*100:0;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"2px 0"},children:[e.jsxs("div",{style:{minWidth:80,fontSize:10,color:i.muted,fontFamily:"Consolas"},children:["[",Number(p.min||0).toFixed(2)," - ",Number(p.max||0).toFixed(2),"]"]}),e.jsx("div",{style:{flex:1,height:16,background:i.backgroundSoft,borderRadius:2,position:"relative",overflow:"hidden"},children:e.jsx("div",{style:{width:`${U}%`,height:"100%",background:y%2===0?i.accent:i.accentLight,borderRadius:2,transition:"width 0.3s ease",display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:4},children:U>15&&e.jsx("span",{style:{fontSize:9,color:i.foreground,fontWeight:600},children:p.count||0})})}),e.jsx("div",{style:{minWidth:50,fontSize:10,color:i.muted,textAlign:"right",fontFamily:"Consolas"},children:p.count||0}),e.jsx("div",{style:{minWidth:50,fontSize:10,fontWeight:600,color:i.accent,textAlign:"right",fontFamily:"Consolas"},children:p.percentage!==void 0&&p.percentage!==null?Number(p.percentage).toFixed(1)+"%":"0%"})]},y)})}),e.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:`1px solid ${i.border}`,fontSize:10,color:i.muted,fontFamily:"Consolas"},children:["Total bins: ",t.value_distribution.length," | Max count: ",Math.max(...t.value_distribution.map(p=>p.count||0))]})]}),(t.has_anomalies||t.outlier_count!==void 0&&t.outlier_count>0)&&e.jsxs("div",{style:{marginTop:16,padding:"12px",background:i.danger+"10",borderRadius:2,border:`1px solid ${i.danger}`},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.danger,marginBottom:12,paddingBottom:6,borderBottom:`1px solid ${i.danger}`},children:[r.blockFull," ANOMALIES & OUTLIERS"]}),t.outlier_count!==void 0&&t.outlier_count!==null&&t.outlier_count>0&&e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("strong",{children:"Outliers detected:"})," ",t.outlier_count,t.outlier_percentage!==void 0&&t.outlier_percentage!==null&&e.jsxs("span",{style:{marginLeft:8,color:i.muted},children:["(",Number(t.outlier_percentage).toFixed(2),"%)"]})]}),t.anomalies&&Array.isArray(t.anomalies)&&t.anomalies.length>0&&e.jsxs("div",{children:[e.jsx("strong",{style:{display:"block",marginBottom:4},children:"Anomaly Examples:"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:t.anomalies.slice(0,5).map((p,y)=>e.jsxs("div",{style:{padding:"4px 8px",background:i.background,borderRadius:2,fontSize:11,fontFamily:"Consolas"},children:[e.jsx("span",{style:{color:i.danger,fontWeight:600},children:p.value!==void 0?String(p.value):"N/A"}),p.reason&&e.jsxs("span",{style:{marginLeft:8,color:i.muted,fontSize:10},children:["(",p.reason,")"]})]},y))})]})]}),t.profiling_quality_score!==void 0&&t.profiling_quality_score!==null&&t.profiling_quality_score>0&&e.jsxs("div",{style:{marginTop:16,padding:"12px",background:t.profiling_quality_score>=90?i.success+"10":t.profiling_quality_score>=70?i.warning+"10":i.danger+"10",borderRadius:2,border:`1px solid ${t.profiling_quality_score>=90?i.success:t.profiling_quality_score>=70?i.warning:i.danger}`},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:t.profiling_quality_score>=90?i.success:t.profiling_quality_score>=70?i.warning:i.danger,marginBottom:8},children:[r.blockFull," PROFILING QUALITY SCORE"]}),e.jsxs("div",{style:{fontSize:24,fontWeight:700,color:t.profiling_quality_score>=90?i.success:t.profiling_quality_score>=70?i.warning:i.danger,fontFamily:"Consolas"},children:[Number(t.profiling_quality_score).toFixed(1),"/100"]}),e.jsx("div",{style:{width:"100%",height:8,background:i.backgroundSoft,borderRadius:4,marginTop:8,overflow:"hidden"},children:e.jsx("div",{style:{width:`${t.profiling_quality_score}%`,height:"100%",background:t.profiling_quality_score>=90?i.success:t.profiling_quality_score>=70?i.warning:i.danger,transition:"width 0.3s ease"}})})]}),e.jsxs("div",{style:{marginTop:16,padding:"12px",background:i.backgroundSoft,borderRadius:2,border:`1px solid ${i.border}`},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.muted,marginBottom:12,paddingBottom:6,borderBottom:`1px solid ${i.border}`},children:[r.blockSemi," TIMESTAMPS & METADATA"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10,fontSize:11,fontFamily:"Consolas"},children:[t.first_seen_at&&e.jsxs("div",{children:[e.jsx("div",{style:{color:i.muted,marginBottom:2},children:"First Seen"}),e.jsx("div",{style:{color:i.foreground,fontWeight:600},children:new Date(t.first_seen_at).toLocaleString()})]}),t.last_seen_at&&e.jsxs("div",{children:[e.jsx("div",{style:{color:i.muted,marginBottom:2},children:"Last Seen"}),e.jsx("div",{style:{color:i.foreground,fontWeight:600},children:new Date(t.last_seen_at).toLocaleString()})]}),t.last_analyzed_at&&e.jsxs("div",{children:[e.jsx("div",{style:{color:i.muted,marginBottom:2},children:"Last Analyzed"}),e.jsx("div",{style:{color:i.foreground,fontWeight:600},children:new Date(t.last_analyzed_at).toLocaleString()})]}),t.last_profiled_at&&e.jsxs("div",{children:[e.jsx("div",{style:{color:i.muted,marginBottom:2},children:"Last Profiled"}),e.jsx("div",{style:{color:i.foreground,fontWeight:600},children:new Date(t.last_profiled_at).toLocaleString()})]}),t.created_at&&e.jsxs("div",{children:[e.jsx("div",{style:{color:i.muted,marginBottom:2},children:"Created At"}),e.jsx("div",{style:{color:i.foreground,fontWeight:600},children:new Date(t.created_at).toLocaleString()})]}),t.updated_at&&e.jsxs("div",{children:[e.jsx("div",{style:{color:i.muted,marginBottom:2},children:"Updated At"}),e.jsx("div",{style:{color:i.foreground,fontWeight:600},children:new Date(t.updated_at).toLocaleString()})]})]})]})]})})]},d)},T=(t,a,s)=>{const c=`${a}.${t.name}`,d=n.has(c),x=f.find($=>$.name===a),N=(x?Array.from(x.tables.keys()).indexOf(t.name):-1)===((x==null?void 0:x.tables.size)??0)-1;return e.jsxs(G,{children:[e.jsxs(K,{$level:s,$isExpanded:d,$nodeType:"table",onClick:()=>I(a,t.name),children:[b(s,N),e.jsx(Q,{$isExpanded:d,children:d?r.arrowDown:r.arrowRight}),e.jsx("span",{style:{marginRight:"8px",color:i.foreground,fontFamily:"Consolas"},children:r.blockFull}),e.jsx(V,{$isTable:!0,children:t.name}),e.jsx(X,{children:e.jsxs(ne,{children:[t.columns.length," ",t.columns.length===1?"column":"columns"]})})]}),e.jsx(J,{$isExpanded:d,$level:s,children:d&&t.columns.map($=>_($,a,t.name,s+1))})]},c)},v=(t,a)=>{const s=B.has(t.name),d=f.findIndex(x=>x.name===t.name)===f.length-1;return e.jsxs(G,{children:[e.jsxs(K,{$level:a,$isExpanded:s,$nodeType:"schema",onClick:()=>z(t.name),children:[b(a,d),e.jsx(Q,{$isExpanded:s,children:s?r.arrowDown:r.arrowRight}),e.jsx("span",{style:{marginRight:"8px",color:i.accent,fontFamily:"Consolas"},children:r.blockFull}),e.jsx(V,{$isSchema:!0,children:t.name}),e.jsx(X,{children:e.jsxs(ne,{children:[t.tables.size," ",t.tables.size===1?"table":"tables"]})})]}),e.jsx(J,{$isExpanded:s,$level:a,children:s&&Array.from(t.tables.values()).map(x=>T(x,t.name,a+1))})]},t.name)};return f.length===0?e.jsx(te,{children:e.jsxs(fe,{children:[e.jsx("div",{style:{fontSize:48,marginBottom:16,fontFamily:"Consolas",opacity:.5},children:r.blockFull}),e.jsx("div",{style:{fontSize:13,fontFamily:"Consolas",fontWeight:600,marginBottom:8,color:i.foreground},children:"No column data available"}),e.jsx("div",{style:{fontSize:12,fontFamily:"Consolas",opacity:.7,color:i.muted},children:"Columns will appear here once cataloged."})]})}):e.jsx(te,{children:f.map((t,a)=>e.jsx("div",{style:{animationDelay:`${a*.05}s`},children:v(t,0)},t.name))})},ve=()=>{const[l,k]=g.useState(!1),[B,L]=g.useState(null),[n,W]=g.useState({}),[h,E]=g.useState(null),f=g.useRef(null),z=g.useCallback(async()=>{var _,T;f.current&&f.current.abort(),f.current=new AbortController;const b=f.current;k(!0),L(null);try{const[v,t]=await Promise.all([O.getMetrics(),O.getStats()]);!b.signal.aborted&&f.current===b&&(W(v||{}),E(t||{}))}catch(v){if(!(v.name==="CanceledError"||v.name==="AbortError"||((_=v.message)==null?void 0:_.includes("canceled"))||((T=v.message)==null?void 0:T.includes("aborted")))&&f.current===b){const a=oe(v);L(a),console.error("Error fetching column catalog charts data:",v)}}finally{f.current===b&&k(!1)}},[]);g.useEffect(()=>{z();const b=setInterval(z,6e4);return()=>{f.current&&f.current.abort(),clearInterval(b)}},[z]);const I=(b,_,T,v=i.accent)=>{const t=_==null?"N/A":Number(_).toLocaleString();return e.jsxs("div",{style:{padding:"16px",backgroundColor:i.background,border:`1px solid ${i.border}`,borderRadius:4,minWidth:"150px"},children:[e.jsx("div",{style:{fontSize:11,color:i.muted,marginBottom:8,textTransform:"uppercase",letterSpacing:.5},children:b}),e.jsx("div",{style:{fontSize:24,fontWeight:700,color:v,fontFamily:"Consolas",marginBottom:T?4:0},children:t}),T&&e.jsx("div",{style:{fontSize:10,color:i.muted},children:T})]})},A=(b,_,T,v,t=[])=>{if(!_||_.length===0)return e.jsx(C,{children:e.jsx("div",{style:{padding:"20px",textAlign:"center",color:i.muted},children:"No data available"})});const a=_.reduce((c,d)=>c+(Number(d[v])||0),0),s=[i.accent,i.success,i.warning,i.error,i.info,"#9b59b6","#e74c3c","#3498db","#f39c12","#1abc9c","#34495e","#e67e22","#16a085","#c0392b","#8e44ad"];return e.jsxs(C,{children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsxs("div",{style:{fontSize:12,fontWeight:700,color:i.foreground,marginBottom:8,fontFamily:"Consolas"},children:[r.tl,r.h.repeat(2)," ",b]})}),e.jsxs("div",{style:{padding:"0 16px 16px"},children:[_.map((c,d)=>{const x=Number(c[v])||0,S=a>0?(x/a*100).toFixed(1):"0.0",N=a>0?x/a*100:0,$=t[d]||s[d%s.length];return e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{fontSize:10,color:i.foreground,marginBottom:4,fontFamily:"Consolas",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{children:[r.v," ",c[T]||"Unknown"]}),e.jsxs("span",{style:{color:i.muted},children:[x.toLocaleString()," (",S,"%)"]})]}),e.jsx("div",{style:{width:"100%",height:10,backgroundColor:i.border,borderRadius:2,overflow:"hidden"},children:e.jsx("div",{style:{width:`${N}%`,height:"100%",backgroundColor:$,transition:"width 0.3s ease"}})})]},d)}),e.jsxs("div",{style:{marginTop:16,paddingTop:12,borderTop:`1px solid ${i.border}`,fontSize:10,color:i.muted,fontFamily:"Consolas"},children:[r.bl,r.h.repeat(30),e.jsx("br",{}),"Total: ",a.toLocaleString()," columns"]})]})]})};return l&&!n.total_columns?e.jsx(C,{children:e.jsx("div",{style:{padding:"40px",textAlign:"center",color:i.muted},children:"Loading charts..."})}):B?e.jsx(C,{children:e.jsxs("div",{style:{padding:"20px",color:i.error},children:["Error: ",B]})}):e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:700,color:i.foreground,marginBottom:16,fontFamily:"Consolas"},children:[r.tl,r.h.repeat(2)," COLUMN CATALOG METRICS"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"16px",marginBottom:"24px"},children:[I("Total Columns",n.total_columns),I("PII Columns",n.pii_columns,`${((Number(n.pii_columns)||0)/(Number(n.total_columns)||1)*100).toFixed(1)}% of total`,i.warning),I("PHI Columns",n.phi_columns,`${((Number(n.phi_columns)||0)/(Number(n.total_columns)||1)*100).toFixed(1)}% of total`,i.error),I("High Sensitivity",n.high_sensitivity,`${((Number(n.high_sensitivity)||0)/(Number(n.total_columns)||1)*100).toFixed(1)}% of total`,i.error),I("Primary Keys",n.primary_keys),I("Indexed Columns",n.indexed_columns),I("Profiled Columns",n.profiled_columns,`${((Number(n.profiled_columns)||0)/(Number(n.total_columns)||1)*100).toFixed(1)}% of total`),I("Avg Profiling Score",n.avg_profiling_score?Number(n.avg_profiling_score).toFixed(1):"N/A","Quality score"),I("With Anomalies",n.columns_with_anomalies,`${((Number(n.columns_with_anomalies)||0)/(Number(n.total_columns)||1)*100).toFixed(1)}% of total`,i.warning)]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",marginBottom:"24px",alignItems:"start"},children:[e.jsx("div",{style:{display:"flex",flexDirection:"column"},children:(h==null?void 0:h.data_type_distribution)&&A("DATA TYPE DISTRIBUTION",h.data_type_distribution,"data_type","count",[i.accent,i.success,i.warning,i.error,i.info,"#9b59b6","#e74c3c","#3498db","#f39c12","#1abc9c","#34495e","#e67e22","#16a085","#c0392b","#8e44ad"])}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[(h==null?void 0:h.sensitivity_distribution)&&A("SENSITIVITY LEVEL DISTRIBUTION",h.sensitivity_distribution,"sensitivity_level","count",[i.success,i.warning,i.error,i.muted]),(h==null?void 0:h.engine_distribution)&&A("ENGINE DISTRIBUTION",h.engine_distribution,"db_engine","count"),(h==null?void 0:h.pii_distribution)&&A("SENSITIVE DATA DISTRIBUTION",h.pii_distribution,"category","count",[i.error,i.warning,i.info,i.success])]})]}),(h==null?void 0:h.profiling_distribution)&&e.jsx("div",{style:{marginBottom:"24px"},children:A("PROFILING QUALITY DISTRIBUTION",h.profiling_distribution,"quality_range","count",[i.success,i.info,i.warning,i.error,i.muted])}),e.jsx(C,{children:e.jsxs("div",{style:{padding:"16px"},children:[e.jsxs("div",{style:{fontSize:12,fontWeight:700,color:i.foreground,marginBottom:12,fontFamily:"Consolas"},children:[r.tl,r.h.repeat(2)," COLUMN CATALOG SUMMARY"]}),e.jsxs("div",{style:{fontSize:11,color:i.foreground,lineHeight:1.8,fontFamily:"Consolas"},children:[e.jsxs("div",{children:[r.v," Total Columns: ",e.jsx("span",{style:{color:i.accent,fontWeight:600},children:Number(n.total_columns||0).toLocaleString()})]}),e.jsxs("div",{children:[r.v," PII Columns: ",e.jsx("span",{style:{color:i.warning,fontWeight:600},children:Number(n.pii_columns||0).toLocaleString()})," (",((Number(n.pii_columns)||0)/(Number(n.total_columns)||1)*100).toFixed(1),"%)"]}),e.jsxs("div",{children:[r.v," PHI Columns: ",e.jsx("span",{style:{color:i.error,fontWeight:600},children:Number(n.phi_columns||0).toLocaleString()})," (",((Number(n.phi_columns)||0)/(Number(n.total_columns)||1)*100).toFixed(1),"%)"]}),e.jsxs("div",{children:[r.v," High Sensitivity: ",e.jsx("span",{style:{color:i.error,fontWeight:600},children:Number(n.high_sensitivity||0).toLocaleString()})," (",((Number(n.high_sensitivity)||0)/(Number(n.total_columns)||1)*100).toFixed(1),"%)"]}),e.jsxs("div",{children:[r.v," Profiled Columns: ",e.jsx("span",{style:{color:i.accent,fontWeight:600},children:Number(n.profiled_columns||0).toLocaleString()})," (",((Number(n.profiled_columns)||0)/(Number(n.total_columns)||1)*100).toFixed(1),"%)"]}),n.avg_profiling_score&&e.jsxs("div",{children:[r.v," Avg Profiling Score: ",e.jsx("span",{style:{color:i.accent,fontWeight:600},children:Number(n.avg_profiling_score).toFixed(1)})]}),e.jsxs("div",{children:[r.v," Columns with Anomalies: ",e.jsx("span",{style:{color:i.warning,fontWeight:600},children:Number(n.columns_with_anomalies||0).toLocaleString()})," (",((Number(n.columns_with_anomalies)||0)/(Number(n.total_columns)||1)*100).toFixed(1),"%)"]}),e.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:`1px solid ${i.border}`},children:[r.bl,r.h.repeat(40)]})]})]})})]})},ze=()=>{const{page:l,limit:k,setPage:B,setLimit:L}=pe(1,20,1e3),{filters:n,setFilter:W,clearFilters:h}=ge({schema_name:"",table_name:"",db_engine:"",data_type:"",sensitivity_level:"",contains_pii:"",contains_phi:"",search:""}),[E,f]=g.useState(null),[z,I]=g.useState({}),[A,b]=g.useState(null),[_,T]=g.useState([]),[v,t]=g.useState([]),[a,s]=g.useState([]),[c,d]=g.useState({total:0,totalPages:0,currentPage:1,limit:20}),[x,S]=g.useState(!1),[N,$]=g.useState(!1),[w,p]=g.useState("list"),y=g.useRef(!0),D=g.useCallback(async()=>{if(y.current)try{S(!0),f(null);const o=he(n.search,100),[m,H,Y]=await Promise.all([O.getColumns({page:l,limit:k,schema_name:n.schema_name,table_name:n.table_name,db_engine:n.db_engine,data_type:n.data_type,sensitivity_level:n.sensitivity_level,contains_pii:n.contains_pii,contains_phi:n.contains_phi,search:o}),O.getMetrics(),O.getSchemas()]);y.current&&(s(m.data||[]),d(m.pagination||{total:0,totalPages:0,currentPage:1,limit:20}),I(H||{}),T(Y||[]))}catch(o){y.current&&f(oe(o))}finally{y.current&&S(!1)}},[l,k,n.schema_name,n.table_name,n.db_engine,n.data_type,n.sensitivity_level,n.contains_pii,n.contains_phi,n.search]);g.useEffect(()=>{y.current=!0,D();const o=setInterval(()=>{y.current&&D()},3e4);return()=>{y.current=!1,clearInterval(o)}},[D]),g.useEffect(()=>{(async()=>{if(n.schema_name&&y.current)try{const m=await O.getTables(n.schema_name);y.current&&t(m||[])}catch(m){y.current&&console.error("Error loading tables:",m)}else t([])})()},[n.schema_name]);const U=g.useCallback(o=>{b(m=>m===o?null:o)},[]),R=g.useCallback(o=>{if(o==null)return"N/A";const m=Number(o);return isNaN(m)?"N/A":m>=1e6?`${(m/1e6).toFixed(2)}M`:m>=1e3?`${(m/1e3).toFixed(2)}K`:m.toString()},[]);g.useCallback(o=>{if(o==null)return"N/A";const m=Number(o);return isNaN(m)?"N/A":`${m.toFixed(2)}%`},[]),g.useCallback(o=>o?new Date(o).toLocaleString():"N/A",[]);const P=g.useCallback((o,m)=>{W(o,m),o==="schema_name"&&W("table_name","")},[W]),se=g.useCallback(()=>{h()},[h]),le=g.useCallback(()=>{const o=["Schema","Table","Column","Engine","Data Type","Position","Nullable","Sensitivity","PII","PHI","Primary Key","Foreign Key","Unique","Indexed"],m=a.map(j=>[j.schema_name,j.table_name,j.column_name,j.db_engine||"",j.data_type||"",j.ordinal_position||"",j.is_nullable?"Yes":"No",j.sensitivity_level||"",j.contains_pii?"Yes":"No",j.contains_phi?"Yes":"No",j.is_primary_key?"Yes":"No",j.is_foreign_key?"Yes":"No",j.is_unique?"Yes":"No",j.is_indexed?"Yes":"No"]),H=[o.join(","),...m.map(j=>j.map(de=>`"${String(de).replace(/"/g,'""')}"`).join(","))].join(`
`),Y=new Blob([H],{type:"text/csv;charset=utf-8;"}),M=document.createElement("a"),ae=URL.createObjectURL(Y);M.setAttribute("href",ae),M.setAttribute("download",`column_catalog_export_${new Date().toISOString().split("T")[0]}.csv`),M.style.visibility="hidden",document.body.appendChild(M),M.click(),document.body.removeChild(M)},[a]);return x&&a.length===0?e.jsxs("div",{style:{padding:"20px",fontFamily:"Consolas",fontSize:12},children:[e.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:"0 0 20px 0",color:i.foreground,textTransform:"uppercase",fontFamily:"Consolas"},children:[e.jsx("span",{style:{color:i.accent,marginRight:8},children:r.blockFull}),"COLUMN CATALOG"]}),e.jsx(ee,{children:"Loading column catalog data..."})]}):e.jsxs("div",{style:{padding:"20px",fontFamily:"Consolas",fontSize:12},children:[e.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:"0 0 20px 0",color:i.foreground,textTransform:"uppercase",fontFamily:"Consolas"},children:[e.jsx("span",{style:{color:i.accent,marginRight:8},children:r.blockFull}),"COLUMN CATALOG"]}),E&&e.jsx("div",{style:{marginBottom:20},children:e.jsx(C,{title:"ERROR",children:e.jsx("div",{style:{padding:"12px",color:i.danger,fontSize:12,fontFamily:"Consolas"},children:E})})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:12,marginBottom:24},children:[e.jsx(C,{title:"Total Columns",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:i.foreground},children:R(z.total_columns)})}),e.jsx(C,{title:"PII Columns",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:i.foreground},children:R(z.pii_columns)})}),e.jsx(C,{title:"PHI Columns",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:i.foreground},children:R(z.phi_columns)})}),e.jsx(C,{title:"High Sensitivity",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:i.foreground},children:R(z.high_sensitivity)})}),e.jsx(C,{title:"Primary Keys",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:i.foreground},children:R(z.primary_keys)})}),e.jsx(C,{title:"Indexed Columns",children:e.jsx("div",{style:{fontFamily:"Consolas",fontSize:14,fontWeight:600,color:i.foreground},children:R(z.indexed_columns)})})]}),N&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>$(!1),children:e.jsx("div",{style:{width:"90%",maxWidth:900,maxHeight:"90vh",overflowY:"auto"},onClick:o=>o.stopPropagation(),children:e.jsx(C,{title:"METRICS PLAYBOOK",children:e.jsxs("div",{style:{padding:16,fontFamily:"Consolas",fontSize:12,lineHeight:1.6},children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.accent,marginBottom:8},children:[r.blockFull," Total Columns"]}),e.jsx("div",{style:{color:i.foreground,marginLeft:16},children:"Total number of columns cataloged across all schemas, tables, and database engines in the system."})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.danger,marginBottom:8},children:[r.blockFull," PII Columns"]}),e.jsx("div",{style:{color:i.foreground,marginLeft:16},children:"Columns containing Personally Identifiable Information (PII) such as names, emails, phone numbers, SSNs, etc. Detected through pattern matching and confidence scoring."})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.danger,marginBottom:8},children:[r.blockFull," PHI Columns"]}),e.jsx("div",{style:{color:i.foreground,marginLeft:16},children:"Columns containing Protected Health Information (PHI) such as medical records, patient IDs, diagnoses, etc. Subject to HIPAA regulations and requires special handling."})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.warning,marginBottom:8},children:[r.blockFull," High Sensitivity"]}),e.jsx("div",{style:{color:i.foreground,marginLeft:16},children:"Columns marked with HIGH sensitivity level, indicating they contain sensitive data requiring enhanced security measures, access controls, and compliance monitoring."})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.accent,marginBottom:8},children:[r.blockFull," Primary Keys"]}),e.jsx("div",{style:{color:i.foreground,marginLeft:16},children:"Columns defined as primary keys in their respective tables. Primary keys uniquely identify each row and are essential for data integrity and relationship mapping."})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.accent,marginBottom:8},children:[r.blockFull," Indexed Columns"]}),e.jsx("div",{style:{color:i.foreground,marginLeft:16},children:"Columns that have database indexes created on them. Indexed columns improve query performance but may require additional storage and maintenance overhead."})]}),e.jsxs("div",{style:{marginTop:24,padding:16,background:i.background,borderRadius:2,border:`1px solid ${i.accent}`},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:i.accent,marginBottom:12,paddingBottom:6,borderBottom:`1px solid ${i.border}`},children:[r.blockFull," PROFILING QUALITY SCORE"]}),e.jsxs("div",{style:{fontSize:11,color:i.foreground,lineHeight:1.6},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("strong",{children:"What is it?"}),e.jsx("br",{}),"The Profiling Quality Score (0-100) measures how comprehensively a column has been analyzed and profiled. Higher scores indicate more complete data profiling with richer statistical insights."]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("strong",{children:"How is it calculated?"}),e.jsx("br",{}),"The score is computed based on multiple factors:"]}),e.jsxs("div",{style:{marginLeft:16,marginBottom:8},children:[e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Basic Statistics (20 points):"})," Min, Max, Average, Null count, Distinct count"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Advanced Statistics (25 points):"})," Median, Std Deviation, Mode, Percentiles (P25, P75, P90, P95, P99)"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Distribution Analysis (20 points):"})," Value distribution histogram, Top values frequency"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Pattern Detection (15 points):"})," Detected data patterns (EMAIL, PHONE, DATE, UUID, etc.)"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Anomaly Detection (10 points):"})," Outlier detection and anomaly identification"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Data Quality (10 points):"})," Completeness, consistency, and data quality metrics"]})]}),e.jsx("div",{style:{marginBottom:8},children:e.jsx("strong",{children:"Score Interpretation:"})}),e.jsxs("div",{style:{marginLeft:16,marginBottom:8},children:[e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{style:{color:i.success},children:"90-100:"})," Excellent - Comprehensive profiling with all metrics available"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{style:{color:i.warning},children:"70-89:"})," Good - Most profiling metrics available, minor gaps"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{style:{color:i.danger},children:"0-69:"})," Needs Improvement - Limited profiling, basic statistics only"]})]}),e.jsx("div",{style:{marginTop:16,marginBottom:8},children:e.jsx("strong",{children:"Benefits of High Scores:"})}),e.jsxs("div",{style:{marginLeft:16,marginBottom:8},children:[e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Better Data Understanding:"})," Complete statistical insights help identify data quality issues, outliers, and patterns early"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Improved Decision Making:"})," Rich metadata enables better schema design, query optimization, and data modeling decisions"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Enhanced Data Governance:"})," Comprehensive profiling supports compliance, data lineage tracking, and regulatory reporting"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Optimized Performance:"})," Distribution analysis and pattern detection help optimize indexes, partitions, and query strategies"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Risk Mitigation:"})," Anomaly detection and quality metrics enable proactive identification of data issues before they impact operations"]}),e.jsxs("div",{style:{marginBottom:4},children:["• ",e.jsx("strong",{children:"Cost Efficiency:"})," Better data understanding reduces storage costs, improves query performance, and minimizes data processing errors"]})]}),e.jsxs("div",{style:{marginTop:12,padding:8,background:i.backgroundSoft,borderRadius:2,fontSize:10,color:i.muted},children:[r.blockSemi," Tip: Re-run profiling analysis to improve scores for columns with low quality scores."]})]})]}),e.jsxs("div",{style:{marginTop:16,padding:12,background:i.backgroundSoft,borderRadius:2,border:`1px solid ${i.border}`},children:[e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:i.muted,marginBottom:4},children:[r.blockSemi," Note"]}),e.jsx("div",{style:{fontSize:11,color:i.foreground},children:"These metrics are calculated in real-time from the column_catalog table and reflect the current state of your data catalog."})]}),e.jsx("div",{style:{marginTop:16,textAlign:"right"},children:e.jsx(q,{label:"Close",onClick:()=>$(!1),variant:"ghost"})})]})})})}),e.jsx(C,{title:"FILTERS",children:e.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("select",{value:n.schema_name,onChange:o=>P("schema_name",o.target.value),style:{padding:"4px 8px",border:`1px solid ${i.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:i.background,color:i.foreground},children:[e.jsx("option",{value:"",children:"All Schemas"}),_.map(o=>e.jsx("option",{value:o,children:o},o))]}),e.jsxs("select",{value:n.table_name,onChange:o=>P("table_name",o.target.value),disabled:!n.schema_name,style:{padding:"4px 8px",border:`1px solid ${i.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:i.background,color:i.foreground,opacity:n.schema_name?1:.5},children:[e.jsx("option",{value:"",children:"All Tables"}),v.map(o=>e.jsx("option",{value:o,children:o},o))]}),e.jsxs("select",{value:n.db_engine,onChange:o=>P("db_engine",o.target.value),style:{padding:"4px 8px",border:`1px solid ${i.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:i.background,color:i.foreground},children:[e.jsx("option",{value:"",children:"All Engines"}),e.jsx("option",{value:"PostgreSQL",children:"PostgreSQL"}),e.jsx("option",{value:"MariaDB",children:"MariaDB"}),e.jsx("option",{value:"MSSQL",children:"MSSQL"}),e.jsx("option",{value:"MongoDB",children:"MongoDB"}),e.jsx("option",{value:"Oracle",children:"Oracle"}),e.jsx("option",{value:"DB2",children:"DB2"})]}),e.jsxs("select",{value:n.data_type,onChange:o=>P("data_type",o.target.value),style:{padding:"4px 8px",border:`1px solid ${i.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:i.background,color:i.foreground},children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"varchar",children:"VARCHAR"}),e.jsx("option",{value:"integer",children:"INTEGER"}),e.jsx("option",{value:"bigint",children:"BIGINT"}),e.jsx("option",{value:"numeric",children:"NUMERIC"}),e.jsx("option",{value:"timestamp",children:"TIMESTAMP"}),e.jsx("option",{value:"boolean",children:"BOOLEAN"})]}),e.jsxs("select",{value:n.sensitivity_level,onChange:o=>P("sensitivity_level",o.target.value),style:{padding:"4px 8px",border:`1px solid ${i.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:i.background,color:i.foreground},children:[e.jsx("option",{value:"",children:"All Sensitivity"}),e.jsx("option",{value:"HIGH",children:"HIGH"}),e.jsx("option",{value:"MEDIUM",children:"MEDIUM"}),e.jsx("option",{value:"LOW",children:"LOW"})]}),e.jsxs("select",{value:n.contains_pii,onChange:o=>P("contains_pii",o.target.value),style:{padding:"4px 8px",border:`1px solid ${i.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:i.background,color:i.foreground},children:[e.jsx("option",{value:"",children:"All PII"}),e.jsx("option",{value:"true",children:"Has PII"}),e.jsx("option",{value:"false",children:"No PII"})]}),e.jsx("input",{type:"text",placeholder:"Search column name...",value:n.search,onChange:o=>P("search",o.target.value),style:{flex:1,minWidth:"200px",padding:"4px 8px",border:`1px solid ${i.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:i.background,color:i.foreground}}),e.jsx(q,{label:"Reset All",onClick:se,variant:"ghost"})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24,marginTop:8,fontFamily:"Consolas",fontSize:12,gap:32},children:[e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[e.jsx("label",{style:{color:i.muted,fontSize:11,fontFamily:"Consolas"},children:"Items per page:"}),e.jsxs("select",{value:k,onChange:o=>{L(Number(o.target.value)),B(1)},style:{padding:"4px 8px",border:`1px solid ${i.border}`,borderRadius:2,fontFamily:"Consolas",fontSize:12,backgroundColor:i.background,color:i.foreground,cursor:"pointer"},children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:200,children:"200"})]})]}),e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[e.jsx(q,{label:w==="list"?"Show Charts":"Show List",onClick:()=>p(w==="list"?"charts":"list"),variant:w==="charts"?"primary":"ghost"}),e.jsx(q,{label:"Metrics Info",onClick:()=>$(!0),variant:"ghost"}),e.jsx(q,{label:"Export CSV",onClick:le,variant:"ghost"})]})]}),w==="charts"&&e.jsx(ve,{}),w==="list"&&x?e.jsx(ee,{children:"Loading tree view..."}):w==="list"?e.jsxs(e.Fragment,{children:[e.jsx(ye,{columns:a,onColumnClick:o=>U(o.id)}),c.totalPages>1&&e.jsx("div",{style:{marginTop:24},children:e.jsxs(ce,{children:[e.jsx(ie,{onClick:()=>B(Math.max(1,l-1)),disabled:l===1,children:"Previous"}),e.jsxs("span",{style:{fontFamily:"Consolas",fontSize:12,color:i.foreground},children:["Page ",c.currentPage," of ",c.totalPages," (",c.total," total)"]}),e.jsx(ie,{onClick:()=>B(Math.min(c.totalPages,l+1)),disabled:l===c.totalPages,children:"Next"})]})})]}):null]})};export{ze as default};
