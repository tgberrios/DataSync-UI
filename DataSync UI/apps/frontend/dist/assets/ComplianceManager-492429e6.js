import{r as a,ag as l,j as s,C as x,t,b as r,e as _}from"./index-b1fa964d.js";import{e as d}from"./errorHandler-5ea9ae85.js";import{A as u}from"./AsciiPanel-3399d5be.js";import{A as g}from"./AsciiButton-3fcfdd9b.js";import{S as B}from"./SkeletonLoader-09c12074.js";const N=()=>{const[i,c]=a.useState("requests"),[y,j]=a.useState([]),[b,v]=a.useState([]),[C,S]=a.useState([]),[A,E]=a.useState(!0),[m,o]=a.useState(null),n=a.useRef(!0),f=a.useCallback(async()=>{if(n.current)try{o(null);const e=await l.getRequests();n.current&&j(e)}catch(e){n.current&&o(d(e))}finally{n.current&&E(!1)}},[]),p=a.useCallback(async()=>{if(n.current)try{o(null);const e=await l.getConsents();n.current&&v(e)}catch(e){n.current&&o(d(e))}},[]),h=a.useCallback(async()=>{if(n.current)try{o(null);const e=await l.getBreaches();n.current&&S(e)}catch(e){n.current&&o(d(e))}},[]);return a.useEffect(()=>(n.current=!0,i==="requests"?f():i==="consents"?p():i==="breaches"&&h(),()=>{n.current=!1}),[i,f,p,h]),A?s.jsx(x,{children:s.jsx(B,{})}):s.jsx(x,{children:s.jsxs("div",{style:{padding:t.spacing.lg,fontFamily:"Consolas",fontSize:12,background:r.background},children:[s.jsxs("h1",{style:{fontSize:14,fontWeight:600,margin:`0 0 ${t.spacing.md} 0`,color:r.foreground},children:[_.blockFull," COMPLIANCE MANAGER"]}),s.jsxs("div",{style:{display:"flex",gap:t.spacing.sm,marginBottom:t.spacing.md},children:[s.jsx(g,{label:"Requests",onClick:()=>c("requests"),variant:i==="requests"?"primary":"ghost"}),s.jsx(g,{label:"Consents",onClick:()=>c("consents"),variant:i==="consents"?"primary":"ghost"}),s.jsx(g,{label:"Breaches",onClick:()=>c("breaches"),variant:i==="breaches"?"primary":"ghost"})]}),m&&s.jsxs("div",{style:{padding:t.spacing.sm,background:r.foreground+"20",border:`1px solid ${r.foreground}`,marginBottom:t.spacing.md,color:r.foreground},children:["Error: ",m]}),i==="requests"&&s.jsx(u,{title:"DATA SUBJECT REQUESTS",children:s.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:y.map(e=>s.jsxs("div",{style:{padding:t.spacing.sm,border:`1px solid ${r.border}`,marginBottom:t.spacing.xs},children:[s.jsxs("div",{style:{fontWeight:600,color:r.foreground},children:[e.request_type," - ",e.request_status]}),s.jsx("div",{style:{color:r.muted,fontSize:11,marginTop:t.spacing.xs},children:e.data_subject_email||e.data_subject_name})]},e.request_id))})}),i==="consents"&&s.jsx(u,{title:"CONSENT RECORDS",children:s.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:b.map(e=>s.jsx("div",{style:{padding:t.spacing.sm,border:`1px solid ${r.border}`,marginBottom:t.spacing.xs},children:s.jsxs("div",{style:{fontWeight:600,color:r.foreground},children:[e.schema_name,".",e.table_name," - ",e.consent_status]})},e.id))})}),i==="breaches"&&s.jsx(u,{title:"BREACH NOTIFICATIONS",children:s.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:C.map(e=>s.jsxs("div",{style:{padding:t.spacing.sm,border:`1px solid ${r.border}`,marginBottom:t.spacing.xs},children:[s.jsxs("div",{style:{fontWeight:600,color:r.foreground},children:[e.breach_type," - ",e.status]}),s.jsxs("div",{style:{color:r.muted,fontSize:11,marginTop:t.spacing.xs},children:[e.schema_name,".",e.table_name]})]},e.id))})})]})})};export{N as default};
